var fes=$("fes"),timerun=I,pre_replace=[["<","&lt;"],[">","&gt;"],["'","&#39;"],['"','&#34;']];function VGT_LK(l){var d='(v-get.com|weigeti.com)$';if($s(l,0,4)!='http')return l;l=$r(l,/^https?\:\/\//,'');if(!l.match(/.+\..+/))return'#';if(!$p(l,'/')[0].match(RegExp($r(d,'.','\.')))){l=encodeURIComponent(l);l='http://s.v-get.com/l?l='+l;}
l=($s(l,0,4)=='http')?l:($2+l);return l}
function FEt(e,s){s=s?s:$("fes");var d=new Date(),t=s.fet,n;if(e){function z(x){return(x>9)?x:('0'+x)}
t.value=d.getFullYear()+'-'+z(d.getMonth()+1)+'-'+z(d.getDate())+' '+z(d.getHours())+':'+z(d.getMinutes())+':'+z(d.getSeconds());}
n=new Date(t.value);s.fett.value=$i(n.getTime()/1000);}
function FEhd(o){E(o,'input',function(){H($('^i',this.parentNode)[0],L8(this.value));});E(o,'blur',function(){F([['—','#8212'],['\'','#39'],['\"','#34'],['<','lt'],['>','gt']],function(r){o.value=$r(o.value,RegExp(r[0],'g'),'&'+r[1]+';')});H($('^i',this.parentNode)[0],L8(this.value));});}
function FEk(a,o){o=o?o:$("feko");F(a,function(r){o.value=$r(o.value,/(^,)|(,$)/,'');o.value=$r(o.value,/,{2,}/,',');o.value=$r(o.value,RegExp('^'+$S(r),'gi'),r);o.value=$r(o.value,RegExp($S(r)+'$','gi'),r);o.value=$r(o.value,RegExp(','+$S(r)+',','gi'),','+r+',');});o.value=$r(o.value,/\+/g,'%2B');}
function FEko(a,o){o=o?o:$("feko");E(o,'input',function(){var x=this;F([['"',''],["'",''],['，',',']],function(r){if(x.value.match(r[0]))x.value=$r(x.value,RegExp(r[0],'g'),r[1])});H($('^i',x.parentNode)[0],L8(x.value));});E(o,'blur',function(){FEk(a,o);});}
function FEe(o,s){var a="<"+s+">",b="</"+s+">",v=[],r=0,x=['.','+','-','(',')','*','$','^','[',']','?','{','}','|'];if($4.selection){if(L(range.text>0))range.text=a+range.text+b;}
if($4.getSelection){var start=o.selectionStart,end=o.selectionEnd,vs=o.value.substr(0,start),vc=o.value.substring(start,end),ve=o.value.substring(end,L(o.value));if(s=="pre"){D($("^div.fecode")[0],I);E($("pre_add"),$7,function(){var c=$("fecode").value,k=$("pre_codes").value;F(pre_replace,function(rp){if(L(rp)>0){k=k.replace(RegExp(rp[0],"g"),rp[1]);}});if(L(c)>0&&L(k)>0){o.value=vs+"<pre"+((c=="all")?"":(" "+c.replace(/;/g,'"')))+">\n"+k+"\n</pre>"+ve;D($("^div.fecode")[0]);}
else{if(confirm("没有选定代码类型或者输入代码，确定关闭？")){D($("^div.fecode")[0]);}else return;}});}
else{if(end-start>0){if(s!='replace'){if(b!=$s(ve,0,L(b))){if(s=="strong"||s=="em"){o.value=vs+a+vc+b+ve;}
else if(s=="a"){var link=prompt("网址：");o.value=vs+'<a href="'+$L(link)+'">'+vc+'</a>'+ve;}
else if(s=="an"){var link=prompt("网址：");o.value=vs+'<a href="'+$L(link)+'" '+((ec_innersite>0)?'class="fa"':' style="color:#000"')+'>'+vc+'</a>'+ve;}
else{v=vs.match(/<[\w]+>$/);if(L(v)>0){r=L(v[0]);}o.value=vs.replace(/(.+)<[\w]+>$/,"$1")+a+vc.replace(/^<[\w]+>(.+)<\/[\w]+>$/,"$1")+b+ve.replace(/^<\/[\w]+>(.+)/,"$1");}
o.selectionStart=start+L(s)+2-r;o.selectionEnd=end+L(s)+2-r;}
else{o.value=vs.replace(RegExp('(.?)<'+s+'>([^<>]?)$'),"$1$2")+vc+ve.replace(RegExp('^([^<>]?)<\/'+s+'>(.+)'),"$1$2");o.selectionStart=start-L(s)-2;o.selectionEnd=end-L(s)-2;}}
else{var rep2=prompt(vc+" 替换成：");if(rep2!=null){if(rep2==""&&confirm(vc+" 确认替换成空")){rep2="";}
F(x,function(rp){vc=vc.replace(RegExp('(\\'+rp+')',"g"),"\\$1");});o.value=o.value.replace(RegExp(vc,"g"),rep2);}}}
else if(s=="replace"){var rep=prompt("文章被替换的词汇：");if(rep!=null&&L(rep)>0){rep2=prompt(rep+" 替换成：");if(rep2!=null){if(rep2==""&&confirm(rep+" 确认替换成空")){rep2="";}
F(x,function(rp){rep=rep.replace(RegExp('(\\'+rp+')',"g"),"\\$1");});o.value=o.value.replace(RegExp(rep,"g"),rep2);}}}}}}
function FEf(r){r=r?r:($("fefo").value);var p,v='',k="#@&PRE#@&",y="#@&P#@&";r=r.replace(/\n/g,y);p=r.match(/<pre[^>]*>.+?<\/pre>/ig);r=r.replace(/<pre[^>]*>.+?<\/pre>/ig,k);var pi,pp;F($p(r,k),function(x,i){if(i>0){pi=p[i-1];pp=pi.replace(/^(<pre[^>]*>).+<\/pre>$/,'$1');pi=pi.replace(/^<pre[^>]*>(.+)<\/pre>$/,'$1');F(pre_replace,function(rp){if(L(rp)>0){pi=pi.replace(RegExp(rp[0],"g"),rp[1]);}});pi=pi.replace(RegExp(y,'g'),'\n');v+=pp+pi+'</pre>';}
v+=x;});r=v;v='';p=r.match(/<pre[^>]*>.+?<\/pre>/ig);r=r.replace(RegExp(y,'g'),"</p><p>");r=r.replace(/<br\/>/ig,'<br>');F(['html','title','head','meta','link','body'],function(t){r=r.replace(RegExp('<(\/?'+t+'[^>]*)>','ig'),'&lt;$1&gt;');});r=r.replace(/<([^a-z1-7\/"])/g,'&lt;$1');r=r.replace(/([^a-z1-7\/"])>/g,'$1&gt;');r=r.replace(/(<\/p>)([^<]+)/g,"$1<p>$2");r=r.replace(/([^>]+)(<p(?!\w)[^>]*?>)/g,"$1</p>$2");r=r.replace(/(<\/div>)([^<]+)/g,"$1<p>$2");r=r.replace(/([^>]+)(<div[\s>])/g,"$1</p>$2");r=r.replace(/(<\/blockquote>)(<blockquote)/g,"$1<p>&nbsp;</p>$2");r=r.replace(/(<blockquote>)<\/p>/g,"$1");r=r.replace(/<p(?!\w)[^>]*?>(<blockquote[^>]*>)/g,"$1");r=r.replace(/<p(?!\w)[^>]*?>(<\/blockquote>)/g,"$1");r=r.replace(/(<\/blockquote>)<\/p>/g,"$1");r=r.replace(/([^>]+)(<blockquote[^>]*>)/g,"$1</p>$2");r=r.replace(/(<\/?blockquote>)([^>]+)/g,"$1<p>$2");r=r.replace(/([^>]+)(<\/?blockquote[^>]*>)/g,"$1</p>$2");r=r.replace(/(<pre[^>]*>)<\/?p>/g,"$1");r=r.replace(/<p(?!\w)[^>]*?>(<pre[^>]*>)/g,"$1");r=r.replace(/<p(?!\w)[^>]*?>(<\/pre>)/g,"$1");r=r.replace(/(<\/pre>)<\/p>/g,"$1");r=r.replace(/([^>]+)(<pre[^>]*>)/g,"$1</p>$2");r=r.replace(/(<\/pre>)([^>]+)/g,"$1<p>$2");r=r.replace(/(<h\d>)<\/?p>/g,"$1");r=r.replace(/<\/?p>(<\/h\d>)/g,"$1");r=r.replace(/<p(?!\w)[^>]*?>(<h\d>)/g,"$1");r=r.replace(/(<\/h\d>)([^<]+)/g,"$1<p>$2");r=r.replace(/(<\/h\d>)<\/p>/g,"$1");r=r.replace(/([^>]+)(<h\d>)/g,"$1</p>$2");r=r.replace(/<\/p><\/p>/g,"</p>");r=r.replace(/<p(?!\w)[^>]*?><p(?!\w)[^>]*?>/g,"<p>");r=r.replace(/<\/p><p(?!\w)[^>]*?>\s?$/g,"</p>");r=r.replace(/[\(（]微博[）\)]/g,'');r=r.replace(/<\/div><\/p>/g,"</div>");r=r.replace(/<p(?!\w)[^>]*?>(<div[\s>])/g,"$1");r=r.replace(/^<\/p>(<p(?!\w)[^>]*?>)/g,"$1");r=r.replace(/([^>]+)[\s|　]+(<\/p>)/g,"$1$2");r=r.replace(/(<p(?!\w)[^>]*?>)[　|\s]+([^<])/g,"$1$2");r=r.replace(/<p(?!\w)[^>o]*?><\/p>/g,"");r=r.replace(/^([^<])/g,'<p>$1');r=r.replace(/([^>])$/g,'$1</p>');r=r.replace(/\\/g,'&#92;');r=r.replace(/'/g,'&#39;');r=r.replace(/—/g,'&#8212;');F($p(r,k),function(x,i){if(i>0){v+=p[i-1];}v+=x;});return v;}
function FEimg(o,t){var s=[0,'1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'],d=$p($p(t,' ')[0],'-'),m=$p($p(t,' ')[1],':');o.src=FE_IUP+"site="+fes.fevgtsid.value+"&name="+($("feimgkey")?($($("feimgkey").value).value+"_&menu="+$g($("feimgkey"),"feimgmenu")):"")+"&ym="+$s(d[0],2)+s[$i(d[1])]+"&nm="+s[$i(d[2])]+s[$i(m[0])]+m[1]+m[2]+"_&datetime="+escape(t);D(o,I);}
function FEimgrt(x,o){F($("fefatab^a"),function(a){C(a,"");D($("rightnote"));D($("rightinsert"));D($("fehtml"));});C(o,"fefatabo");(x==0)?D($("rightinsert"),I):D($("fehtml"),I);if(timerun||!T($("imgftp").src)){timerun=O;FEimg($("imgftp"),$("fes").fet.value);}}
function FEend(d,m,n){var r=O,v=d.value,e=$s(v,(L(v)-1)),g=m?(L8(v)>m?I:O):I,j=n?(L8(v)<n?I:O):I;if(g&&j)F(['.','!','！','。','?','？','…','”','"','>'],function(s){if(s==e)r=I;});return r}
(function(s,o){s.comes.value=$5.href;if(o){H(o,'<div style="float:left;width:13%;line-height:22px;font-size:12px;color:#000;height:666px;overflow:scroll"><p id="feknote"></p><p id="fekwds"></p><p>&nbsp;</p><p><strong><a href="http://e.v-get.com/tech/u/Editor_1.html" target="_blank">Chrome浏览器快捷键</a></strong></p><p>&#39;单引号 ==> &amp;#39;</p><p>&#34;双引号 ==> &amp;#34;</p><p>&lt;小于 ==> &amp;lt;</p><p>&gt;大于 ==> &amp;gt;</p><p>&amp;  ==> &amp;amp;</p><p>Ctrl+B  <strong>strong 重点加粗</strong></p><p>Ctrl+I  <em>em 斜体</em></p><p>Ctrl+Sft+X  <b>h3 小标题</b></p><p>Ctrl+Sft+Z  <b>h2 大标题</b></p><p>Ctrl+Sft+A  <span class="f2" style="text-decoration:underline">a链接</span></p></div><div style="float:right;width:40%" id="rightinsert"><iframe frameborder="0" marginheight="0"  marginwidth="0" id="imgftp" style="width:100%;height:700px;display:none"></iframe></div><div id="fehtml" style="float:right;width:40%;display:none"></div><div style="float:right;width:40%" id="rightnote"><iframe frameborder="0" marginheight="0" marginwidth="0" style="width:100%;height:700px"></iframe></div><div class="fecode"><p><span><select id="fecode"><option></option><option value="all">全代码</option><option value="class=;php;">PHP</option><option value="class=;pvb;">VB/ASP</option><option value="class=;paspx;">ASP.NET</option><option value="class=;phtml;">HTML/XML</option><option value="class=;pcss;">CSS</option><option value="class=;pjs;">JS</option><option value="class=;psql;">SQL/MySQL</option><option value="class=;pcpp;">C/C++/C#</option><option value="class=;pjava;">Java</option><option value="class=;pconf;">conf配置</option></select></span><button id="pre_add">确定</button></p><textarea id="pre_codes" placeholder="留空点击确定就是关闭"></textarea></div>');H(s,H(s)+'<div class="a" id="fefa"><a href="javascript:void(0)" fefa="strong" title="strong 加粗">加粗</a><a href="javascript:void(0)" fefa="h3" title="h3 小标题">标题</a><a href="javascript:void(0)" fefa="em" title="强调斜体">斜体</a><a href="javascript:void(0)" fefa="a" title="链接">链接</a><a href="javascript:void(0)" fefa="blockquote" title="“引用”">引用</a><a href="javascript:void(0)" fefa="pre" title="程序代码">代码</a><a href="javascript:void(0)" fefa="replace">替换</a></div><span id="fefatab"><a href="#">上传图片</a><a href="#" class="fefatabo">文章预览</a></span><span><a href="http://e.v-get.com/tool/urlencode_urldecode.html" target="_blank">特殊符号</a></span><div class="o"></div><textarea id="fefo" rows="30" placeholder="fef" style="width:98%"></textarea><input type="hidden" name="fef"/><input type="text" name="feimgsql" style="width:98%"><input type="hidden" name="fevgtfl" value="0"/><input type="hidden" name="fevgtfu" value="0"/>');F($("fefa^a"),function(ha){E(ha,'click',function(){if(L($g(this,"fefa"))>0){FEe($("fefo"),$g(this,"fefa"));H($("fehtml"),'<h1>'+$("feho").value+'</h1>'+$("fefo").value);}else{alert("初级编辑请勿随意使用此类，谢谢！");}});});E($("fefo"),'keypress',function(){e=event||window.event;var k=document.all?e.keyCode:k=e.which;if(e.ctrlKey){if(k==2){FEe($("fefo"),"strong");}
if(k==9){FEe($("fefo"),"em");}
if(e.shiftKey){if(k==1){FEe($("fefo"),"a");}
if(k==26){FEe($("fefo"),"h2");}
if(k==24){FEe($("fefo"),"h3");}}}});F($("fefatab^a"),function(a,i){E(a,$7,function(){($i(s.fett.value)>0&&(!$("feimgkey")||($("feimgkey")&&T($($("feimgkey").value).value))))?FEimgrt(i,this):alert('请等待时间显示，如果是非时间命名，就需要【确保唯一性名称'+$("feimgkey").value+'】已经输入');});});}
F(['^input','^textarea'],function(t){F($(t,s),function(slocal){if((slocal.type=='text'||slocal.type=='textarea')&&slocal.readOnly==O&&$g(slocal,"id")!='feto'){E(slocal,'mousedown',function(){if(L($("fefo").value)<1&&L($("feho").value)<1){if(s.fen&&FE_S_N){s.fen.value=FE_S_N;}
F($('^select',s),function(select){select.value=$("^option",select)[0].value;});}});}});});var t=s.fet,timeInterval=$o(function(){if(timerun){FEt(I);}},1000,I);E($("feto"),'mousedown',function(){if(!this.checked){t.readOnly=O;t.style.border="1px solid #999";timerun=O;}else{t.readOnly=I;t.style.border='0';timerun=I;}});E(t,'change',function(){s.fett.value=0;if(this.value.match(/^20\d{2}-[01]\d-[0-3]\d\s[012]\d:[0-5]\d:[0-5]\d$/))FEt();FEimg($("imgftp"),this.value);});$3.onbeforeunload=function(){if(L($("fefo").value)>30)return"确定离开页面吗？";}})($("fes"),$("fefrt"));