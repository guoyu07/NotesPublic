<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>数据分组</B><BR>1。选前几条数据<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;select&nbsp;top&nbsp;10&nbsp;orderid,amt=unitprice*quantity<BR>&nbsp;&nbsp;&nbsp;from&nbsp;ordredetails&nbsp;<BR>&nbsp;&nbsp;&nbsp;order&nbsp;by&nbsp;amt&nbsp;desc<BR>2.利用group&nbsp;by&nbsp;子句对select命令所选数据分组。分组后可以显示出来<BR>&nbsp;&nbsp;group&nbsp;by是除了不含汇总函数（sum,avg,count,min,max等以外的列)<BR>&nbsp;&nbsp;select&nbsp;prod_id,sum(qty*unit_price)&nbsp;tot_amt<BR>&nbsp;from&nbsp;sale_item<BR>&nbsp;group&nbsp;by&nbsp;prod_id<BR>&nbsp;order&nbsp;by&nbsp;tot_amt&nbsp;desc<BR>3.group&nbsp;by&nbsp;子句还可以加&nbsp;with&nbsp;cube语句，加上with&nbsp;cube语句，其返回的数据除了和没有with&nbsp;cube语句一样外，，另外它会得到一些加总列。<BR>&nbsp;&nbsp;select&nbsp;sup_id,prod_id&nbsp;,sum(qty*unit_price),sum(qty)&nbsp;tot_amt<BR>&nbsp;&nbsp;from&nbsp;sale_item<BR>&nbsp;&nbsp;groupby&nbsp;sup_id,prod_id&nbsp;with&nbsp;cube<BR>&nbsp;&nbsp;将有对应每个sup_id的加总列，每个prod_id&nbsp;的加总列，和null，null全部的加总列<BR>4.with&nbsp;cube语句换成with&nbsp;rollup&nbsp;,则只返回最高层次的group列（最靠近group&nbsp;by的列的加总）<BR>&nbsp;&nbsp;&nbsp;上面的例子，只返回sup_id的加总列，每个sup_id后有个加总列<BR>5。<B>使用grouping区分空值</B>&nbsp;&nbsp;&nbsp;&nbsp;<BR>cube操作生成的空值null带来一个问题，即如何区分cube操作生成的null值和实际数据中返回的null值。这个问题，可以用grouping函数解决。如果列中的值来自事实数据，则grouping函数返回0，如果列中的值是cube操作所生成的null，则返回1。在cube操作中，所生成的null代表全体值。可将select语句写成使用grouping函数将null替换为字符串all。<BR>因为事实数据中的null表名数据值未知，所以select语句还可以用字符串unknow替代来自事实数据的null。<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;productid,grouping(productid),orderid,grouping(orderid),sum(quantity)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;order<BR>&nbsp;&nbsp;&nbsp;&nbsp;group&nbsp;by&nbsp;productid,orderid<BR>&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;cube<BR>&nbsp;&nbsp;&nbsp;&nbsp;order&nbsp;by&nbsp;productid,orderid<BR>6.group&nbsp;by&nbsp;&nbsp;&nbsp;子句经常会和having子句搭配，用来找出每个组别中满足指定条件的数据，以下命令由产品文件中找出代码重复者，也就是同一型产品有两家以上的供应商。<BR>&nbsp;&nbsp;select&nbsp;prod_id,count(*)&nbsp;from&nbsp;stock<BR>&nbsp;&nbsp;&nbsp;group&nbsp;by&nbsp;prod_id<BR>&nbsp;&nbsp;&nbsp;having&nbsp;count(*)&gt;1<BR>&nbsp;&nbsp;&nbsp;order&nbsp;by&nbsp;prod_id</FONT>