<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Rename&nbsp;SQL&nbsp;Server&nbsp;Script</B><BR>Rename&nbsp;SQL&nbsp;Server&nbsp;Script
<P></P>
<P></P>
<P><BR>This&nbsp;utility&nbsp;procedure&nbsp;will&nbsp;rename&nbsp;SQL&nbsp;Server&nbsp;to&nbsp;a&nbsp;given&nbsp;name,&nbsp;by&nbsp;default&nbsp;the&nbsp;WINS&nbsp;machine&nbsp;name.&nbsp;The&nbsp;script&nbsp;works&nbsp;on&nbsp;SQL&nbsp;Server&nbsp;7.x&nbsp;and&nbsp;2000.&nbsp;</P>
<P>Notes:&nbsp;1.&nbsp;You&nbsp;will&nbsp;need&nbsp;to&nbsp;restart&nbsp;the&nbsp;SQL&nbsp;Server&nbsp;service&nbsp;in&nbsp;order&nbsp;for&nbsp;the&nbsp;new&nbsp;name&nbsp;to&nbsp;take&nbsp;effect.&nbsp;2.&nbsp;Be&nbsp;careful&nbsp;using&nbsp;this&nbsp;procedure&nbsp;with&nbsp;named&nbsp;instances&nbsp;of&nbsp;SQL&nbsp;Server&nbsp;2000.&nbsp;</P>
<P>Author:&nbsp;Yul&nbsp;Wasserman&nbsp;<BR>Create&nbsp;proc&nbsp;uspRenameServer&nbsp;<BR>@pNewName&nbsp;varchar(256)=null--If&nbsp;NULL&nbsp;we&nbsp;will&nbsp;attempt&nbsp;to&nbsp;rename&nbsp;server&nbsp;to&nbsp;the&nbsp;WINS&nbsp;machine&nbsp;name<BR>/*<BR>Purpose:&nbsp;renames&nbsp;SQL&nbsp;server.&nbsp;<BR>Server:&nbsp;all<BR>Database:&nbsp;DBAservice<BR>Developed:&nbsp;Yul&nbsp;Wasserman&nbsp;03/08/02<BR>*/<BR>AS<BR>Declare&nbsp;@OldName&nbsp;varchar(256)<BR>Declare&nbsp;@NewName&nbsp;varchar(256)<BR>set&nbsp;@OldName=''<BR>select&nbsp;@OldName=isnull(srvname,'')&nbsp;from&nbsp;&nbsp;master.dbo.sysservers&nbsp;where&nbsp;srvid=0&nbsp;<BR>If&nbsp;@pNewName&nbsp;is&nbsp;NULL<BR>Begin<BR>&nbsp;create&nbsp;table&nbsp;#NName&nbsp;(NName&nbsp;varchar&nbsp;(256))<BR>&nbsp;insert&nbsp;#NName&nbsp;exec&nbsp;master.dbo.xp_getnetname<BR>&nbsp;select&nbsp;@NewName=Nname&nbsp;from&nbsp;#Nname<BR>&nbsp;drop&nbsp;table&nbsp;#Nname<BR>End<BR>ELSE&nbsp;If&nbsp;@pNewName&nbsp;is&nbsp;not&nbsp;NULL<BR>Begin<BR>&nbsp;select&nbsp;@NewName=ltrim(rtrim(@pNewName))<BR>End</P>
<P>If&nbsp;@OldName&lt;&gt;@NewName<BR>BEGIN<BR>&nbsp;IF&nbsp;@OldName&nbsp;&lt;&gt;''<BR>&nbsp;BEGIN<BR>&nbsp;&nbsp;print&nbsp;'Attempting&nbsp;to&nbsp;drop&nbsp;server&nbsp;'+@OldName<BR>&nbsp;&nbsp;Exec&nbsp;master.dbo.sp_dropserver&nbsp;&nbsp;@OldName<BR>&nbsp;END<BR>&nbsp;print&nbsp;'Attempting&nbsp;to&nbsp;add&nbsp;server&nbsp;'+@NewName<BR>&nbsp;Exec&nbsp;master.dbo.sp_addserver&nbsp;@NewName,'local'&nbsp;<BR>END<BR>If&nbsp;isnull(@@Servername,'')&lt;&gt;@NewName&nbsp;<BR>Begin<BR>&nbsp;Print&nbsp;'Please&nbsp;shut&nbsp;down&nbsp;and&nbsp;restart&nbsp;SQL&nbsp;Server&nbsp;in&nbsp;order&nbsp;to&nbsp;complete&nbsp;renaming.'&nbsp;<BR>End<BR>Else&nbsp;If&nbsp;isnull(@@Servername,'')=@NewName&nbsp;<BR>Begin<BR>&nbsp;Print&nbsp;'SQL&nbsp;Server&nbsp;is&nbsp;already&nbsp;named&nbsp;'&nbsp;+@NewName<BR>End</P></FONT>