<meta http-equiv="content-type" content="text/html; charset=gb2312">基本知识<BR>1.&nbsp;SQL&nbsp;Server7&nbsp;的&nbsp;DeskTop&nbsp;版中没有全文本检索。<BR>2.&nbsp;一个表只能有一个全文本检索。<BR>3.&nbsp;被检索的表必须有单列的唯一索引。<BR>4.&nbsp;全文本的索引存储在文件系统中，而非数据库中。<BR>5.&nbsp;更新全文本索引的过程比常规索引要耗时，而且也不象常规索引那样可以由数据库系统立即更新。<BR>6.&nbsp;全文本索引包含在全文本目录(&nbsp;Full-Text&nbsp;Catalog&nbsp;)中，每个数据库可以包含一个或多个目录，但一个目录不能属于多个数据库。<BR>7.&nbsp;全文本检索只能在真正的表上创建，不能是视图，系统表，临时表。<BR>8.&nbsp;全文本检索会忽略某些噪音字(&nbsp;noise&nbsp;words)，比如英文的&nbsp;a，the，and，中文的'和'，'是'等等。<BR>9.&nbsp;如果在查询中包含&nbsp;noise&nbsp;words&nbsp;，就会引发错误，在应用程序中应去除这些&nbsp;noise&nbsp;words。
<P></P>
<P>启动全文本检索服务。<BR>方法A：在企业管理器中打开&nbsp;Support&nbsp;Services&nbsp;文件夹，在&nbsp;Full-Text&nbsp;Search&nbsp;的右键菜单中选择&nbsp;Start。<BR>方法B：在&nbsp;SQL&nbsp;Server&nbsp;Service&nbsp;Manager&nbsp;的&nbsp;Services&nbsp;下拉列表中选择&nbsp;Microsoft&nbsp;Search，并单击&nbsp;Start/Continue&nbsp;按钮。<BR>方法C：使用&nbsp;net&nbsp;start&nbsp;mssearch&nbsp;的命令行方式。<BR>使用全文本检索向导(&nbsp;Full-Text&nbsp;Indexing&nbsp;Wizard&nbsp;)。<BR>step1.&nbsp;选择被检索的数据库，在&nbsp;Tools&nbsp;的菜单中，选择&nbsp;Full-text&nbsp;Indexing，进入欢迎(&nbsp;Welcome&nbsp;)的屏幕，单击&nbsp;next。<BR>step2.&nbsp;选择被检索的表，单击&nbsp;next。<BR>step3.&nbsp;选择唯一索引，单击&nbsp;next。<BR>step4.&nbsp;选择被索引的列，单击&nbsp;Add，该列显示在右栏中。单击&nbsp;next。<BR>step5.&nbsp;选择目录(选择已存在的目录，或创建新的目录)，单击&nbsp;next。<BR>step6.&nbsp;选择或创建&nbsp;population&nbsp;schedule(可选项)，单击&nbsp;next。<BR>step7.&nbsp;单击&nbsp;finish。<BR>使用&nbsp;SQL-DMO&nbsp;(以&nbsp;VB&nbsp;为例)&nbsp;<BR>step1.&nbsp;在工程的引用中选择&nbsp;Microsoft&nbsp;SQLDMO&nbsp;Object&nbsp;Library。<BR>step2.&nbsp;创建&nbsp;SQLServer&nbsp;对象。<BR>Dim&nbsp;objSQL&nbsp;As&nbsp;New&nbsp;SQLDMO.SQLServer<BR>objSQL.Connect&nbsp;"localhost",&nbsp;"sa",&nbsp;""<BR>step3.&nbsp;创建新的目录，并加入到被索引的数据库目录中。<BR>Dim&nbsp;objCatalog&nbsp;As&nbsp;New&nbsp;SQLDMO.FullTextCatalog<BR>'使&nbsp;pubs&nbsp;为全文本检索的数据库<BR>objSQL.Databases("pubs").EnableFullTextCatalogs<BR>'创建新的目录<BR>objCatalog.Name&nbsp;=&nbsp;"ftcPubsTest"<BR>'将新目录加入到目录集合中<BR>objSQL.Databases("pubs").FullTextCatalogs.Add&nbsp;objCatalog<BR>step4.&nbsp;在表上创建全文本索引。<BR>Dim&nbsp;objTable&nbsp;As&nbsp;New&nbsp;SQLDMO.Table<BR>'指定被索引的表<BR>Set&nbsp;objTable&nbsp;=&nbsp;objSQL.Databases("pubs").Tables("authors")<BR>'指定目录名和唯一索引名<BR>objTable.FullTextCatalogName&nbsp;=&nbsp;"ftcPubsTest"<BR>objTable.UniqueIndexForFullText&nbsp;=&nbsp;"UPKCL_auidind"<BR>objTable.FullTextIndex&nbsp;=&nbsp;True</P>
<P>'指定被索引的列<BR>objTable.Columns("au_lname").FullTextIndex&nbsp;=&nbsp;True<BR>objTable.Columns("au_fname").FullTextIndex&nbsp;=&nbsp;True</P>
<P>'激活该表上的全文本索引<BR>objTable.FullTextIndexActive&nbsp;=&nbsp;True</P>
<P>step5.&nbsp;启动全文本目录<BR>objCatalog.Start&nbsp;SQLDMOFullText_Full<BR>使用存储过程<BR>step1.&nbsp;使&nbsp;pubs&nbsp;为全文本检索的数据库<BR>USE&nbsp;Pubs<BR>go<BR>sp_fulltext_database&nbsp;'enable'</P>
<P>step2.&nbsp;创建新的目录<BR>sp_fulltext_catalog&nbsp;'ftcPubsTest','create'<BR>step3.&nbsp;指定被索引的表<BR>sp_fulltext_table&nbsp;'authors','create','ftcPubsTest','UPKCL_auidind'<BR>step4.&nbsp;指定被索引的列<BR>sp_fulltext_column&nbsp;'authors','au_lname','add'<BR>sp_fulltext_column&nbsp;'authors','au_fname','add'<BR>step5.&nbsp;激活该表上的全文本索引<BR>sp_fulltext_table&nbsp;'authors','activate'<BR>step6.&nbsp;启动全文本目录<BR>sp_fulltext_catalog&nbsp;'ftcPubsTest','start_full'<BR></P>