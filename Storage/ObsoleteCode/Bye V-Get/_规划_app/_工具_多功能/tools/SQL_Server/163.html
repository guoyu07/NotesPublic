<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>case&nbsp;的用法</B><BR>A.&nbsp;使用带有简单&nbsp;CASE&nbsp;函数的&nbsp;SELECT&nbsp;语句<BR>在&nbsp;SELECT&nbsp;语句中，简单&nbsp;CASE&nbsp;函数仅检查是否相等，而不进行其它比较。下面的示例使用&nbsp;CASE&nbsp;函数更改图书分类显示，以使其更易于理解。
<P></P>
<P>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;&nbsp;&nbsp;Category&nbsp;=&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;type<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;''''''''popular_comp''''''''&nbsp;THEN&nbsp;''''''''Popular&nbsp;Computing''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;''''''''mod_cook''''''''&nbsp;THEN&nbsp;''''''''Modern&nbsp;Cooking''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;''''''''business''''''''&nbsp;THEN&nbsp;''''''''Business''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;''''''''psychology''''''''&nbsp;THEN&nbsp;''''''''Psychology''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;''''''''trad_cook''''''''&nbsp;THEN&nbsp;''''''''Traditional&nbsp;Cooking''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;''''''''Not&nbsp;yet&nbsp;categorized''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END,<BR>&nbsp;&nbsp;&nbsp;CAST(title&nbsp;AS&nbsp;varchar(25))&nbsp;AS&nbsp;''''''''Shortened&nbsp;Title'''''''',<BR>&nbsp;&nbsp;&nbsp;price&nbsp;AS&nbsp;Price<BR>FROM&nbsp;titles<BR>WHERE&nbsp;price&nbsp;IS&nbsp;NOT&nbsp;NULL<BR>ORDER&nbsp;BY&nbsp;type,&nbsp;price<BR>COMPUTE&nbsp;AVG(price)&nbsp;BY&nbsp;type</P>
<P><BR>B.&nbsp;使用带有&nbsp;SUBSTRING&nbsp;和&nbsp;SELECT&nbsp;的&nbsp;CASE&nbsp;函数<BR>下面的示例使用&nbsp;CASE&nbsp;和&nbsp;THEN&nbsp;生成一个有关作者、图书标识号和每个作者所著图书类型的列表。&nbsp;</P>
<P>USE&nbsp;pubs<BR>SELECT&nbsp;SUBSTRING((RTRIM(a.au_fname)&nbsp;+&nbsp;''''''''&nbsp;''''''''+&nbsp;<BR>&nbsp;&nbsp;&nbsp;RTRIM(a.au_lname)&nbsp;+&nbsp;''''''''&nbsp;''''''''),&nbsp;1,&nbsp;25)&nbsp;AS&nbsp;Name,&nbsp;a.au_id,&nbsp;ta.title_id,<BR>&nbsp;&nbsp;&nbsp;Type&nbsp;=&nbsp;<BR>&nbsp;&nbsp;CASE&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;SUBSTRING(ta.title_id,&nbsp;1,&nbsp;2)&nbsp;=&nbsp;''''''''BU''''''''&nbsp;THEN&nbsp;''''''''Business''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;SUBSTRING(ta.title_id,&nbsp;1,&nbsp;2)&nbsp;=&nbsp;''''''''MC''''''''&nbsp;THEN&nbsp;''''''''Modern&nbsp;Cooking''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;SUBSTRING(ta.title_id,&nbsp;1,&nbsp;2)&nbsp;=&nbsp;''''''''PC''''''''&nbsp;THEN&nbsp;''''''''Popular&nbsp;Computing''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;SUBSTRING(ta.title_id,&nbsp;1,&nbsp;2)&nbsp;=&nbsp;''''''''PS''''''''&nbsp;THEN&nbsp;''''''''Psychology''''''''<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;SUBSTRING(ta.title_id,&nbsp;1,&nbsp;2)&nbsp;=&nbsp;''''''''TC''''''''&nbsp;THEN&nbsp;''''''''Traditional&nbsp;Cooking''''''''<BR>&nbsp;&nbsp;END<BR>FROM&nbsp;titleauthor&nbsp;ta&nbsp;JOIN&nbsp;authors&nbsp;a&nbsp;ON&nbsp;ta.au_id&nbsp;=&nbsp;a.au_id<BR>C.&nbsp;<B>结合sum使用,实现统计和已知的有限的行列转换</B><BR>例如物品分为&nbsp;四类<BR>物品号&nbsp;&nbsp;物品类别&nbsp;&nbsp;物品性能<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</P>
<P><BR>select&nbsp;物品类别，count(*)&nbsp;,sum(case&nbsp;物品性能&nbsp;when&nbsp;1&nbsp;then&nbsp;1&nbsp;else&nbsp;0&nbsp;end),<BR>sum(case&nbsp;物品性能&nbsp;when&nbsp;2&nbsp;then&nbsp;1&nbsp;else&nbsp;0&nbsp;end),<BR>sum(case&nbsp;物品性能&nbsp;when&nbsp;3&nbsp;then&nbsp;1&nbsp;else&nbsp;0&nbsp;end)<BR>from&nbsp;tablename&nbsp;<BR>group&nbsp;by&nbsp;物品类别</P>
<P>D:归类省略显示</P>
<P>cj:<BR>id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;cj<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;70<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;71<BR>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;72<BR>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;73&nbsp;<BR>5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ee&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;74<BR>6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75</P>
<P>dw:<BR>dwid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;单位1&nbsp;<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;单位2</P>
<P>结果显示：<BR>&nbsp;<BR>单位1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;70<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;71<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;72<BR>单位2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;73<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ee&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;74<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75<BR>select&nbsp;case&nbsp;when&nbsp;(select&nbsp;count(id)&nbsp;from&nbsp;cj&nbsp;where&nbsp;dwid=b.dwid&nbsp;and&nbsp;id&lt;=b.id)=1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;name&nbsp;else&nbsp;''''&nbsp;end,b.name,b.cj<BR>from&nbsp;dw&nbsp;a&nbsp;left&nbsp;join&nbsp;&nbsp;cj&nbsp;b<BR>on&nbsp;a.dwid=b.dwid<BR>order&nbsp;by&nbsp;b.dwid,b.id</P></FONT>