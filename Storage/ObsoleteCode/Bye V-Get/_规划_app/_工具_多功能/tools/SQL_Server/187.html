<meta http-equiv="content-type" content="text/html; charset=gb2312">&nbsp;<FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>关于恢复SQL&nbsp;Server&nbsp;7.0系统数据库的几点心得</B><BR>关于系统数据库的恢复总结如下:&nbsp;<BR>在SQL&nbsp;Server数据库中，系统信息存储在系统数据库中，主要的系统数据库包括：&nbsp;<BR>master-从整体上控制用户数据库和SQL&nbsp;Server操作，在创建了任何用户定义的&nbsp;<BR>对象后，都要备份它&nbsp;<BR>model-为新数据库提供模版和原型&nbsp;<BR>msdb-包含了有关作业、报警及操作员等信息&nbsp;<BR>如果包含系统数据库的介质变了，那么必须重建系统数据库，如果你仍然可以启动&nbsp;<BR>SQL&nbsp;Server服务，则可以通过RESTORE语句从系统数据库的备份中恢复数据库。&nbsp;<BR>如果master坏了，不能启动系统,可以按照下面步骤进行恢复&nbsp;<BR>1&nbsp;重建系统数据库&nbsp;运行c:\mssql7\binn\rebuildm.exe，按照提示进行即可，过程中需&nbsp;<BR>要&nbsp;<BR>系统数据库样本的路径，可在安装光盘中找到；&nbsp;<BR>2&nbsp;重建系统数据库后，启动SQL&nbsp;Server服务，用系统数据库的备份恢复数据库就行了&nbsp;<BR>通常恢复顺序为master-&gt;msdb-&gt;model&nbsp;<BR>在恢复master的备份时要注意：必须在single&nbsp;user模式下进行，有以下几种方法进入单&nbsp;<BR>用户模式：&nbsp;<BR>1&nbsp;可以在命令行模式下输入sqlservr&nbsp;-c&nbsp;-f&nbsp;-m或者输入sqlservr&nbsp;-m&nbsp;<BR>&nbsp;&nbsp;其中：-c&nbsp;可以缩短启动时间，SQL&nbsp;Server&nbsp;不作为Windows&nbsp;NT的服务启动&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-f&nbsp;用最小配置启动SQL&nbsp;Server&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-m&nbsp;单用户模式启动SQL&nbsp;Server&nbsp;<BR>2&nbsp;可以在控制面板-服务-MSSQLServer的启动参数中输入-c&nbsp;-f&nbsp;-m或者输入-m,点击开始&nbsp;<BR>&nbsp;&nbsp;<BR>3&nbsp;还有一种更灵活的启动方法：用存在注册表里的启动参数启动&nbsp;<BR>&nbsp;&nbsp;在MSSQLServer项下添加项SingleUser,具体内容如下所示：&nbsp;<BR>&nbsp;&nbsp;HKEY_LOCAL_MACHINE&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;\Software&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Microsoft&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\MSSQLServer&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\SingleUser&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Parameters&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLArg0&nbsp;:&nbsp;REG_SZ&nbsp;:&nbsp;-dC:\MSSQL7\DATA\MASTER.DAT&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLArg1&nbsp;:&nbsp;REG_SZ&nbsp;:&nbsp;-eC:\MSSQL7\LOG\ERRORLOG&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLArg2&nbsp;:&nbsp;REG_SZ&nbsp;:&nbsp;-lC:\MSSQL7\DATA\MASTLOG.DAT&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQLArg3&nbsp;:&nbsp;REG_SZ&nbsp;:&nbsp;-m&nbsp;<BR>在命令行下输入SQLServr&nbsp;-c&nbsp;-sSingleUser,注意：必须是在命令行下&nbsp;<BR>进入单用户模式后启动&nbsp;Query&nbsp;Analyzer执行语句：&nbsp;<BR>RESTORE&nbsp;DATABASE&nbsp;master&nbsp;form&nbsp;disk='c:\(具体的备份文件名）'&nbsp;<BR>（我试着在Enterprise&nbsp;Manager中进行恢复操作，结果均失败）&nbsp;<BR>以上几种方法我均做过具体验</FONT>