<meta http-equiv="content-type" content="text/html; charset=gb2312">Report&nbsp;Extended&nbsp;Properties&nbsp;Script
<P></P>
<P></P>
<P><BR>If&nbsp;you&nbsp;use&nbsp;SQL&nbsp;Server&nbsp;2000's&nbsp;extended&nbsp;property&nbsp;features&nbsp;to&nbsp;document&nbsp;your&nbsp;database&nbsp;tables,&nbsp;this&nbsp;stored&nbsp;procedure&nbsp;can&nbsp;provide&nbsp;an&nbsp;easy&nbsp;way&nbsp;to&nbsp;extract&nbsp;the&nbsp;table&nbsp;and&nbsp;column-level&nbsp;descriptions&nbsp;for&nbsp;reporting&nbsp;purposes.&nbsp;This&nbsp;procedure&nbsp;can&nbsp;easily&nbsp;be&nbsp;modified&nbsp;to&nbsp;provide&nbsp;additional&nbsp;information&nbsp;to&nbsp;suit&nbsp;your&nbsp;needs.&nbsp;The&nbsp;script&nbsp;works&nbsp;only&nbsp;on&nbsp;SQL&nbsp;Server&nbsp;2000.&nbsp;</P>
<P>Author:&nbsp;Kevin&nbsp;O'Quinn&nbsp;</P>
<P><BR>IF&nbsp;EXISTS&nbsp;(select&nbsp;*&nbsp;from&nbsp;INFORMATION_SCHEMA.ROUTINES&nbsp;WHERE&nbsp;<BR>ROUTINE_NAME='DataDictionaryTableReport'&nbsp;AND&nbsp;ROUTINE_TYPE='PROCEDURE')<BR>&nbsp;DROP&nbsp;PROCEDURE&nbsp;DataDictionaryTableReport<BR>GO</P>
<P><BR>CREATE&nbsp;PROCEDURE&nbsp;DataDictionaryTableReport<BR>&nbsp;@TABLE_NAME&nbsp;sysname&nbsp;=&nbsp;null,<BR>&nbsp;@COLUMN_NAME&nbsp;&nbsp;sysname&nbsp;=&nbsp;null,<BR>&nbsp;@TABLE_SCHEMA&nbsp;sysname&nbsp;=&nbsp;null<BR>AS<BR>BEGIN</P>
<P>/*************************************************************************************************</P>
<P>Name:<BR>-----<BR>DataDictionaryTableReport</P>
<P><BR>Purpose:<BR>--------<BR>If&nbsp;you&nbsp;use&nbsp;SQL&nbsp;Server&nbsp;2000's&nbsp;extended&nbsp;property&nbsp;features&nbsp;to&nbsp;document&nbsp;your&nbsp;<BR>database&nbsp;tables,&nbsp;this<BR>stored&nbsp;procedure&nbsp;can&nbsp;provide&nbsp;an&nbsp;easy&nbsp;way&nbsp;to&nbsp;extract&nbsp;the&nbsp;table&nbsp;and&nbsp;<BR>column-level&nbsp;descriptions&nbsp;for<BR>reporting&nbsp;purposes.&nbsp;&nbsp;This&nbsp;procedure&nbsp;can&nbsp;easily&nbsp;be&nbsp;modified&nbsp;to&nbsp;provide&nbsp;<BR>additional&nbsp;information&nbsp;to<BR>suite&nbsp;your&nbsp;needs.&nbsp;&nbsp;Compile&nbsp;it&nbsp;to&nbsp;any&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;database.</P>
<P><BR>Created&nbsp;By:<BR>-----------<BR>Kevin&nbsp;O'Quinn,&nbsp;2002-04-19<BR>kevin_oquinn@hotmail.com<BR>Copyright&nbsp;?2002.&nbsp;All&nbsp;rights&nbsp;reserved.</P>
<P><BR>Tested&nbsp;on:<BR>----------<BR>SQL&nbsp;Server&nbsp;2000;&nbsp;&nbsp;will&nbsp;not&nbsp;work&nbsp;on&nbsp;SQL&nbsp;Server&nbsp;6/7</P>
<P><BR>Background:<BR>-----------<BR>Using&nbsp;SQL&nbsp;Server&nbsp;2000's&nbsp;"extended&nbsp;property"&nbsp;features,&nbsp;it&nbsp;is&nbsp;easy&nbsp;to&nbsp;document&nbsp;<BR>your&nbsp;database&nbsp;objects<BR>(i.e.&nbsp;create&nbsp;a&nbsp;data&nbsp;dictionary)&nbsp;directly&nbsp;inside&nbsp;the&nbsp;database&nbsp;itself.&nbsp;&nbsp;<BR>Although&nbsp;this&nbsp;was&nbsp;available<BR>in&nbsp;previous&nbsp;version&nbsp;of&nbsp;SQL&nbsp;Server,&nbsp;with&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;we&nbsp;now&nbsp;have&nbsp;far&nbsp;more&nbsp;<BR>built-in&nbsp;support<BR>for&nbsp;actually&nbsp;maintaining&nbsp;these&nbsp;comments.&nbsp;&nbsp;For&nbsp;example,&nbsp;you&nbsp;can&nbsp;simply&nbsp;open&nbsp;<BR>up&nbsp;a&nbsp;table&nbsp;in&nbsp;Enterprise<BR>Manager&nbsp;design&nbsp;mode,&nbsp;click&nbsp;on&nbsp;a&nbsp;column,&nbsp;and&nbsp;then&nbsp;enter&nbsp;your&nbsp;documentation&nbsp;<BR>comments&nbsp;for&nbsp;the&nbsp;column<BR>in&nbsp;the&nbsp;'description'&nbsp;edit&nbsp;box&nbsp;in&nbsp;the&nbsp;bottom&nbsp;'Columns'&nbsp;pane.&nbsp;&nbsp;Comments&nbsp;can&nbsp;be&nbsp;<BR>made&nbsp;at&nbsp;the&nbsp;table-level<BR>by&nbsp;clicking&nbsp;on&nbsp;the&nbsp;'Table&nbsp;and&nbsp;Index&nbsp;Properties'&nbsp;button&nbsp;and&nbsp;then&nbsp;entering&nbsp;the&nbsp;<BR>comments&nbsp;in&nbsp;the<BR>'description'&nbsp;box&nbsp;on&nbsp;the&nbsp;Table&nbsp;tab.</P>
<P>You&nbsp;can&nbsp;use&nbsp;Query&nbsp;Analyzer's&nbsp;Object&nbsp;Browser&nbsp;to&nbsp;manage&nbsp;the&nbsp;extended&nbsp;<BR>properties&nbsp;of&nbsp;any&nbsp;object&nbsp;(stored<BR>procs,&nbsp;views,&nbsp;etc.)&nbsp;&nbsp;You&nbsp;can&nbsp;also&nbsp;enter&nbsp;descriptions&nbsp;via&nbsp;the&nbsp;underlying&nbsp;<BR>system&nbsp;stored&nbsp;procedures<BR>sp_addExtendedProperty,&nbsp;sp_updateExtendedProperty&nbsp;and&nbsp;<BR>sp_dropExtendedProperty,&nbsp;and&nbsp;you&nbsp;can&nbsp;retrieve<BR>this&nbsp;information&nbsp;via&nbsp;the&nbsp;system&nbsp;function&nbsp;fn_listExtendeProperty.</P>
<P>Additionally,&nbsp;it&nbsp;is&nbsp;worth&nbsp;noting&nbsp;that&nbsp;you&nbsp;can&nbsp;customize&nbsp;your&nbsp;extended&nbsp;<BR>properties&nbsp;to&nbsp;maintain<BR>multiple&nbsp;versions&nbsp;of&nbsp;your&nbsp;definitions.&nbsp;&nbsp;For&nbsp;example,&nbsp;you&nbsp;can&nbsp;maintain&nbsp;a&nbsp;<BR>high-level&nbsp;business<BR>description&nbsp;(i.e.&nbsp;end-user&nbsp;/&nbsp;management),&nbsp;as&nbsp;well&nbsp;as&nbsp;a&nbsp;low-level&nbsp;technical&nbsp;<BR>description&nbsp;(i.e.&nbsp;for<BR>programmers&nbsp;/&nbsp;DBAs).&nbsp;&nbsp;You&nbsp;can&nbsp;also&nbsp;use&nbsp;extended&nbsp;properties&nbsp;to&nbsp;store&nbsp;such&nbsp;<BR>things&nbsp;as&nbsp;input&nbsp;masks,<BR>formatting&nbsp;rules,&nbsp;captions,&nbsp;etc.&nbsp;&nbsp;However,&nbsp;this&nbsp;stored&nbsp;procedure&nbsp;assumes&nbsp;you&nbsp;<BR>are&nbsp;simply&nbsp;maintaining<BR>descriptions&nbsp;for&nbsp;a&nbsp;table&nbsp;and&nbsp;column-level&nbsp;data&nbsp;dictionary&nbsp;model&nbsp;using&nbsp;<BR>Enterprise&nbsp;Manager's&nbsp;built-in<BR>interface.</P>
<P><BR>Reference&nbsp;Materials:<BR>--------------------<BR>In&nbsp;addition&nbsp;to&nbsp;referrring&nbsp;to&nbsp;the&nbsp;SQL&nbsp;Server&nbsp;Books&nbsp;Online,&nbsp;the&nbsp;following&nbsp;<BR>articles&nbsp;provide&nbsp;good<BR>information&nbsp;to&nbsp;help&nbsp;you&nbsp;understand&nbsp;how&nbsp;to&nbsp;use&nbsp;extended&nbsp;properties&nbsp;to&nbsp;<BR>document&nbsp;your&nbsp;database:<BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://msdn.microsoft.com/library/en-us/createdb/cm_8_des_08_7qb7.asp" 
target=_blank>http://msdn.microsoft.com/library/en-us/createdb/cm_8_des_08_7qb7.asp</A><BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://msdn.microsoft.com/library/en-us/dnsqlpro02/html/sql02a10.asp?frame=true" 
target=_blank>http://msdn.microsoft.com/library/en-us/dnsqlpro02/html/sql02a10.asp?frame=true</A><BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://www.devx.com/premier/mgznarch/vbpj/2001/05may01/sq0501/sq0501.asp" 
target=_blank>http://www.devx.com/premier/mgznarch/vbpj/2001/05may01/sq0501/sq0501.asp</A><BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://www.sqlmag.com/Articles/Index.cfm?ArticleID=22399" 
target=_blank>http://www.sqlmag.com/Articles/Index.cfm?ArticleID=22399</A><BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://www.sql-server-performance.com/ac_undocumented_2000_system_tables.asp" 
target=_blank>http://www.sql-server-performance.com/ac_undocumented_2000_system_tables.asp</A></P>
<P><BR>Usage&nbsp;of&nbsp;this&nbsp;procedure:<BR>------------------------<BR>First,&nbsp;use&nbsp;your&nbsp;preferred&nbsp;method&nbsp;to&nbsp;enter&nbsp;the&nbsp;extended&nbsp;property&nbsp;descriptions&nbsp;<BR>for&nbsp;your&nbsp;tables&nbsp;and<BR>their&nbsp;columns.&nbsp;&nbsp;You&nbsp;can&nbsp;then&nbsp;use&nbsp;this&nbsp;stored&nbsp;procedure&nbsp;to&nbsp;produce&nbsp;a&nbsp;bulk&nbsp;<BR>report&nbsp;of&nbsp;all&nbsp;your<BR>tables,&nbsp;their&nbsp;columns,&nbsp;and&nbsp;the&nbsp;descriptions&nbsp;entered&nbsp;for&nbsp;each.&nbsp;&nbsp;You&nbsp;can&nbsp;also&nbsp;<BR>call&nbsp;this&nbsp;procedure<BR>to&nbsp;produce&nbsp;a&nbsp;report&nbsp;for&nbsp;a&nbsp;single&nbsp;table,&nbsp;or&nbsp;even&nbsp;a&nbsp;single&nbsp;column&nbsp;on&nbsp;a&nbsp;table.</P>
<P>For&nbsp;example,&nbsp;you&nbsp;can&nbsp;use&nbsp;this&nbsp;procedure&nbsp;to&nbsp;produce&nbsp;a&nbsp;full&nbsp;listing&nbsp;of&nbsp;each&nbsp;<BR>table&nbsp;and&nbsp;its&nbsp;columns,<BR>dump&nbsp;it&nbsp;into&nbsp;Excel,&nbsp;then&nbsp;use&nbsp;that&nbsp;as&nbsp;a&nbsp;fill-in-the-blank&nbsp;documentation&nbsp;<BR>template.&nbsp;&nbsp;You&nbsp;could&nbsp;then<BR>use&nbsp;a&nbsp;DTS&nbsp;package&nbsp;to&nbsp;pull&nbsp;the&nbsp;definitions&nbsp;out&nbsp;of&nbsp;the&nbsp;Excel&nbsp;spreadsheet&nbsp;and&nbsp;<BR>put&nbsp;them&nbsp;back&nbsp;into<BR>database's&nbsp;extended&nbsp;properties&nbsp;using&nbsp;the&nbsp;system&nbsp;functions.</P>
<P><BR>Examples&nbsp;(using&nbsp;the&nbsp;PUBS&nbsp;database):<BR>-------------------------------------------------------------<BR>To&nbsp;see&nbsp;all&nbsp;tables&nbsp;and&nbsp;columns&nbsp;in&nbsp;the&nbsp;PUBS&nbsp;database:<BR>EXEC&nbsp;DataDictionaryTableReport</P>
<P>To&nbsp;see&nbsp;all&nbsp;information&nbsp;on&nbsp;the&nbsp;Authors&nbsp;table:<BR>EXEC&nbsp;DataDictionaryTableReport&nbsp;@TABLE_NAME='authors'</P>
<P>To&nbsp;see&nbsp;only&nbsp;information&nbsp;on&nbsp;the&nbsp;'au_fname'&nbsp;column&nbsp;in&nbsp;the&nbsp;Authors&nbsp;table:<BR>EXEC&nbsp;DataDictionaryTableReport&nbsp;@TABLE_NAME='authors',&nbsp;<BR>@COLUMN_NAME='au_fname'</P>
<P><BR>Modification&nbsp;Log:<BR>-----------------<BR>2002-04-22&nbsp;KOQUINN:&nbsp;fixed&nbsp;bug&nbsp;where&nbsp;Views&nbsp;showed&nbsp;in&nbsp;result&nbsp;set;&nbsp;&nbsp;also&nbsp;added&nbsp;<BR>@TABLE_SCHEMA&nbsp;argument<BR>&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;view&nbsp;users&nbsp;other&nbsp;than&nbsp;previously&nbsp;hard-coded&nbsp;'dbo'</P>
<P><BR>*************************************************************************************************/</P>
<P>SET&nbsp;NOCOUNT&nbsp;ON</P>
<P><BR>IF&nbsp;(@TABLE_SCHEMA&nbsp;IS&nbsp;NULL)<BR>&nbsp;SET&nbsp;@TABLE_SCHEMA='dbo'</P>
<P><BR>DECLARE&nbsp;@curTableName&nbsp;sysname&nbsp;--&nbsp;cursor&nbsp;variable</P>
<P><BR>--&nbsp;create&nbsp;two&nbsp;table&nbsp;variables&nbsp;to&nbsp;store&nbsp;the&nbsp;result&nbsp;sets<BR>--&nbsp;Note:&nbsp;due&nbsp;to&nbsp;usage&nbsp;of&nbsp;the&nbsp;sql_variant&nbsp;data&nbsp;types,&nbsp;this&nbsp;will&nbsp;produce&nbsp;a&nbsp;<BR>warning&nbsp;about&nbsp;row&nbsp;size<BR>--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upon&nbsp;compilations.&nbsp;&nbsp;However,&nbsp;this&nbsp;can&nbsp;be&nbsp;ignored,&nbsp;as&nbsp;the&nbsp;condition&nbsp;<BR>will&nbsp;never&nbsp;occur.</P>
<P>--&nbsp;@defnBuildTbl&nbsp;stores&nbsp;all&nbsp;existing&nbsp;extended&nbsp;properties&nbsp;meeting&nbsp;the&nbsp;<BR>criteria<BR>DECLARE&nbsp;@defnBuildTbl&nbsp;TABLE&nbsp;(<BR>&nbsp;tableName&nbsp;sysname&nbsp;NULL,<BR>&nbsp;objtype&nbsp;sysname&nbsp;NULL,<BR>&nbsp;objname&nbsp;sysname&nbsp;NULL,<BR>&nbsp;[name]&nbsp;sysname&nbsp;NULL,<BR>&nbsp;value&nbsp;sql_variant&nbsp;&nbsp;NULL)</P>
<P>--&nbsp;@defnResultsTbl&nbsp;stores&nbsp;the&nbsp;end&nbsp;result&nbsp;set<BR>DECLARE&nbsp;@defResultsTbl&nbsp;TABLE&nbsp;(<BR>&nbsp;TABLE_NAME&nbsp;sysname&nbsp;NULL,<BR>&nbsp;COLUMN_NAME&nbsp;sysname&nbsp;NULL,<BR>&nbsp;ORDINAL_POSITION&nbsp;smallint&nbsp;NULL,<BR>&nbsp;[Description]&nbsp;sql_variant&nbsp;NULL,<BR>&nbsp;DATA_TYPE&nbsp;nvarchar(256),<BR>&nbsp;CHARACTER_MAXIMUM_LENGTH&nbsp;int,<BR>&nbsp;NUMERIC_PRECISION&nbsp;smallint,<BR>&nbsp;NUMERIC_SCALE&nbsp;int,<BR>&nbsp;IS_NULLABLE&nbsp;varchar(3)&nbsp;)</P>
<P>--&nbsp;cursor&nbsp;through&nbsp;the&nbsp;system&nbsp;table&nbsp;list&nbsp;of&nbsp;tables;<BR>--&nbsp;if&nbsp;a&nbsp;tableName&nbsp;argument&nbsp;is&nbsp;passed&nbsp;in,&nbsp;only&nbsp;use&nbsp;that,&nbsp;otherwise&nbsp;look&nbsp;up&nbsp;<BR>all&nbsp;tables<BR>DECLARE&nbsp;cTables&nbsp;CURSOR&nbsp;FOR<BR>SELECT&nbsp;TABLE_NAME<BR>FROM&nbsp;INFORMATION_SCHEMA.TABLES&nbsp;&nbsp;--&nbsp;preferable&nbsp;to&nbsp;use&nbsp;these&nbsp;views&nbsp;rather&nbsp;than&nbsp;<BR>system&nbsp;tables<BR>WHERE&nbsp;TABLE_SCHEMA=@TABLE_SCHEMA<BR>&nbsp;AND&nbsp;TABLE_TYPE='BASE&nbsp;TABLE'<BR>&nbsp;AND&nbsp;TABLE_NAME=COALESCE(@TABLE_NAME,&nbsp;TABLE_NAME)</P>
<P>OPEN&nbsp;cTables</P>
<P>FETCH&nbsp;NEXT&nbsp;FROM&nbsp;cTables<BR>INTO&nbsp;@curTableName</P>
<P>WHILE&nbsp;@@FETCH_STATUS&nbsp;=&nbsp;0<BR>BEGIN</P>
<P>&nbsp;--&nbsp;store&nbsp;listing&nbsp;of&nbsp;extended&nbsp;properties&nbsp;for&nbsp;this&nbsp;table,&nbsp;if&nbsp;any</P>
<P>&nbsp;INSERT&nbsp;@defnBuildTbl&nbsp;(tablename,&nbsp;objtype,&nbsp;objname,&nbsp;[name],&nbsp;value)<BR>&nbsp;--&nbsp;capture&nbsp;table&nbsp;comment,&nbsp;if&nbsp;any<BR>&nbsp;SELECT&nbsp;@curTableName,&nbsp;*<BR>&nbsp;FROM&nbsp;::fn_listextendedproperty(default,&nbsp;'user',&nbsp;@TABLE_SCHEMA,&nbsp;'table',&nbsp;<BR>@curTableName,&nbsp;default,&nbsp;default)<BR>&nbsp;WHERE&nbsp;name='MS_Description'&nbsp;--&nbsp;exclude&nbsp;'caption'&nbsp;types<BR>&nbsp;UNION<BR>&nbsp;--&nbsp;capture&nbsp;comments&nbsp;for&nbsp;any&nbsp;columns&nbsp;in&nbsp;the&nbsp;table<BR>&nbsp;SELECT&nbsp;@curTableName,&nbsp;*<BR>&nbsp;FROM&nbsp;&nbsp;&nbsp;::fn_listextendedproperty&nbsp;(default,&nbsp;'user',&nbsp;@TABLE_SCHEMA,&nbsp;'table',&nbsp;<BR>@curTableName,&nbsp;'column',&nbsp;default)<BR>&nbsp;WHERE&nbsp;name='MS_Description'&nbsp;--&nbsp;exclude&nbsp;'caption'&nbsp;types</P>
<P>&nbsp;FETCH&nbsp;NEXT&nbsp;FROM&nbsp;cTables<BR>&nbsp;INTO&nbsp;@curTableName<BR>END</P>
<P>CLOSE&nbsp;cTables<BR>DEALLOCATE&nbsp;cTables</P>
<P><BR>--&nbsp;now&nbsp;compile&nbsp;the&nbsp;result&nbsp;set.&nbsp;&nbsp;We&nbsp;again&nbsp;select&nbsp;from&nbsp;the&nbsp;system&nbsp;tables&nbsp;to&nbsp;<BR>get&nbsp;the<BR>--&nbsp;full&nbsp;list&nbsp;of&nbsp;tables&nbsp;and&nbsp;columns,&nbsp;then&nbsp;do&nbsp;an&nbsp;outer&nbsp;join&nbsp;against&nbsp;our&nbsp;<BR>previous<BR>--&nbsp;result&nbsp;set.&nbsp;&nbsp;This&nbsp;is&nbsp;because&nbsp;we&nbsp;may&nbsp;not&nbsp;have&nbsp;comments&nbsp;in&nbsp;ever&nbsp;<BR>table/column.<BR>--&nbsp;By&nbsp;doing&nbsp;this,&nbsp;we&nbsp;can&nbsp;generate&nbsp;a&nbsp;full&nbsp;template&nbsp;data&nbsp;dictionary&nbsp;that&nbsp;<BR>includes<BR>--&nbsp;any&nbsp;comments&nbsp;we&nbsp;have&nbsp;entered,&nbsp;and&nbsp;blanks&nbsp;for&nbsp;any&nbsp;incomplete&nbsp;<BR>documentation.</P>
<P><BR>INSERT&nbsp;@defResultsTbl&nbsp;(&nbsp;TABLE_NAME,&nbsp;COLUMN_NAME,&nbsp;ORDINAL_POSITION,&nbsp;<BR>[Description],&nbsp;DATA_TYPE,<BR>&nbsp;CHARACTER_MAXIMUM_LENGTH,&nbsp;NUMERIC_PRECISION,&nbsp;NUMERIC_SCALE,&nbsp;IS_NULLABLE&nbsp;)<BR>SELECT&nbsp;t.TABLE_NAME,<BR>&nbsp;t.COLUMN_NAME,<BR>&nbsp;t.ORDINAL_POSITION,<BR>&nbsp;[Description]=isNull(dt.value,&nbsp;dc.value),<BR>&nbsp;t.DATA_TYPE,<BR>&nbsp;t.CHARACTER_MAXIMUM_LENGTH,<BR>&nbsp;t.NUMERIC_PRECISION,<BR>&nbsp;t.NUMERIC_SCALE,<BR>&nbsp;t.IS_NULLABLE<BR>FROM&nbsp;(&nbsp;--&nbsp;generate&nbsp;a&nbsp;derived&nbsp;table&nbsp;that&nbsp;contains&nbsp;all&nbsp;tables&nbsp;and&nbsp;columns.<BR>&nbsp;--&nbsp;one&nbsp;row&nbsp;for&nbsp;each&nbsp;table-level&nbsp;entry...<BR>&nbsp;SELECT<BR>&nbsp;TABLE_NAME,&nbsp;COLUMN_NAME=NULL,&nbsp;DATA_TYPE=NULL,<BR>&nbsp;CHARACTER_MAXIMUM_LENGTH=NULL,&nbsp;NUMERIC_PRECISION=NULL,&nbsp;NUMERIC_SCALE=NULL,<BR>&nbsp;IS_NULLABLE=NULL,&nbsp;ORDINAL_POSITION=0<BR>&nbsp;FROM&nbsp;INFORMATION_SCHEMA.TABLES<BR>&nbsp;WHERE&nbsp;TABLE_SCHEMA=@TABLE_SCHEMA<BR>&nbsp;&nbsp;AND&nbsp;TABLE_TYPE='BASE&nbsp;TABLE'<BR>&nbsp;UNION<BR>&nbsp;--&nbsp;...&nbsp;and&nbsp;one&nbsp;row&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;columns&nbsp;per&nbsp;table<BR>&nbsp;SELECT&nbsp;c.TABLE_NAME,&nbsp;c.COLUMN_NAME,&nbsp;c.DATA_TYPE,<BR>&nbsp;&nbsp;c.CHARACTER_MAXIMUM_LENGTH,&nbsp;c.NUMERIC_PRECISION,&nbsp;c.NUMERIC_SCALE,<BR>&nbsp;&nbsp;c.IS_NULLABLE,&nbsp;c.ORDINAL_POSITION<BR>&nbsp;FROM&nbsp;INFORMATION_SCHEMA.TABLES&nbsp;AS&nbsp;t<BR>&nbsp;JOIN&nbsp;INFORMATION_SCHEMA.COLUMNS&nbsp;AS&nbsp;c&nbsp;ON<BR>&nbsp;&nbsp;t.TABLE_CATALOG&nbsp;=&nbsp;c.TABLE_CATALOG<BR>&nbsp;&nbsp;AND&nbsp;t.TABLE_SCHEMA&nbsp;=&nbsp;c.TABLE_SCHEMA<BR>&nbsp;&nbsp;AND&nbsp;t.TABLE_NAME&nbsp;=&nbsp;c.TABLE_NAME<BR>&nbsp;WHERE&nbsp;t.TABLE_SCHEMA=@TABLE_SCHEMA<BR>&nbsp;&nbsp;AND&nbsp;t.TABLE_TYPE='BASE&nbsp;TABLE'<BR>&nbsp;&nbsp;AND&nbsp;c.TABLE_SCHEMA=@TABLE_SCHEMA<BR>&nbsp;&nbsp;AND&nbsp;c.COLUMN_NAME=COALESCE(@COLUMN_NAME,&nbsp;COLUMN_NAME)&nbsp;)&nbsp;AS&nbsp;t<BR>LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;@defnBuildTbl&nbsp;AS&nbsp;dt&nbsp;ON&nbsp;--&nbsp;any&nbsp;table-level&nbsp;comments,&nbsp;if&nbsp;any<BR>&nbsp;dt.tableName&nbsp;=&nbsp;t.TABLE_NAME<BR>&nbsp;AND&nbsp;dt.objName&nbsp;=&nbsp;t.TABLE_NAME<BR>&nbsp;AND&nbsp;dt.objType&nbsp;=&nbsp;'TABLE'<BR>&nbsp;AND&nbsp;t.COLUMN_NAME&nbsp;IS&nbsp;NULL<BR>LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;@defnBuildTbl&nbsp;AS&nbsp;dc&nbsp;ON&nbsp;--&nbsp;any&nbsp;column-level&nbsp;comments,&nbsp;if&nbsp;any<BR>&nbsp;dc.tableName&nbsp;=&nbsp;t.TABLE_NAME<BR>&nbsp;AND&nbsp;dc.ObjName&nbsp;=&nbsp;t.COLUMN_NAME<BR>&nbsp;AND&nbsp;dc.objType&nbsp;=&nbsp;'COLUMN'<BR>WHERE&nbsp;t.TABLE_NAME=COALESCE(@TABLE_NAME,&nbsp;TABLE_NAME)</P>
<P><BR>--&nbsp;finally,&nbsp;return&nbsp;the&nbsp;result&nbsp;set;&nbsp;&nbsp;comment&nbsp;out&nbsp;any&nbsp;columns&nbsp;you&nbsp;don't&nbsp;<BR>need/want<BR>IF&nbsp;(@COLUMN_NAME&nbsp;IS&nbsp;NOT&nbsp;NULL)&nbsp;--&nbsp;column-level<BR>&nbsp;SELECT&nbsp;TABLE_NAME,&nbsp;COLUMN_NAME,&nbsp;ORDINAL_POSITION,&nbsp;[Description],&nbsp;DATA_TYPE,<BR>&nbsp;&nbsp;CHARACTER_MAXIMUM_LENGTH,&nbsp;NUMERIC_PRECISION,&nbsp;NUMERIC_SCALE,&nbsp;IS_NULLABLE<BR>&nbsp;FROM&nbsp;@defResultsTbl<BR>&nbsp;WHERE&nbsp;COLUMN_NAME=@COLUMN_NAME</P>
<P>ELSE&nbsp;--&nbsp;table-level<BR>&nbsp;SELECT&nbsp;TABLE_NAME,&nbsp;COLUMN_NAME,&nbsp;ORDINAL_POSITION,&nbsp;[Description],&nbsp;DATA_TYPE,<BR>&nbsp;&nbsp;CHARACTER_MAXIMUM_LENGTH,&nbsp;NUMERIC_PRECISION,&nbsp;NUMERIC_SCALE,&nbsp;IS_NULLABLE<BR>&nbsp;FROM&nbsp;@defResultsTbl<BR>&nbsp;ORDER&nbsp;BY&nbsp;TABLE_NAME,&nbsp;ORDINAL_POSITION</P>
<P>RETURN<BR>End&nbsp;--&nbsp;procedure<BR>GO</P>
<P><BR>GRANT&nbsp;ALL&nbsp;ON&nbsp;DataDictionaryTableReport&nbsp;TO&nbsp;public<BR></P>