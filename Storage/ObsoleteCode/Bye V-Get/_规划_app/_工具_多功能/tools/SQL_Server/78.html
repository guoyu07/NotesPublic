<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>解Q关于字符串合愕姆椒(即似SUM(字符串字段))</B><BR>id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<BR>-----------&nbsp;----------<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cool<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nice<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wow<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cool<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wow<BR>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cool<BR>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nice<BR>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nice
<P></P>
<P><BR>This&nbsp;is&nbsp;a&nbsp;result:<BR>id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<BR>-----------&nbsp;-------------<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cool,nice,wow,<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cool,wow,<BR>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cool,nice,<BR>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nice,</P>
<P><BR>set&nbsp;nocount&nbsp;on<BR>declare&nbsp;@YourResultTable&nbsp;&nbsp;table&nbsp;(id&nbsp;int,&nbsp;value&nbsp;varchar(10))<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''cool'''')<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''nice'''')<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''wow'''')<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''cool'''')<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''wow'''')<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''cool'''')<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''nice'''')<BR>insert&nbsp;@YourResultTable&nbsp;&nbsp;values(4,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''''nice'''')<BR>select&nbsp;*&nbsp;from&nbsp;@YourResultTable</P>
<P><BR>declare&nbsp;@z&nbsp;varchar(100),<BR>&nbsp;@Step&nbsp;int,<BR>&nbsp;@q&nbsp;int<BR>select&nbsp;&nbsp;@Step&nbsp;=&nbsp;0,<BR>&nbsp;@q&nbsp;=&nbsp;0</P>
<P>declare&nbsp;@ProcessTable&nbsp;table&nbsp;(id&nbsp;int,&nbsp;value&nbsp;varchar(100),&nbsp;ProcessStep&nbsp;int)<BR>insert&nbsp;@ProcessTable<BR>&nbsp;select&nbsp;id,&nbsp;value,&nbsp;0<BR>&nbsp;from&nbsp;&nbsp;@YourResultTable<BR>&nbsp;order&nbsp;by&nbsp;id,&nbsp;value</P>
<P>update&nbsp;&nbsp;@ProcessTable<BR>&nbsp;set&nbsp;&nbsp;@z&nbsp;=&nbsp;value&nbsp;=&nbsp;case&nbsp;@q&nbsp;when&nbsp;id&nbsp;then&nbsp;@z&nbsp;else&nbsp;''''''''&nbsp;end&nbsp;+&nbsp;value&nbsp;+<BR>'''',''''&nbsp;,<BR>&nbsp;&nbsp;@q&nbsp;=&nbsp;@q&nbsp;+&nbsp;case&nbsp;@q&nbsp;when&nbsp;id&nbsp;then&nbsp;0&nbsp;else&nbsp;1&nbsp;end,<BR>&nbsp;&nbsp;@Step&nbsp;=&nbsp;ProcessStep&nbsp;=&nbsp;@Step&nbsp;+&nbsp;1<BR>&nbsp;from&nbsp;&nbsp;@ProcessTable</P>
<P>select&nbsp;&nbsp;id,<BR>&nbsp;value<BR>&nbsp;from&nbsp;&nbsp;@ProcessTable&nbsp;t<BR>&nbsp;&nbsp;join&nbsp;(select&nbsp;max(ProcessStep)&nbsp;MaxStep<BR>&nbsp;&nbsp;&nbsp;from&nbsp;@ProcessTable<BR>&nbsp;&nbsp;&nbsp;group&nbsp;by&nbsp;id)&nbsp;x<BR>&nbsp;&nbsp;on&nbsp;ProcessStep&nbsp;=&nbsp;MaxStep</P>
<P>set&nbsp;nocount&nbsp;off</P>
<P></P>
<P><BR>---2000h境下y通^，大伙如有什N好的方法，提出@!@</P>
<P><BR><B>其@是SQL&nbsp;Server里UpdateZ句的妙用。<BR>或S@明白c:</P>
<P><BR>update&nbsp;@processTable&nbsp;<BR>SET&nbsp;@z=value=CASE&nbsp;WHEN&nbsp;@q=id&nbsp;THEN&nbsp;@z&nbsp;else&nbsp;''''''''&nbsp;&nbsp;end&nbsp;+value&nbsp;+'''','''',<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@q=@q+Case&nbsp;WHEN&nbsp;@q=ID&nbsp;THEN&nbsp;0&nbsp;ELSE&nbsp;1&nbsp;end,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@step=ProcessStep=@Step+1<BR>from&nbsp;@processTable</P>
<P><BR>UpdateZ句可以@樱先把一量算後xo一谖唬然後再xo自身。但大家lF]有，@Z句有一定的局限性，就是ID之g必是相B的，且g隔值是1，否tY果不正</P></B></FONT>