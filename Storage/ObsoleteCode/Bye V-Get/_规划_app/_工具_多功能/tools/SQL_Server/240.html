<meta http-equiv="content-type" content="text/html; charset=gb2312">CONTAINSTABLE&nbsp;语法<BR>我们通常在&nbsp;FROM&nbsp;子句中使用&nbsp;CONTAINSTABLE&nbsp;，就象这样：SELECT&nbsp;*&nbsp;FROM&nbsp;table_name,CONTAINTABLE(fulltext_table,fullText_column,'search&nbsp;condition')&nbsp;WHERE&nbsp;......。
<P></P>
<P>CONTAINSTABLE&nbsp;在查询方式上与&nbsp;CONTAINS&nbsp;几乎一样，所以就不用赘述了。CONTAINSTABLE&nbsp;返回的是符合查询条件的表，在&nbsp;SQL&nbsp;语句中我们可以把它当作一个普通的表来使用。</P>
<P>我们看一个例子，比较这两种表的不同。<BR>SELECT&nbsp;FT_TBL.student_name,FT_TBL.student_score,KEY_TBL.RANK<BR>FROM&nbsp;report&nbsp;AS&nbsp;FT_TBL&nbsp;INNER&nbsp;JOIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINSTABLE(&nbsp;student,address,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'ISABOUT&nbsp;(city&nbsp;weight&nbsp;(.8),&nbsp;county&nbsp;wright&nbsp;(.4))'&nbsp;)&nbsp;AS&nbsp;KEY_TBL<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;FT_TBL.student_id&nbsp;=&nbsp;KEY_TBL.[KEY]<BR>ORDER&nbsp;BY&nbsp;KEY_TBL.RANK<BR>CONTAINSTABLE&nbsp;返回的表包含有特殊的两列：KEY，RANK。<BR>在第一部分里我们就强调了：被全文索引的表必须有唯一索引。这个唯一的索引列在返回的表中就成为&nbsp;KEY。我们通常把它作为表连接的条件。</P>
<P>在某些网站搜索时，结果中会出现表示匹配程度的数字，RANK&nbsp;与此类似。它的值在0~1000之间，标识每一行与查询条件的匹配程度，程度越高，RANK&nbsp;的值大，通常情况下，按照&nbsp;RANK&nbsp;的降序排列。<BR>FREETEXT&nbsp;语法<BR>FREETEXT&nbsp;与&nbsp;CONTAINS&nbsp;类似，只是没有&nbsp;CONTAINS&nbsp;的精度高。在&nbsp;CONTAINS&nbsp;中，对查询条件的写法有很多要求，而&nbsp;FREETEXT&nbsp;就没有，可以是任意的单词，词组或句子。看下面的例子：<BR>SELECT&nbsp;CategoryName<BR>FROM&nbsp;Categories<BR>WHERE&nbsp;FREETEXT&nbsp;(Description,&nbsp;'sweetest&nbsp;candy&nbsp;bread&nbsp;and&nbsp;dry&nbsp;meat'&nbsp;)</P>
<P>FREETEXTTABLE&nbsp;语法<BR>和&nbsp;CONTAINSTABLE&nbsp;一样，FREETEXTTABLE&nbsp;返回带有&nbsp;KEY，RANK&nbsp;的表。举例说明：<BR>SELECT&nbsp;FT_TBL.CategoryName,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;FT_TBL.Description,<BR>&nbsp;&nbsp;&nbsp;&nbsp;KEY_TBL.RANK<BR>FROM&nbsp;Categories&nbsp;AS&nbsp;FT_TBL&nbsp;INNER&nbsp;JOIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;FREETEXTTABLE(Categories,&nbsp;Description,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;'sweetest&nbsp;candy&nbsp;bread&nbsp;and&nbsp;dry&nbsp;meat')&nbsp;AS&nbsp;KEY_TBL<BR>&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;FT_TBL.CategoryID&nbsp;=&nbsp;KEY_TBL.[KEY]<BR>在&nbsp;ASP&nbsp;中使用全文本检索<BR>Dim&nbsp;cnn&nbsp;<BR>Dim&nbsp;rs<BR>Dim&nbsp;strSQL</P>
<P>strSQL&nbsp;=&nbsp;"SELECT&nbsp;book_name&nbsp;"&nbsp;&amp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"FROM&nbsp;books&nbsp;"&nbsp;&amp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"WHERE&nbsp;CONTAINS(&nbsp;description,&nbsp;'"&nbsp;&amp;&nbsp;Request("search_condition")&nbsp;&amp;&nbsp;"'&nbsp;)"</P>
<P>Set&nbsp;cnn&nbsp;=&nbsp;Server.CreateObject("ADODB.Connection")<BR>Set&nbsp;rs&nbsp;=&nbsp;Server.CreateObject("ADODB.RecordSet")</P>
<P>cnn.Open&nbsp;"provider=sqloledb;datasource=.;initial&nbsp;catalog=books;user&nbsp;id=sa;pasword=;"<BR>rs.Open&nbsp;strSQL,cnn</P>
<P><BR>上面的例子十分简单，仅为示意。只要掌握了&nbsp;CONTAINS&nbsp;和&nbsp;CONTAINSTABLE&nbsp;的语法，在使用上和一般的&nbsp;ADO&nbsp;查询一样</P>