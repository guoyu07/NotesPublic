<meta http-equiv="content-type" content="text/html; charset=gb2312">CREATE&nbsp;FUNCTION&nbsp;[DBO].[FUN_BJ]&nbsp;(@N&nbsp;INT,@I&nbsp;INT,@RATE&nbsp;&nbsp;FLOAT,@T&nbsp;FLOAT)&nbsp;&nbsp;<BR>RETURNS&nbsp;FLOAT&nbsp;<BR>AS&nbsp;&nbsp;<BR>BEGIN&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;DECLARE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@JC&nbsp;FLOAT,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@NI&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;IF&nbsp;(@N&lt;@I)OR(@RATE=0)OR(@T=0)<BR>&nbsp;&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN(0.0)<BR>&nbsp;&nbsp;&nbsp;END
<P></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@NI=@N-@I&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@JC=POWER(EXP(-1*@RATE*@T),@I)*POWER((1-EXP(-1*@RATE*@T)),@NI)<BR>&nbsp;&nbsp;--Ñ­»·¼ÆËã<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHILE(@I&gt;0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--Çó½×³Ë<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@JC=@JC*@N/@I<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@I=@I-1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@N=@N-1<BR>&nbsp;&nbsp;&nbsp;&nbsp;END<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@JC)<BR>END</P>