<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>MD5算法的T-SQL实现(1)(_rambo)</B><BR>*****************************************************************************<BR>*&nbsp;Name:&nbsp;T-SQL&nbsp;MD5算法实现<BR>*&nbsp;Author:&nbsp;&nbsp;Rambo&nbsp;Qian<BR>*&nbsp;Create&nbsp;Date:&nbsp;2003-04-10<BR>*&nbsp;Last&nbsp;Modified&nbsp;by:&nbsp;Rambo&nbsp;Qian<BR>*&nbsp;Last&nbsp;Update&nbsp;Date:&nbsp;2003-04-16<BR>*&nbsp;Version:&nbsp;V1.0.00<BR>*****************************************************************************/<BR>GO
<P></P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_m_OnBits]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_m_OnBits]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_m_OnBits<BR>*&nbsp;Description:&nbsp;常数组<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_m_OnBits(<BR>&nbsp;&nbsp;&nbsp;&nbsp;@i&nbsp;&nbsp;&nbsp;&nbsp;TINYINT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;DECLARE&nbsp;@iRes&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;@iRes&nbsp;=<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;@i<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;0&nbsp;&nbsp;THEN&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000000001<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1&nbsp;&nbsp;THEN&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000000011<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2&nbsp;&nbsp;THEN&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000000111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3&nbsp;&nbsp;THEN&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000001111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;4&nbsp;&nbsp;THEN&nbsp;31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000011111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;5&nbsp;&nbsp;THEN&nbsp;63&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;6&nbsp;&nbsp;THEN&nbsp;127&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000001111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;7&nbsp;&nbsp;THEN&nbsp;255&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000011111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;8&nbsp;&nbsp;THEN&nbsp;511&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;9&nbsp;&nbsp;THEN&nbsp;1023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000001111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;10&nbsp;THEN&nbsp;2047&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000011111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;11&nbsp;THEN&nbsp;4095&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;12&nbsp;THEN&nbsp;8191&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000001111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;13&nbsp;THEN&nbsp;16383&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000011111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;14&nbsp;THEN&nbsp;32767&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;15&nbsp;THEN&nbsp;65535&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000001111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;16&nbsp;THEN&nbsp;131071&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000011111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;17&nbsp;THEN&nbsp;262143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;18&nbsp;THEN&nbsp;524287&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000001111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;19&nbsp;THEN&nbsp;1048575&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000011111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;20&nbsp;THEN&nbsp;2097151&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;21&nbsp;THEN&nbsp;4194303&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000001111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;22&nbsp;THEN&nbsp;8388607&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000011111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;23&nbsp;THEN&nbsp;16777215&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;24&nbsp;THEN&nbsp;33554431&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000001111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;25&nbsp;THEN&nbsp;67108863&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000011111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;26&nbsp;THEN&nbsp;134217727&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000111111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;27&nbsp;THEN&nbsp;268435455&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00001111111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;28&nbsp;THEN&nbsp;536870911&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00011111111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;29&nbsp;THEN&nbsp;1073741823&nbsp;&nbsp;&nbsp;--&nbsp;00111111111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;30&nbsp;THEN&nbsp;2147483647&nbsp;&nbsp;&nbsp;--&nbsp;01111111111111111111111111111111<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@iRes)<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_m_2Power]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_m_2Power]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_m_2Power<BR>*&nbsp;Description:&nbsp;常数组<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_m_2Power(<BR>&nbsp;&nbsp;&nbsp;&nbsp;@i&nbsp;&nbsp;&nbsp;&nbsp;TINYINT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;DECLARE&nbsp;@iRes&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;@iRes&nbsp;=<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;@i<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;0&nbsp;&nbsp;THEN&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000000001<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1&nbsp;&nbsp;THEN&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000000010<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2&nbsp;&nbsp;THEN&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000000100<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3&nbsp;&nbsp;THEN&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000001000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;4&nbsp;&nbsp;THEN&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000010000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;5&nbsp;&nbsp;THEN&nbsp;32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000000100000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;6&nbsp;&nbsp;THEN&nbsp;64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000001000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;7&nbsp;&nbsp;THEN&nbsp;128&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000010000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;8&nbsp;&nbsp;THEN&nbsp;256&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000000100000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;9&nbsp;&nbsp;THEN&nbsp;512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000001000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;10&nbsp;THEN&nbsp;1024&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000010000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;11&nbsp;THEN&nbsp;2048&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000000100000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;12&nbsp;THEN&nbsp;4096&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000001000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;13&nbsp;THEN&nbsp;8192&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000010000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;14&nbsp;THEN&nbsp;16384&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000000100000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;15&nbsp;THEN&nbsp;32768&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000001000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;16&nbsp;THEN&nbsp;65536&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000010000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;17&nbsp;THEN&nbsp;131072&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000000100000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;18&nbsp;THEN&nbsp;262144&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000001000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;19&nbsp;THEN&nbsp;524288&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000010000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;20&nbsp;THEN&nbsp;1048576&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000000100000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;21&nbsp;THEN&nbsp;2097152&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000001000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;22&nbsp;THEN&nbsp;4194304&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000010000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;23&nbsp;THEN&nbsp;8388608&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000000100000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;24&nbsp;THEN&nbsp;16777216&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000001000000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;25&nbsp;THEN&nbsp;33554432&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000010000000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;26&nbsp;THEN&nbsp;67108864&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00000100000000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;27&nbsp;THEN&nbsp;134217728&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00001000000000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;28&nbsp;THEN&nbsp;268435456&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00010000000000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;29&nbsp;THEN&nbsp;536870912&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;00100000000000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;30&nbsp;THEN&nbsp;1073741824&nbsp;&nbsp;&nbsp;--&nbsp;01000000000000000000000000000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@iRes)<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_LShift]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_LShift]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_LShift<BR>*&nbsp;Description:&nbsp;MD5_LShift<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_LShift(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ivalue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@iShiftBits&nbsp;&nbsp;&nbsp;&nbsp;TINYINT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;DECLARE&nbsp;@iRes&nbsp;&nbsp;&nbsp;&nbsp;BIGINT<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@iRes&nbsp;=&nbsp;CAST(@ivalue&nbsp;AS&nbsp;BINARY(8))<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@iRes&nbsp;=&nbsp;@iRes&nbsp;*&nbsp;dbo.MD5_m_2Power(@iShiftBits)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(CAST(@iRes&nbsp;&amp;&nbsp;0x00000000FFFFFFFF&nbsp;AS&nbsp;BINARY(4)))<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_RShift]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_RShift]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_RShift<BR>*&nbsp;Description:&nbsp;MD5_RShift<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_RShift(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ivalue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@iShiftBits&nbsp;&nbsp;&nbsp;&nbsp;TINYINT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;DECLARE&nbsp;@iRes&nbsp;&nbsp;&nbsp;&nbsp;BIGINT<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@iRes&nbsp;=&nbsp;CAST(@ivalue&nbsp;AS&nbsp;BINARY(8))<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@iRes&nbsp;=&nbsp;@iRes&nbsp;/&nbsp;dbo.MD5_m_2Power(@iShiftBits)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(CAST(@iRes&nbsp;&amp;&nbsp;0x00000000FFFFFFFF&nbsp;AS&nbsp;BINARY(4)))<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_RotateLeft]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_RotateLeft]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_RotateLeft<BR>*&nbsp;Description:&nbsp;MD5_RotateLeft<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_RotateLeft(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ivalue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@iShiftBits&nbsp;&nbsp;&nbsp;&nbsp;TINYINT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(dbo.MD5_LShift(@ivalue,&nbsp;@iShiftBits)&nbsp;|&nbsp;dbo.MD5_RShift(@ivalue,&nbsp;(32&nbsp;-&nbsp;@iShiftBits)))<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_AddUnsigned]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_AddUnsigned]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_AddUnsigned<BR>*&nbsp;Description:&nbsp;MD5_AddUnsigned<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_AddUnsigned(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@iX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@iY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;DECLARE&nbsp;@iRes&nbsp;&nbsp;&nbsp;&nbsp;BIGINT<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@iRes&nbsp;=&nbsp;CAST(CAST(@iX&nbsp;AS&nbsp;BINARY(8))&nbsp;AS&nbsp;BIGINT)&nbsp;+&nbsp;CAST(CAST(@iY&nbsp;AS&nbsp;BINARY(8))&nbsp;AS&nbsp;BIGINT)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(CAST(@iRes&nbsp;&amp;&nbsp;0x00000000FFFFFFFF&nbsp;AS&nbsp;BINARY(4)))<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_F]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_F]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_F<BR>*&nbsp;Description:&nbsp;MD5_F<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_F(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN((@x&nbsp;&amp;&nbsp;@y)&nbsp;|&nbsp;((~@x)&nbsp;&amp;&nbsp;@z))<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_G]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_G]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_G<BR>*&nbsp;Description:&nbsp;MD5_G<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_G(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN((@x&nbsp;&amp;&nbsp;@z)&nbsp;|&nbsp;(@y&nbsp;&amp;&nbsp;(~@z)))<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_H]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_H]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_H<BR>*&nbsp;Description:&nbsp;MD5_H<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_H(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@x&nbsp;^&nbsp;@y&nbsp;^&nbsp;@z)<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_I]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_I]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_I<BR>*&nbsp;Description:&nbsp;MD5_I<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_I(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@y&nbsp;^&nbsp;(@x&nbsp;|&nbsp;(~@z)))<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_FF]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_FF]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_FF<BR>*&nbsp;Description:&nbsp;MD5_FF<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_FF(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@ac&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;dbo.MD5_AddUnsigned(dbo.MD5_AddUnsigned(dbo.MD5_F(@b,&nbsp;@c,&nbsp;@d),&nbsp;@x),&nbsp;@ac))<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_RotateLeft(@a,&nbsp;@s)<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;@b)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@a)<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_GG]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_GG]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_GG<BR>*&nbsp;Description:&nbsp;MD5_GG<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_GG(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@ac&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;dbo.MD5_AddUnsigned(dbo.MD5_AddUnsigned(dbo.MD5_G(@b,&nbsp;@c,&nbsp;@d),&nbsp;@x),&nbsp;@ac))<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_RotateLeft(@a,&nbsp;@s)<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;@b)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@a)<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_HH]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_HH]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_HH<BR>*&nbsp;Description:&nbsp;MD5_HH<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_HH(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@ac&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;dbo.MD5_AddUnsigned(dbo.MD5_AddUnsigned(dbo.MD5_H(@b,&nbsp;@c,&nbsp;@d),&nbsp;@x),&nbsp;@ac))<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_RotateLeft(@a,&nbsp;@s)<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;@b)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@a)<BR>END<BR>GO</P>
<P>IF&nbsp;EXISTS(SELECT&nbsp;*&nbsp;FROM&nbsp;dbo.sysobjects&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(N'[dbo].[MD5_II]')&nbsp;AND&nbsp;xtype&nbsp;IN(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>&nbsp;&nbsp;&nbsp;&nbsp;DROP&nbsp;FUNCTION&nbsp;[dbo].[MD5_II]<BR>GO<BR>/*****************************************************************************<BR>*&nbsp;Name:&nbsp;MD5_II<BR>*&nbsp;Description:&nbsp;MD5_II<BR>*****************************************************************************/<BR>CREATE&nbsp;FUNCTION&nbsp;dbo.MD5_II(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;&nbsp;,@ac&nbsp;&nbsp;&nbsp;&nbsp;INT<BR>)<BR>RETURNS&nbsp;INT<BR>WITH&nbsp;ENCRYPTION<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;dbo.MD5_AddUnsigned(dbo.MD5_AddUnsigned(dbo.MD5_I(@b,&nbsp;@c,&nbsp;@d),&nbsp;@x),&nbsp;@ac))<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_RotateLeft(@a,&nbsp;@s)<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@a&nbsp;=&nbsp;dbo.MD5_AddUnsigned(@a,&nbsp;@b)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN(@a)<BR>END<BR></P></FONT>