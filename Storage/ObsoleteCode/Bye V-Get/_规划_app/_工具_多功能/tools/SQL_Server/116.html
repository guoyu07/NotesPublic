<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Drop&nbsp;All&nbsp;Triggers</B><BR>Drop&nbsp;All&nbsp;Triggers
<P></P>
<P></P>
<P><BR>This&nbsp;script&nbsp;produces&nbsp;a&nbsp;script&nbsp;that&nbsp;drops&nbsp;and&nbsp;creates&nbsp;all&nbsp;triggers&nbsp;on&nbsp;a&nbsp;certain&nbsp;database.&nbsp;To&nbsp;use&nbsp;it&nbsp;create&nbsp;the&nbsp;procedure&nbsp;in&nbsp;the&nbsp;master&nbsp;db&nbsp;and&nbsp;save&nbsp;the&nbsp;result&nbsp;as&nbsp;*.sql.&nbsp;</P>
<P>Author:&nbsp;Marino&nbsp;De&nbsp;Veirman&nbsp;<BR>if&nbsp;exists&nbsp;(select&nbsp;*&nbsp;from&nbsp;sysobjects&nbsp;where&nbsp;id&nbsp;=&nbsp;object_id(N'[dbo].[sp_ScriptTriggers]')&nbsp;and&nbsp;OBJECTPROPERTY(id,&nbsp;N'IsProcedure')&nbsp;=&nbsp;1)<BR>drop&nbsp;procedure&nbsp;[dbo].[sp_ScriptTriggers]<BR>GO</P>
<P>use&nbsp;master<BR>go</P>
<P>create&nbsp;procedure&nbsp;sp_ScriptTriggers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>as</P>
<P>/*&nbsp;*************************************************************************************************************&nbsp;*/<BR>/*&nbsp;AUTHOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;De&nbsp;Veirman&nbsp;Marino&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREATION&nbsp;DATE&nbsp;:&nbsp;06/07/2000&nbsp;*/<BR>/*&nbsp;COMPANY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Spector&nbsp;Photo&nbsp;Group&nbsp;N.V.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<BR>/*&nbsp;DESCRIPTION&nbsp;:&nbsp;To&nbsp;use&nbsp;this&nbsp;procedure&nbsp;create&nbsp;it&nbsp;in&nbsp;the&nbsp;master&nbsp;database&nbsp;and&nbsp;run&nbsp;it&nbsp;from&nbsp;any&nbsp;tool&nbsp;that&nbsp;can&nbsp;return&nbsp;*/<BR>/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;print&nbsp;statement.&nbsp;Save&nbsp;the&nbsp;output&nbsp;result&nbsp;as&nbsp;&nbsp;*.sql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&nbsp;<BR>/*&nbsp;*************************************************************************************************************&nbsp;*/</P>
<P>set&nbsp;nocount&nbsp;on</P>
<P>declare&nbsp;@name&nbsp;&nbsp;sysname<BR>declare&nbsp;@text&nbsp;&nbsp;varchar(4096)<BR>declare&nbsp;@SQL&nbsp;varchar(255)</P>
<P>declare&nbsp;cur_triggers&nbsp;insensitive&nbsp;cursor&nbsp;for</P>
<P>&nbsp;&nbsp;select&nbsp;name&nbsp;from&nbsp;sysobjects&nbsp;where&nbsp;OBJECTPROPERTY(id,&nbsp;'ISTRIGGER')&nbsp;=&nbsp;1</P>
<P>open&nbsp;cur_triggers</P>
<P>fetch&nbsp;next&nbsp;from&nbsp;cur_triggers&nbsp;into&nbsp;@name<BR>while&nbsp;(@@fetch_status&nbsp;&lt;&gt;&nbsp;-1)&nbsp;begin</P>
<P>print&nbsp;'/*&nbsp;DROP&nbsp;TRIGGER&nbsp;'&nbsp;+&nbsp;@name&nbsp;+&nbsp;'&nbsp;-----------------------------------------&nbsp;*/'<BR>print&nbsp;'/*&nbsp;SCRIPTED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;+&nbsp;Convert(varchar(50),GETDATE())&nbsp;+&nbsp;'&nbsp;----------------&nbsp;*/'</P>
<P>select&nbsp;@text&nbsp;=&nbsp;'if&nbsp;exists&nbsp;(select&nbsp;*&nbsp;from&nbsp;sysobjects&nbsp;where&nbsp;id&nbsp;=&nbsp;object_id(N'''&nbsp;+&nbsp;@name&nbsp;+&nbsp;''')&nbsp;and&nbsp;OBJECTPROPERTY(id,&nbsp;N''IsTrigger'')&nbsp;=&nbsp;1)'<BR>print&nbsp;@text<BR>select&nbsp;@text&nbsp;=&nbsp;'drop&nbsp;trigger&nbsp;'&nbsp;+&nbsp;@name&nbsp;<BR>print&nbsp;@text<BR>print&nbsp;'GO'</P>
<P>print&nbsp;'/*&nbsp;CREATE&nbsp;TRIGGER&nbsp;'&nbsp;+&nbsp;@name&nbsp;+&nbsp;'----------------------------------------&nbsp;*/'<BR>print&nbsp;'/*&nbsp;SCRIPTED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;+&nbsp;Convert(varchar(50),GETDATE())&nbsp;+&nbsp;'&nbsp;--------------&nbsp;*/'<BR>print&nbsp;''</P>
<P>select&nbsp;@text&nbsp;=&nbsp;text&nbsp;from&nbsp;syscomments&nbsp;where&nbsp;id&nbsp;=&nbsp;OBJECT_ID(@name)<BR>print&nbsp;@text<BR>print&nbsp;'GO'</P>
<P>fetch&nbsp;next&nbsp;from&nbsp;cur_triggers&nbsp;into&nbsp;@name<BR>end</P>
<P>close&nbsp;cur_triggers</P>
<P>deallocate&nbsp;cur_triggers</P>
<P><BR>set&nbsp;nocount&nbsp;off</P></FONT>