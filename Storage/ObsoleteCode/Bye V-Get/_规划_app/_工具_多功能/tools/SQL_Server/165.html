<meta http-equiv="content-type" content="text/html; charset=gb2312">&nbsp;<FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>特殊案例（quicksilver）</B><BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://www.delphibbs.com/delphibbs/dispq.asp?lid=1399372" 
target=_blank>http://www.delphibbs.com/delphibbs/dispq.asp?lid=1399372</A><BR>有三个表：a,b,c<BR>a:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:<BR>a1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2<BR>-----------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------------------<BR>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1_1<BR>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1_2<BR>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1_3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2_1<BR>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2_2<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2_3<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3_1<BR>现想得出如下表：<BR>a1&nbsp;&nbsp;a2&nbsp;&nbsp;&nbsp;b2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2<BR>----------------------<BR>1&nbsp;&nbsp;&nbsp;a1&nbsp;&nbsp;&nbsp;b1_1&nbsp;&nbsp;&nbsp;c1_1<BR>1&nbsp;&nbsp;&nbsp;a1&nbsp;&nbsp;&nbsp;b1_2&nbsp;&nbsp;&nbsp;c1_2<BR>1&nbsp;&nbsp;&nbsp;a1&nbsp;&nbsp;&nbsp;b1_3<BR>2&nbsp;&nbsp;&nbsp;a2&nbsp;&nbsp;&nbsp;b2_1&nbsp;&nbsp;&nbsp;c2_1<BR>2&nbsp;&nbsp;&nbsp;a2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2_2<BR>2&nbsp;&nbsp;&nbsp;a2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2_3<BR>3&nbsp;&nbsp;&nbsp;a3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3_1
<P></P>
<P>select&nbsp;identity(int,1,1)&nbsp;as&nbsp;tmp,b1,b2<BR>into&nbsp;#temp1<BR>from&nbsp;b<BR>order&nbsp;by&nbsp;b1,b2<BR>go</P>
<P>select&nbsp;identity(int,1,1)&nbsp;as&nbsp;tmp,c1,c2<BR>into&nbsp;#temp2<BR>from&nbsp;c<BR>order&nbsp;by&nbsp;c1,c2<BR>go</P>
<P>Select&nbsp;BB.b1,BB.b2,CC.c1,CC.c2<BR>Into&nbsp;#temp3<BR>From&nbsp;(select&nbsp;b1,b2,(select&nbsp;count(*)+1&nbsp;from&nbsp;#temp1&nbsp;where&nbsp;tmp&lt;AA.tmp&nbsp;and&nbsp;b1=AA.b1)&nbsp;tmpid&nbsp;from&nbsp;#temp1&nbsp;AA)&nbsp;BB<BR>Full&nbsp;OUTER&nbsp;JOIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select&nbsp;c1,c2,(select&nbsp;count(*)+1&nbsp;from&nbsp;#temp2&nbsp;where&nbsp;tmp&lt;AA.tmp&nbsp;and&nbsp;c1=AA.c1)&nbsp;tmpid&nbsp;from&nbsp;#temp2&nbsp;AA)&nbsp;CC<BR>ON&nbsp;BB.b1=CC.c1&nbsp;and&nbsp;BB.tmpid=CC.tmpid<BR>go</P>
<P>Select&nbsp;a1,a2,b2,c2<BR>From&nbsp;A&nbsp;AA&nbsp;<BR>Full&nbsp;outer&nbsp;join&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#temp3&nbsp;BB<BR>On&nbsp;AA.a1=BB.b1&nbsp;or&nbsp;AA.a1=BB.c1<BR>order&nbsp;by&nbsp;a1<BR>go</P></FONT>