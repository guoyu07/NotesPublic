<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>金额阿拉伯数字转换为中文的自定义函数(_rambo)</B><BR>CREATE&nbsp;FUNCTION&nbsp;ChangeBigSmall<BR>(@ChangeMoney&nbsp;money)&nbsp;&nbsp;<BR>RETURNS&nbsp;VarChar(100)&nbsp;AS&nbsp;&nbsp;
<P></P>
<P>BEGIN&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;&nbsp;&nbsp;&nbsp;@String1&nbsp;&nbsp;&nbsp;&nbsp;char(20)<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;&nbsp;&nbsp;&nbsp;@String2&nbsp;&nbsp;&nbsp;&nbsp;char(30)<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;&nbsp;&nbsp;&nbsp;@String4&nbsp;&nbsp;&nbsp;&nbsp;Varchar(100)<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;@String3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Varchar(100)&nbsp;&nbsp;&nbsp;&nbsp;--从原A值中取出的值<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;@i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--循环变量<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;@J&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--A的值乘以100的字符串长度<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;@Ch1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Varchar(100)&nbsp;&nbsp;&nbsp;&nbsp;--数字的汉语读法<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;@Ch2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Varchar(100)&nbsp;&nbsp;&nbsp;&nbsp;--数字位的汉字读法<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;@Zero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--用来计算连续有几个零<BR>&nbsp;&nbsp;&nbsp;&nbsp;Declare&nbsp;&nbsp;&nbsp;&nbsp;@Returnvalue&nbsp;&nbsp;&nbsp;&nbsp;VarChar(100)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;&nbsp;@Returnvalue&nbsp;=&nbsp;''<BR>&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@String1&nbsp;=&nbsp;'零壹贰叁肆伍陆柒捌玖'<BR>&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;&nbsp;&nbsp;&nbsp;@String2&nbsp;=&nbsp;'万仟佰拾亿仟佰拾万仟佰拾元角分'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@String4&nbsp;=&nbsp;Cast(@ChangeMoney*100&nbsp;as&nbsp;int)&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@J=len(cast((@ChangeMoney*100)&nbsp;as&nbsp;int))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@String2=Right(@String2,@J)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;&nbsp;&nbsp;&nbsp;@i&nbsp;=&nbsp;1&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;&nbsp;&nbsp;&nbsp;@i&lt;=&nbsp;@j&nbsp;Begin</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@String3&nbsp;=&nbsp;Substring(@String4,@i,1)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;@String3&lt;&gt;'0'&nbsp;Begin</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Ch1&nbsp;=&nbsp;Substring(@String1,&nbsp;Cast(@String3&nbsp;as&nbsp;Int)&nbsp;+&nbsp;1,&nbsp;1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;&nbsp;&nbsp;&nbsp;@Ch2&nbsp;=&nbsp;Substring(@String2,&nbsp;@i,&nbsp;1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;&nbsp;&nbsp;&nbsp;@Zero&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--表示本位不为零<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;Begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;(@Zero&nbsp;=&nbsp;0)&nbsp;Or&nbsp;(@i&nbsp;=&nbsp;@J&nbsp;-&nbsp;9)&nbsp;Or&nbsp;(@i&nbsp;=&nbsp;@J&nbsp;-&nbsp;5)&nbsp;Or&nbsp;(@i&nbsp;=&nbsp;@J&nbsp;-&nbsp;1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Ch1&nbsp;=&nbsp;'零'&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Ch1&nbsp;=&nbsp;''</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Zero&nbsp;=&nbsp;@Zero&nbsp;+&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--表示本位为0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--如果转换的数值需要扩大，那么需改动以下表达式&nbsp;I&nbsp;的值。<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Ch2&nbsp;=&nbsp;''</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;@i&nbsp;=&nbsp;@J&nbsp;-&nbsp;10&nbsp;&nbsp;Begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Ch2&nbsp;=&nbsp;'亿'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Zero&nbsp;=&nbsp;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;@i&nbsp;=&nbsp;@J&nbsp;-&nbsp;6&nbsp;Begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Ch2&nbsp;=&nbsp;'万'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Zero&nbsp;=&nbsp;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;@i&nbsp;=&nbsp;@J&nbsp;-&nbsp;2&nbsp;Begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Ch2&nbsp;=&nbsp;'元'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Zero&nbsp;=&nbsp;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;@i&nbsp;=&nbsp;@J&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Ch2&nbsp;=&nbsp;'整'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;@Returnvalue&nbsp;+&nbsp;@Ch1&nbsp;+&nbsp;@Ch2</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@i&nbsp;=&nbsp;@i+1<BR>&nbsp;&nbsp;&nbsp;&nbsp;end</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;--最后将多余的零去掉<BR>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('仟仟',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'仟仟',&nbsp;'仟')</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('佰佰',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'佰佰',&nbsp;'佰')</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('零元',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'零元',&nbsp;'元')<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('零万',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'零万',&nbsp;'万')<BR>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('零亿',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'零亿',&nbsp;'亿')<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('零整',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'零整',&nbsp;'整')<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('零佰',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'零佰',&nbsp;'零')</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('零仟',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'零仟',&nbsp;'零')</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;CharIndex('元元',@Returnvalue)&nbsp;&lt;&gt;&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;@Returnvalue&nbsp;=&nbsp;Replace(@Returnvalue,&nbsp;'元元',&nbsp;'元')</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;@Returnvalue</P>
<P>END</P></FONT>