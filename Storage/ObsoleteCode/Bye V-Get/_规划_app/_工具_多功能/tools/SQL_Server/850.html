<meta http-equiv="content-type" content="text/html; charset=gb2312">&nbsp;<FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>今天是星期几</B><BR>Day&nbsp;of&nbsp;Week<BR>Script&nbsp;Rating&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total&nbsp;number&nbsp;of&nbsp;votes&nbsp;[5]&nbsp;<BR>By:&nbsp;michael.rosqvist&nbsp;<BR>To&nbsp;find&nbsp;the&nbsp;day&nbsp;of&nbsp;week,&nbsp;regardless&nbsp;of<BR>-SET&nbsp;DATEFIRST&nbsp;<BR>-SET&nbsp;DATEFORMAT&nbsp;<BR>-SET&nbsp;LANGUAGE
<P></P>
<P>The&nbsp;first&nbsp;one&nbsp;is&nbsp;based&nbsp;on&nbsp;Zellers&nbsp;Congruence.<BR>The&nbsp;second&nbsp;one&nbsp;is&nbsp;a&nbsp;SQL&nbsp;server&nbsp;proprietary.&nbsp;</P>
<P>DECLARE&nbsp;@sDate&nbsp;char(8)<BR>SET&nbsp;@sDate&nbsp;=&nbsp;''''19650124''''&nbsp;--Winston&nbsp;Churchills&nbsp;last&nbsp;day<BR>SELECT&nbsp;CASE&nbsp;&nbsp;CAST(DATEDIFF(DAY,''''17530101'''',@sDate)&nbsp;AS&nbsp;int)<BR>&nbsp;-&nbsp;&nbsp;(&nbsp;CAST(DATEDIFF(DAY,''''17530101'''',@sDate)&nbsp;AS&nbsp;int)&nbsp;/&nbsp;7)&nbsp;*&nbsp;7<BR>WHEN&nbsp;0&nbsp;THEN&nbsp;''''Monday''''<BR>WHEN&nbsp;1&nbsp;THEN&nbsp;''''Tuesday''''<BR>WHEN&nbsp;2&nbsp;THEN&nbsp;''''Wednesday''''<BR>WHEN&nbsp;3&nbsp;THEN&nbsp;''''Thursday''''<BR>WHEN&nbsp;4&nbsp;THEN&nbsp;''''Friday''''<BR>WHEN&nbsp;5&nbsp;THEN&nbsp;''''Saturday''''<BR>WHEN&nbsp;6&nbsp;THEN&nbsp;''''Sunday''''<BR>ELSE&nbsp;NULL<BR>END</P>
<P>SELECT&nbsp;CASE(datepart(dw,&nbsp;''''19650124'''')+&nbsp;@@datefirst)%7&nbsp;<BR>WHEN&nbsp;2&nbsp;THEN&nbsp;''''Monday''''<BR>WHEN&nbsp;3&nbsp;THEN&nbsp;''''Tuesday''''<BR>WHEN&nbsp;4&nbsp;THEN&nbsp;''''Wednesday''''<BR>WHEN&nbsp;5&nbsp;THEN&nbsp;''''Thursday''''<BR>WHEN&nbsp;6&nbsp;THEN&nbsp;''''Friday''''<BR>WHEN&nbsp;0&nbsp;THEN&nbsp;''''Saturday''''<BR>WHEN&nbsp;1&nbsp;THEN&nbsp;''''Sunday''''<BR>ELSE&nbsp;NULL<BR>END</P>
<P>//今天是星期几,第一个不知什么意思<BR>SELECT&nbsp;CASE(datepart(dw,&nbsp;getdate())+&nbsp;@@datefirst)%7&nbsp;<BR>WHEN&nbsp;2&nbsp;THEN&nbsp;''Monday''<BR>WHEN&nbsp;3&nbsp;THEN&nbsp;''Tuesday''<BR>WHEN&nbsp;4&nbsp;THEN&nbsp;''Wednesday''<BR>WHEN&nbsp;5&nbsp;THEN&nbsp;''Thursday''<BR>WHEN&nbsp;6&nbsp;THEN&nbsp;''Friday''<BR>WHEN&nbsp;0&nbsp;THEN&nbsp;''Saturday''<BR>WHEN&nbsp;1&nbsp;THEN&nbsp;''Sunday''<BR>ELSE&nbsp;NULL<BR>END</P></FONT>