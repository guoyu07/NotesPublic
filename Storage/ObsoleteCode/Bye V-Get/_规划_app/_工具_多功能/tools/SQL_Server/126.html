<meta http-equiv="content-type" content="text/html; charset=gb2312">
<BLOCKQUOTE><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Handling&nbsp;The&nbsp;Text&nbsp;Data&nbsp;Type</B><BR>Introduction<BR>In&nbsp;this&nbsp;article&nbsp;I&nbsp;plan&nbsp;to&nbsp;show&nbsp;you&nbsp;various&nbsp;ways&nbsp;you&nbsp;can&nbsp;manipulate&nbsp;the&nbsp;data&nbsp;stored&nbsp;in&nbsp;a&nbsp;text&nbsp;data&nbsp;type.&nbsp;These&nbsp;techniques&nbsp;will&nbsp;be&nbsp;particularly&nbsp;useful&nbsp;when&nbsp;the&nbsp;number&nbsp;of&nbsp;characters&nbsp;in&nbsp;the&nbsp;text&nbsp;column&nbsp;exceeds&nbsp;8,000.&nbsp;They&nbsp;may&nbsp;not&nbsp;work&nbsp;when&nbsp;the&nbsp;text&nbsp;in&nbsp;row&nbsp;option&nbsp;has&nbsp;been&nbsp;set&nbsp;for&nbsp;a&nbsp;table.&nbsp;Everything&nbsp;I&nbsp;explain&nbsp;here&nbsp;will&nbsp;focus&nbsp;on&nbsp;manipulating&nbsp;columns&nbsp;of&nbsp;data&nbsp;type&nbsp;text&nbsp;when&nbsp;the&nbsp;text&nbsp;in&nbsp;row&nbsp;option&nbsp;is&nbsp;not&nbsp;enabled&nbsp;for&nbsp;a&nbsp;table.&nbsp;I&nbsp;will&nbsp;focus&nbsp;on&nbsp;the&nbsp;text&nbsp;data&nbsp;type&nbsp;because&nbsp;I&nbsp;am&nbsp;most&nbsp;familiar&nbsp;with&nbsp;it,&nbsp;although&nbsp;it&nbsp;is&nbsp;possible&nbsp;that&nbsp;much&nbsp;of&nbsp;what&nbsp;I&nbsp;show&nbsp;here&nbsp;will&nbsp;work&nbsp;for&nbsp;ntext&nbsp;and&nbsp;maybe&nbsp;even&nbsp;image&nbsp;data&nbsp;types.
<P></P>
<P>This&nbsp;article&nbsp;will&nbsp;give&nbsp;you&nbsp;an&nbsp;understanding&nbsp;of&nbsp;the&nbsp;text&nbsp;data&nbsp;type,&nbsp;show&nbsp;you&nbsp;how&nbsp;to&nbsp;get&nbsp;the&nbsp;pointer&nbsp;for&nbsp;a&nbsp;column&nbsp;with&nbsp;data&nbsp;type&nbsp;text,&nbsp;how&nbsp;to&nbsp;update&nbsp;the&nbsp;value&nbsp;of&nbsp;that&nbsp;column&nbsp;using&nbsp;the&nbsp;pointer,&nbsp;and&nbsp;a&nbsp;few&nbsp;other&nbsp;functions&nbsp;that&nbsp;work&nbsp;with&nbsp;the&nbsp;text&nbsp;data&nbsp;type.&nbsp;<BR>Text&nbsp;Data&nbsp;Type<BR>Most&nbsp;of&nbsp;the&nbsp;functions&nbsp;and&nbsp;techniques&nbsp;you&nbsp;can&nbsp;use&nbsp;for&nbsp;other&nbsp;character&nbsp;data&nbsp;types&nbsp;will&nbsp;not&nbsp;work&nbsp;on&nbsp;a&nbsp;text&nbsp;data&nbsp;type.&nbsp;The&nbsp;data&nbsp;in&nbsp;columns&nbsp;of&nbsp;data&nbsp;type&nbsp;text&nbsp;are&nbsp;not&nbsp;normally&nbsp;stored&nbsp;on&nbsp;the&nbsp;same&nbsp;data&nbsp;page&nbsp;with&nbsp;the&nbsp;data&nbsp;in&nbsp;other&nbsp;columns&nbsp;of&nbsp;a&nbsp;table.&nbsp;What&nbsp;is&nbsp;stored&nbsp;with&nbsp;the&nbsp;other&nbsp;columns&nbsp;of&nbsp;a&nbsp;table&nbsp;is&nbsp;the&nbsp;pointer&nbsp;that&nbsp;tells&nbsp;SQL&nbsp;Server&nbsp;where&nbsp;it&nbsp;can&nbsp;find&nbsp;the&nbsp;characters&nbsp;you&nbsp;store&nbsp;in&nbsp;the&nbsp;text&nbsp;column.&nbsp;I&nbsp;believe&nbsp;this&nbsp;is&nbsp;what&nbsp;makes&nbsp;SQL&nbsp;Server&nbsp;treat&nbsp;the&nbsp;text&nbsp;data&nbsp;type&nbsp;differently.</P>
<P>You&nbsp;can’t&nbsp;concatenate&nbsp;characters&nbsp;to&nbsp;a&nbsp;text&nbsp;data&nbsp;type&nbsp;the&nbsp;way&nbsp;you&nbsp;would&nbsp;for&nbsp;a&nbsp;varchar&nbsp;column.&nbsp;You&nbsp;must&nbsp;first&nbsp;cast&nbsp;the&nbsp;text&nbsp;column&nbsp;to&nbsp;a&nbsp;varchar&nbsp;and&nbsp;then&nbsp;concatenate.&nbsp;That&nbsp;works&nbsp;fine&nbsp;until&nbsp;you&nbsp;have&nbsp;more&nbsp;than&nbsp;8,000&nbsp;characters&nbsp;in&nbsp;your&nbsp;text&nbsp;column.</P>
<P>You&nbsp;can’t&nbsp;use&nbsp;the&nbsp;function’s&nbsp;LEFT,&nbsp;RIGHT,&nbsp;or&nbsp;LEN&nbsp;on&nbsp;a&nbsp;column&nbsp;of&nbsp;data&nbsp;type&nbsp;text&nbsp;without&nbsp;casting&nbsp;the&nbsp;column&nbsp;as&nbsp;varchar(8000).&nbsp;Again,&nbsp;you&nbsp;will&nbsp;be&nbsp;fine&nbsp;unless&nbsp;you&nbsp;have&nbsp;more&nbsp;than&nbsp;8,000&nbsp;characters&nbsp;in&nbsp;the&nbsp;column.&nbsp;To&nbsp;get&nbsp;the&nbsp;length&nbsp;you&nbsp;can&nbsp;use&nbsp;the&nbsp;function&nbsp;DATALENGTH&nbsp;instead&nbsp;of&nbsp;LEN.&nbsp;<BR>Getting&nbsp;A&nbsp;Text&nbsp;Pointer<BR>The&nbsp;following&nbsp;code&nbsp;will&nbsp;get&nbsp;and&nbsp;display&nbsp;a&nbsp;pointer&nbsp;value:&nbsp;<BR>CREATE&nbsp;TABLE&nbsp;#TestTable&nbsp;<BR>(<BR>&nbsp;RowID&nbsp;int,<BR>&nbsp;ColText&nbsp;text<BR>)</P>
<P>INSERT&nbsp;INTO&nbsp;#TestTable&nbsp;(RowID,ColText)<BR>SELECT&nbsp;1,''</P>
<P>DECLARE&nbsp;@ptrColText&nbsp;varbinary(16)</P>
<P>SELECT&nbsp;@ptrColText&nbsp;=&nbsp;TEXTPTR(ColText)</P>
<P>FROM&nbsp;#TestTable</P>
<P>SELECT&nbsp;@ptrColText<BR>The&nbsp;pointer&nbsp;must&nbsp;be&nbsp;binary(16)&nbsp;or&nbsp;varbinary(16).&nbsp;There&nbsp;must&nbsp;be&nbsp;a&nbsp;value&nbsp;for&nbsp;the&nbsp;column&nbsp;with&nbsp;data&nbsp;type&nbsp;text&nbsp;before&nbsp;a&nbsp;pointer&nbsp;will&nbsp;be&nbsp;established&nbsp;for&nbsp;it,&nbsp;hence&nbsp;the&nbsp;INSERT&nbsp;statement&nbsp;in&nbsp;the&nbsp;above&nbsp;code.&nbsp;The&nbsp;function&nbsp;TEXTPTR&nbsp;gets&nbsp;the&nbsp;pointer&nbsp;value&nbsp;for&nbsp;each&nbsp;row&nbsp;in&nbsp;a&nbsp;result&nbsp;set.</P>
<P>Example&nbsp;1:&nbsp;Concatenation</P>
<P>The&nbsp;UPDATETEXT&nbsp;command&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;correct&nbsp;spelling&nbsp;errors&nbsp;and&nbsp;to&nbsp;make&nbsp;any&nbsp;other&nbsp;modifications&nbsp;and/or&nbsp;additions&nbsp;to&nbsp;the&nbsp;characters&nbsp;in&nbsp;a&nbsp;column&nbsp;of&nbsp;data&nbsp;type&nbsp;text.&nbsp;It&nbsp;also&nbsp;works&nbsp;well&nbsp;when&nbsp;you&nbsp;need&nbsp;to&nbsp;concatenate&nbsp;a&nbsp;list&nbsp;that&nbsp;has&nbsp;more&nbsp;than&nbsp;8,000&nbsp;characters&nbsp;in&nbsp;it.</P>
<P>Here&nbsp;is&nbsp;an&nbsp;example&nbsp;that&nbsp;can&nbsp;be&nbsp;executed&nbsp;after&nbsp;executing&nbsp;the&nbsp;code&nbsp;from&nbsp;the&nbsp;previous&nbsp;section.&nbsp;This&nbsp;code&nbsp;will&nbsp;concatenate&nbsp;numbers&nbsp;to&nbsp;create&nbsp;a&nbsp;coma&nbsp;delimited&nbsp;list&nbsp;that&nbsp;is&nbsp;more&nbsp;than&nbsp;8,000&nbsp;characters&nbsp;long:</P>
<P>DECLARE&nbsp;@value&nbsp;varchar(10),<BR>&nbsp;@Counter&nbsp;int<BR>SET&nbsp;@Counter&nbsp;=&nbsp;1</P>
<P>WHILE&nbsp;@Counter&nbsp;&lt;=&nbsp;2000<BR>BEGIN<BR>&nbsp;SET&nbsp;@value&nbsp;=&nbsp;LTRIM(STR(@Counter))<BR>&nbsp;IF&nbsp;@Counter&nbsp;&lt;&nbsp;2000<BR>&nbsp;&nbsp;SET&nbsp;@value&nbsp;=&nbsp;@value&nbsp;+&nbsp;','<BR>&nbsp;UPDATETEXT&nbsp;#TestTable.ColText&nbsp;@ptrColText&nbsp;NULL&nbsp;0&nbsp;@value&nbsp;</P>
<P>&nbsp;SET&nbsp;@Counter&nbsp;=&nbsp;@Counter&nbsp;+&nbsp;1<BR>END</P>
<P>SELECT&nbsp;DATALENGTH(ColText),&nbsp;*&nbsp;FROM&nbsp;#TestTable<BR>Let&nbsp;us&nbsp;look&nbsp;at&nbsp;the&nbsp;UPDATETEXT&nbsp;command&nbsp;a&nbsp;moment.&nbsp;After&nbsp;the&nbsp;keyword&nbsp;UPDATETEXT&nbsp;you&nbsp;see&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;table&nbsp;followed&nbsp;by&nbsp;a&nbsp;period&nbsp;and&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;column.&nbsp;Next&nbsp;is&nbsp;the&nbsp;variable&nbsp;that&nbsp;holds&nbsp;the&nbsp;pointer.&nbsp;Since&nbsp;each&nbsp;text&nbsp;column&nbsp;has&nbsp;its&nbsp;own&nbsp;pointer&nbsp;this&nbsp;will&nbsp;focus&nbsp;on&nbsp;one&nbsp;row&nbsp;(and&nbsp;only&nbsp;one&nbsp;column)&nbsp;of&nbsp;a&nbsp;table&nbsp;no&nbsp;matter&nbsp;how&nbsp;many&nbsp;rows&nbsp;(and&nbsp;columns)&nbsp;are&nbsp;in&nbsp;a&nbsp;table.</P>
<P>After&nbsp;this&nbsp;you&nbsp;see&nbsp;the&nbsp;word&nbsp;NULL.&nbsp;This&nbsp;is&nbsp;in&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;insert&nbsp;offset.&nbsp;When&nbsp;it&nbsp;is&nbsp;NULL&nbsp;it&nbsp;tells&nbsp;SQL&nbsp;Server&nbsp;to&nbsp;append&nbsp;the&nbsp;new&nbsp;characters&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;all&nbsp;the&nbsp;characters&nbsp;currently&nbsp;in&nbsp;the&nbsp;text&nbsp;column.&nbsp;If&nbsp;the&nbsp;value&nbsp;is&nbsp;0&nbsp;then&nbsp;SQL&nbsp;Server&nbsp;will&nbsp;insert&nbsp;the&nbsp;new&nbsp;characters&nbsp;before&nbsp;all&nbsp;the&nbsp;characters&nbsp;currently&nbsp;in&nbsp;the&nbsp;text&nbsp;column.&nbsp;If&nbsp;you&nbsp;specify&nbsp;a&nbsp;number&nbsp;then&nbsp;it&nbsp;will&nbsp;count&nbsp;from&nbsp;the&nbsp;first&nbsp;character&nbsp;to&nbsp;the&nbsp;number&nbsp;specified&nbsp;and&nbsp;insert&nbsp;the&nbsp;new&nbsp;characters&nbsp;after&nbsp;the&nbsp;one&nbsp;found&nbsp;at&nbsp;that&nbsp;point.</P>
<P>SQL&nbsp;Server&nbsp;will&nbsp;not&nbsp;delete&nbsp;any&nbsp;characters&nbsp;from&nbsp;those&nbsp;in&nbsp;the&nbsp;text&nbsp;column&nbsp;unless&nbsp;you&nbsp;specify&nbsp;a&nbsp;number&nbsp;other&nbsp;than&nbsp;0.&nbsp;In&nbsp;the&nbsp;example&nbsp;above&nbsp;I&nbsp;used&nbsp;a&nbsp;0&nbsp;after&nbsp;the&nbsp;NULL&nbsp;as&nbsp;the&nbsp;delete&nbsp;length&nbsp;to&nbsp;indicate&nbsp;I&nbsp;didn’t&nbsp;want&nbsp;to&nbsp;delete&nbsp;any&nbsp;characters&nbsp;from&nbsp;those&nbsp;already&nbsp;stored.&nbsp;If&nbsp;I&nbsp;had&nbsp;used&nbsp;a&nbsp;value&nbsp;other&nbsp;than&nbsp;0&nbsp;I&nbsp;would&nbsp;have&nbsp;gotten&nbsp;the&nbsp;following&nbsp;error:</P>
<P>Server:&nbsp;Msg&nbsp;7135,&nbsp;Level&nbsp;16,&nbsp;State&nbsp;2,&nbsp;Line&nbsp;29<BR>Deletion&nbsp;length&nbsp;1&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;of&nbsp;available&nbsp;text,&nbsp;ntext,&nbsp;or&nbsp;image&nbsp;data.<BR>The&nbsp;statement&nbsp;has&nbsp;been&nbsp;terminated.</P>
<P>Last&nbsp;I&nbsp;used&nbsp;a&nbsp;variable&nbsp;to&nbsp;supply&nbsp;the&nbsp;characters&nbsp;I&nbsp;wanted&nbsp;to&nbsp;insert&nbsp;into&nbsp;the&nbsp;text&nbsp;column.</P>
<P>Also&nbsp;you&nbsp;will&nbsp;notice&nbsp;that&nbsp;I&nbsp;used&nbsp;the&nbsp;function&nbsp;DATALENGTH&nbsp;in&nbsp;the&nbsp;last&nbsp;query&nbsp;to&nbsp;get&nbsp;the&nbsp;number&nbsp;of&nbsp;characters&nbsp;now&nbsp;stored&nbsp;in&nbsp;the&nbsp;column&nbsp;ColText.&nbsp;The&nbsp;number&nbsp;of&nbsp;characters&nbsp;in&nbsp;the&nbsp;column&nbsp;are&nbsp;8,892.&nbsp;This&nbsp;number&nbsp;is&nbsp;700&nbsp;more&nbsp;than&nbsp;can&nbsp;be&nbsp;viewed&nbsp;in&nbsp;Query&nbsp;Analyzer&nbsp;since&nbsp;it&nbsp;only&nbsp;allows&nbsp;you&nbsp;to&nbsp;view&nbsp;the&nbsp;first&nbsp;8,192&nbsp;characters&nbsp;of&nbsp;each&nbsp;column.&nbsp;In&nbsp;Example&nbsp;3,&nbsp;I&nbsp;will&nbsp;show&nbsp;you&nbsp;a&nbsp;way&nbsp;you&nbsp;can&nbsp;view&nbsp;those&nbsp;extra&nbsp;700&nbsp;characters.</P>
<P>Example&nbsp;2:&nbsp;Misspelled&nbsp;Words&nbsp;</P>
<P>The&nbsp;delete&nbsp;length&nbsp;parameter&nbsp;is&nbsp;useful&nbsp;for&nbsp;correcting&nbsp;spelling&nbsp;errors&nbsp;in&nbsp;a&nbsp;text.&nbsp;Here&nbsp;is&nbsp;an&nbsp;example&nbsp;that&nbsp;will&nbsp;replace&nbsp;a&nbsp;misspelled&nbsp;word&nbsp;with&nbsp;the&nbsp;word&nbsp;spelled&nbsp;correctly:&nbsp;<BR>CREATE&nbsp;TABLE&nbsp;#TestTable&nbsp;<BR>(<BR>&nbsp;RowID&nbsp;int,<BR>&nbsp;ColText&nbsp;text<BR>)</P>
<P>INSERT&nbsp;INTO&nbsp;#TestTable&nbsp;(RowID,ColText)<BR>SELECT&nbsp;1,'Here&nbsp;I&nbsp;have&nbsp;one&nbsp;mispellet&nbsp;word.'<BR>UNION&nbsp;ALL<BR>SELECT&nbsp;2,'Here&nbsp;I&nbsp;have&nbsp;one&nbsp;mispellet&nbsp;word&nbsp;in&nbsp;the&nbsp;first&nbsp;sentance.&nbsp;&nbsp;Another&nbsp;one&nbsp;is&nbsp;mispellet&nbsp;in&nbsp;the&nbsp;second&nbsp;sentance.'</P>
<P>DECLARE&nbsp;@ptrColText&nbsp;varbinary(16),<BR>&nbsp;@RowID&nbsp;int,<BR>&nbsp;@MisspelledWord&nbsp;varchar(40),<BR>&nbsp;@CorrectedWord&nbsp;varchar(40),<BR>&nbsp;@LenMisspelledWord&nbsp;int,<BR>&nbsp;@StartingPosition&nbsp;int</P>
<P>SET&nbsp;@RowID&nbsp;=&nbsp;1<BR>SET&nbsp;@MisspelledWord&nbsp;=&nbsp;'mispellet'<BR>SET&nbsp;@CorrectedWord&nbsp;=&nbsp;'misspelled'<BR>SET&nbsp;@LenMisspelledWord&nbsp;=&nbsp;LEN(@MisspelledWord)</P>
<P>PRINT&nbsp;'Rows&nbsp;in&nbsp;table&nbsp;before&nbsp;correcting&nbsp;spelling&nbsp;errors.'</P>
<P>SELECT&nbsp;*&nbsp;FROM&nbsp;#TestTable&nbsp;WHILE&nbsp;@RowID&nbsp;&lt;=&nbsp;2<BR>BEGIN<BR>&nbsp;SET&nbsp;@StartingPosition&nbsp;=&nbsp;1<BR>&nbsp;--get&nbsp;pointer<BR>&nbsp;SELECT&nbsp;@ptrColText&nbsp;=&nbsp;TEXTPTR(ColText)&nbsp;FROM&nbsp;#TestTable&nbsp;WHERE&nbsp;RowID&nbsp;=&nbsp;@RowID</P>
<P>&nbsp;WHILE&nbsp;@StartingPosition&nbsp;&gt;&nbsp;0<BR>&nbsp;BEGIN<BR>&nbsp;&nbsp;--get&nbsp;starting&nbsp;position&nbsp;of&nbsp;first&nbsp;occurence&nbsp;of&nbsp;characters&nbsp;in&nbsp;@MisspelledWord<BR>&nbsp;&nbsp;SELECT&nbsp;@StartingPosition&nbsp;=&nbsp;CHARINDEX(@MisspelledWord,&nbsp;ColText)&nbsp;-&nbsp;1<BR>&nbsp;&nbsp;FROM&nbsp;#TestTable<BR>&nbsp;&nbsp;WHERE&nbsp;RowID&nbsp;=&nbsp;@RowID</P>
<P>&nbsp;&nbsp;IF&nbsp;@StartingPosition&nbsp;&gt;&nbsp;0<BR>&nbsp;&nbsp;&nbsp;UPDATETEXT&nbsp;#TestTable.ColText&nbsp;@ptrColText&nbsp;@StartingPosition&nbsp;@LenMisspelledWord&nbsp;@CorrectedWord&nbsp;<BR>&nbsp;END</P>
<P>&nbsp;SET&nbsp;@RowID&nbsp;=&nbsp;@RowID&nbsp;+&nbsp;1<BR>END</P>
<P>PRINT&nbsp;'Rows&nbsp;in&nbsp;table&nbsp;after&nbsp;correcting&nbsp;spelling&nbsp;errors.'</P>
<P>SELECT&nbsp;*&nbsp;FROM&nbsp;#TestTable</P>
<P>DROP&nbsp;TABLE&nbsp;#TestTable<BR>Upon&nbsp;execution&nbsp;you&nbsp;will&nbsp;notice&nbsp;that&nbsp;the&nbsp;three&nbsp;occurrences&nbsp;of&nbsp;the&nbsp;word&nbsp;mispellet&nbsp;were&nbsp;replaced&nbsp;with&nbsp;misspelled.&nbsp;CHARINDEX&nbsp;will&nbsp;return&nbsp;a&nbsp;0&nbsp;when&nbsp;the&nbsp;character&nbsp;combination&nbsp;in&nbsp;the&nbsp;variable&nbsp;@MisspelledWord&nbsp;is&nbsp;not&nbsp;found&nbsp;in&nbsp;the&nbsp;column&nbsp;called&nbsp;ColText.&nbsp;Thus&nbsp;all&nbsp;occurrences&nbsp;will&nbsp;be&nbsp;replaced&nbsp;in&nbsp;both&nbsp;rows&nbsp;of&nbsp;the&nbsp;temp&nbsp;table.</P>
<P>Notice&nbsp;that&nbsp;in&nbsp;this&nbsp;example&nbsp;I&nbsp;used&nbsp;variables&nbsp;for&nbsp;the&nbsp;insert&nbsp;offset&nbsp;and&nbsp;the&nbsp;delete&nbsp;length.&nbsp;In&nbsp;the&nbsp;previous&nbsp;example&nbsp;these&nbsp;two&nbsp;parameters&nbsp;were&nbsp;hard&nbsp;coded&nbsp;to&nbsp;one&nbsp;value.&nbsp;<BR>Example&nbsp;3:&nbsp;&nbsp;SUBSTRING</P>
<P>With&nbsp;a&nbsp;column&nbsp;of&nbsp;data&nbsp;type&nbsp;text&nbsp;it&nbsp;can&nbsp;sometimes&nbsp;be&nbsp;difficult&nbsp;to&nbsp;view&nbsp;the&nbsp;characters&nbsp;beyond&nbsp;the&nbsp;first&nbsp;8,000&nbsp;or&nbsp;8,192.&nbsp;A&nbsp;varchar&nbsp;variable&nbsp;can&nbsp;only&nbsp;hold&nbsp;8,000&nbsp;characters.&nbsp;Casting&nbsp;the&nbsp;text&nbsp;column&nbsp;to&nbsp;varchar&nbsp;also&nbsp;will&nbsp;only&nbsp;get&nbsp;you&nbsp;the&nbsp;first&nbsp;8,000&nbsp;characters.&nbsp;Viewing&nbsp;the&nbsp;column&nbsp;in&nbsp;Query&nbsp;Analyzer&nbsp;will&nbsp;only&nbsp;let&nbsp;you&nbsp;see&nbsp;the&nbsp;first&nbsp;8,192&nbsp;characters.&nbsp;Enterprise&nbsp;Manager&nbsp;will&nbsp;display&nbsp;&lt;Long&nbsp;Text&gt;&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;900&nbsp;characters&nbsp;in&nbsp;a&nbsp;text&nbsp;field.&nbsp;A&nbsp;way&nbsp;to&nbsp;view&nbsp;what&nbsp;is&nbsp;beyond&nbsp;the&nbsp;first&nbsp;8,192&nbsp;characters&nbsp;can&nbsp;be&nbsp;useful.&nbsp;One&nbsp;way&nbsp;is&nbsp;to&nbsp;use&nbsp;the&nbsp;function&nbsp;SUBSTRING.&nbsp;Here&nbsp;is&nbsp;how&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;on&nbsp;the&nbsp;data&nbsp;in&nbsp;the&nbsp;temp&nbsp;table&nbsp;from&nbsp;Example&nbsp;1:&nbsp;</P>
<P>SELECT&nbsp;SUBSTRING(ColText,&nbsp;8193,&nbsp;700)<BR>FROM&nbsp;#TestTable<BR>The&nbsp;above&nbsp;query&nbsp;displays&nbsp;the&nbsp;700&nbsp;characters&nbsp;that&nbsp;you&nbsp;couldn’t&nbsp;see&nbsp;in&nbsp;Query&nbsp;Analyzer&nbsp;without&nbsp;using&nbsp;the&nbsp;SUBSTRING&nbsp;function.&nbsp;Using&nbsp;SUBSTRING&nbsp;you&nbsp;can&nbsp;view&nbsp;any&nbsp;section&nbsp;of&nbsp;characters&nbsp;stored&nbsp;in&nbsp;a&nbsp;column&nbsp;with&nbsp;data&nbsp;type&nbsp;text&nbsp;by&nbsp;giving&nbsp;the&nbsp;starting&nbsp;position&nbsp;number&nbsp;and&nbsp;how&nbsp;many&nbsp;characters&nbsp;from&nbsp;that&nbsp;point&nbsp;you&nbsp;want&nbsp;to&nbsp;see.&nbsp;You&nbsp;can&nbsp;use&nbsp;the&nbsp;function&nbsp;CHARINDEX&nbsp;or&nbsp;PATINDEX&nbsp;to&nbsp;find&nbsp;the&nbsp;desired&nbsp;starting&nbsp;point.&nbsp;<BR>Conclusions<BR>In&nbsp;this&nbsp;article&nbsp;you&nbsp;have&nbsp;learned&nbsp;how&nbsp;to&nbsp;get&nbsp;the&nbsp;pointer&nbsp;of&nbsp;a&nbsp;text&nbsp;column&nbsp;and&nbsp;how&nbsp;to&nbsp;use&nbsp;that&nbsp;pointer&nbsp;with&nbsp;the&nbsp;keyword&nbsp;UPDATETEXT&nbsp;to&nbsp;concatenate&nbsp;characters&nbsp;and&nbsp;replace&nbsp;characters&nbsp;in&nbsp;a&nbsp;column&nbsp;of&nbsp;data&nbsp;type&nbsp;text.&nbsp;You’ve&nbsp;also&nbsp;read&nbsp;how&nbsp;you&nbsp;can&nbsp;view&nbsp;characters&nbsp;stored&nbsp;in&nbsp;a&nbsp;column&nbsp;of&nbsp;data&nbsp;type&nbsp;text&nbsp;when&nbsp;they&nbsp;exceed&nbsp;the&nbsp;max&nbsp;normal&nbsp;capabilities&nbsp;of&nbsp;the&nbsp;tools&nbsp;that&nbsp;come&nbsp;with&nbsp;SQL&nbsp;Server.&nbsp;I&nbsp;have&nbsp;not&nbsp;covered&nbsp;every&nbsp;possibility.&nbsp;My&nbsp;intent&nbsp;in&nbsp;this&nbsp;article&nbsp;is&nbsp;to&nbsp;give&nbsp;you&nbsp;a&nbsp;starting&nbsp;point&nbsp;to&nbsp;develop&nbsp;solutions&nbsp;that&nbsp;will&nbsp;be&nbsp;helpful&nbsp;to&nbsp;you.&nbsp;<BR></FONT></P></BLOCKQUOTE>