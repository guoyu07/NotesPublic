<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>DTS(上)</B><BR>DTS简介&nbsp;
<P></P>
<P>　　大多数组织都使用多种格式和多个位置来存储数据。为了支持决策、&nbsp;<BR>改善系统性能或对现有系统进行升级，经常必须将数据从一个数据存储位&nbsp;<BR>置移动到另一个存储位置。&nbsp;</P>
<P>　　Microsoft&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;数据转换服务（DTS&nbsp;）提供一组工具，<BR>可以从不同的源将数据抽取、转换和合并到一个或多个目标位置。借助于<BR>DTS工具，您可以创建适合于您的组织特定需要的自定义移动解决方案，<BR>如以下方案所示：&nbsp;</P>
<P>　　您已在较早版本的&nbsp;SQL&nbsp;Server&nbsp;或另一平台上部署了一个数据库应用&nbsp;<BR>程序，如&nbsp;Microsoft&nbsp;Access.该应用程序的新版本要求&nbsp;SQL&nbsp;Server&nbsp;2000，&nbsp;<BR>因此需要您更改数据库架构并转换某些数据类型。&nbsp;</P>
<P>　　要复制和转换数据，您可以生成一个&nbsp;DTS解决方案，该方案可把数据&nbsp;<BR>库对象从原数据源复制到&nbsp;SQL&nbsp;Server&nbsp;2000数据库中，同时重新映射列并&nbsp;<BR>更改数据类型。可以使用&nbsp;DTS工具运行此解决方案，或者将该解决方案嵌&nbsp;<BR>入您的应用程序。&nbsp;</P>
<P>　　您必须将几个主要的&nbsp;Microsoft&nbsp;Excel电子表格合并到&nbsp;SQL&nbsp;Server&nbsp;<BR>数据库。几个部门会在月末创建这些电子表格，但是并没有设定完成所有&nbsp;<BR>电子表格的时间。&nbsp;</P>
<P>　　要合并电子表格，可以生成一个&nbsp;DTS解决方案，在消息传送到消息队&nbsp;<BR>列时运行该解决方案。此消息触发&nbsp;DTS从电子表格抽取数据，执行所有定&nbsp;<BR>义的转换然后将数据加载到&nbsp;SQL&nbsp;Server&nbsp;数据库中。&nbsp;</P>
<P>　　您的数据仓库包含有关业务操作的历史数据，您使用&nbsp;Microsoft&nbsp;SQL&nbsp;<BR>Server&nbsp;2000&nbsp;分析服务来汇总数据。而该数据仓库每晚需要从联机事务处&nbsp;<BR>理（OLTP）数据库进行更新。OLTP系统每天&nbsp;24&nbsp;小时都在运行，所以性能&nbsp;<BR>至关重要。&nbsp;</P>
<P>　　您可以生成一个&nbsp;DTS解决方案，该方案使用文件传输协议（FTP&nbsp;）将&nbsp;<BR>数据文件移动到本地驱动器，将数据加载到一个实际的表中，然后使用分&nbsp;<BR>析服务对数据进行合计。可以安排每晚运行&nbsp;DTS解决方案，还可以使用新&nbsp;<BR>的&nbsp;DTS记录选项来跟踪该进程的进行时间，从而可以分析不同时间段内的&nbsp;<BR>性能。&nbsp;</P>
<P>什么是&nbsp;DTS？&nbsp;</P>
<P>　　DTS是一组工具，用于一个或多个数据源（如Microsoft&nbsp;SQL&nbsp;Server、&nbsp;<BR>Microsoft&nbsp;Excel&nbsp;或&nbsp;Microsoft&nbsp;Access&nbsp;）间导入、导出和转换各种数据。&nbsp;<BR>通过&nbsp;OLE&nbsp;DB&nbsp;（一种数据访问的开放式标准）提供连接，通过用于&nbsp;ODBC&nbsp;<BR>的&nbsp;OLE&nbsp;DB&nbsp;提供程序来支持&nbsp;ODBC&nbsp;（开放式数据库连接）数据源。&nbsp;</P>
<P>　　可以将&nbsp;DTS解决方案创建为一个或多个软件包。每个软件包可包含一&nbsp;<BR>组已安排好的任务，它们定义要执行的工作、对数据和对象的转换、定义&nbsp;<BR>任务执行的工作流约束条件以及数据源和目标间的连接方式。DTS&nbsp;软件包&nbsp;<BR>还提供一些服务，如记录软件包执行详细情况、控制事务和处理全局变量。&nbsp;</P>
<P>以下工具可用于创建和执行&nbsp;DTS&nbsp;软件包：&nbsp;<BR>●导入/导出向导用于生成相对简单的&nbsp;DTS&nbsp;软件包，并支持数据移植和简&nbsp;<BR>　单转换。&nbsp;<BR>●DTS设计器以图形方式来实现&nbsp;DTS&nbsp;对象模型，可用于创建具有一系列功&nbsp;<BR>　能的&nbsp;DTS&nbsp;软件包。&nbsp;<BR>●DTSRun&nbsp;是用于执行现有&nbsp;DTS&nbsp;软件包的命令提示实用程序。&nbsp;<BR>●DTSRunUI&nbsp;是&nbsp;DTSRun&nbsp;的图形界面，可以传递全局变量以及生成命令行。&nbsp;<BR>●SQLAgent&nbsp;不是&nbsp;DTS&nbsp;应用程序，DTS&nbsp;将其用于安排软件包的执行。&nbsp;</P>
<P>　　使用&nbsp;DTS对象模型还可以用编程方式创建和运行软件包，生成自定义&nbsp;<BR>任务和自定义转换。&nbsp;</P>
<P>DTS&nbsp;的新功能&nbsp;</P>
<P>Microsoft&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;中加入了多种&nbsp;DTS&nbsp;增强功能和新功能：&nbsp;<BR>●新的&nbsp;DTS&nbsp;任务包括&nbsp;FTP&nbsp;任务、执行软件包任务、动态属性任务和信息&nbsp;<BR>　队列任务。&nbsp;<BR>●增强的记录功能可以保存每个软件包的执行信息，从而为您保留一个完&nbsp;<BR>　整的执行历史记录，并可以查看每一任务的每个进程的信息。可以生成&nbsp;<BR>　异常情况文件，文件中包含因错误而无法处理的数据行。&nbsp;<BR>●您可以将&nbsp;DTS&nbsp;软件包另存为&nbsp;Microsoft&nbsp;Visual&nbsp;Basic?&nbsp;文件。&nbsp;<BR>●新的多阶段数据泵允许高级用户自定义不同阶段的数据转换操作。还可&nbsp;<BR>　以将全局变量用作查询的输入参数。&nbsp;<BR>●您可以在&nbsp;DTS&nbsp;转换任务和执行&nbsp;SQL&nbsp;任务时使用参数化源查询。&nbsp;<BR>●可以使用执行软件包任务将全局变量的值从父软件包动态分配到子软件&nbsp;<BR>　包。&nbsp;</P>
<P>使用&nbsp;DTS&nbsp;设计器&nbsp;</P>
<P>　　DTS&nbsp;设计器以图形方式实现&nbsp;DTS对象模型，使您可以用图形方式创建&nbsp;<BR>DTS&nbsp;软件包。您可以使用&nbsp;DTS设计器执行以下任务：&nbsp;<BR>●创建包含一个或多个步骤的的简单软件包。&nbsp;<BR>●创建包括复杂工作流的软件包，这些工作流包括多个步骤，而这些步骤&nbsp;<BR>　使用条件逻辑、事件驱动代码或与数据源的多种连接。&nbsp;<BR>●编辑现有软件包。&nbsp;<BR>　　DTS&nbsp;设计器界面包括一个工作区（用于生成软件包）、几个工具栏&nbsp;<BR>（其中包含可拖动到设计工作表上的软件包元素）以及几个菜单（其中包&nbsp;<BR>含工作流和软件包管理命令）。&nbsp;</P>
<P>　　　　　　　　　　　　图&nbsp;1.&nbsp;DTS&nbsp;设计器界面&nbsp;</P>
<P>　　通过将连接和任务拖动到设计工作表，然后指定工作流的执行顺序，&nbsp;<BR>可以方便地使用&nbsp;DTS设计器来生成功能强大的&nbsp;DTS软件包。以下各部分将&nbsp;<BR>对任务、工作流、连接和转换进行定义，并阐释使用&nbsp;DTS设计器实施&nbsp;DTS&nbsp;<BR>解决方案的方便性。&nbsp;</P>
<P>任务：定义软件包中的步骤&nbsp;</P>
<P>　　一个&nbsp;DTS软件包通常包括一个或多个任务。每个任务定义一个在软件&nbsp;<BR>包执行期间可能要执行的工作项。可以使用这些任务进行以下操作：&nbsp;<BR>●&nbsp;转换数据&nbsp;<BR>转换数据任务&nbsp;用于在源和目标间移动数据，可以选择对数据应用列一级的转换。&nbsp;<BR>数据驱动的查询任务&nbsp;用于对数据执行灵活的基于&nbsp;SQL&nbsp;事务的操作，包括存储过程和&nbsp;INSERT、UPDATE&nbsp;或&nbsp;DELETE&nbsp;语句。&nbsp;<BR>&nbsp;&nbsp;并行数据泵任务1&nbsp;只可按编程方式使用，并行数据泵任务执行的功能与转换数据和数据驱动的查询任务相同，但它支持&nbsp;OLE&nbsp;DB&nbsp;2.5&nbsp;或更高版本所定义的分层次的行集合。&nbsp;</P>
<P><BR>●&nbsp;复制和管理数据&nbsp;<BR>批量插入任务&nbsp;用于快速将大量数据加载到&nbsp;SQL&nbsp;Server&nbsp;表或视图中。&nbsp;<BR>执行&nbsp;SQL&nbsp;任务&nbsp;用于在软件包执行期间运行&nbsp;SQL&nbsp;语句。执行&nbsp;SQL&nbsp;任务还可以保存作为查询结果的数据。&nbsp;<BR>复制&nbsp;SQL&nbsp;Server&nbsp;对象任务&nbsp;用于将&nbsp;SQL&nbsp;Server&nbsp;对象从一个&nbsp;SQL&nbsp;Server&nbsp;或其实例复制到另一个&nbsp;SOL&nbsp;Server&nbsp;或实例。可以复制对象（如：数据和表）以及对象（如：视图和存储过程）的定义。&nbsp;<BR>传输数据库任务1&nbsp;用于将&nbsp;SQL&nbsp;Server&nbsp;数据库从&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;版本或&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例移动或复制到&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例中。&nbsp;<BR>传输错误消息任务1&nbsp;用于将针对用户的错误消息（通过&nbsp;sp_addmessage&nbsp;系统存储过程创建）从&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;或&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例复制到&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例中。&nbsp;&nbsp;<BR>传输登录任务&nbsp;1&nbsp;用于将登录信息从&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;或&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例复制到&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例中。&nbsp;<BR>传输作业任务1&nbsp;用于将作业从&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;或&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例复制到&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例中。&nbsp;<BR>传输主存储过程任务&nbsp;1&nbsp;用于将存储过程从&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;或&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例的主数据库复制到&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;的一个实例的主数据库。&nbsp;</P>
<P><BR>●&nbsp;将任务作为软件包中的作业运行&nbsp;<BR>ActiveX&nbsp;脚本任务&nbsp;用于编写代码以执行在其它&nbsp;DTS&nbsp;任务中无法执行的功能。&nbsp;<BR>动态属性任务1&nbsp;用于在软件包运行时从&nbsp;DTS&nbsp;软件包以外的源检索值，并将这些值分配给选定的软件包属性。&nbsp;<BR>执行软件包任务1&nbsp;用于运行软件包内其它的&nbsp;DTS&nbsp;软件包。&nbsp;<BR>执行进程任务&nbsp;用于运行可执行程序或批处理文件。&nbsp;<BR>文件传输协议&nbsp;(FTP)&nbsp;任务1&nbsp;用于从远程服务器或&nbsp;Internet&nbsp;下载数据文件。&nbsp;<BR>消息队列任务1&nbsp;用于从&nbsp;Microsoft&nbsp;消息队列发送和接收消息。&nbsp;&nbsp;<BR>发送邮件任务&nbsp;用于发送电子邮件消息。&nbsp;<BR>分析服务处理任务2&nbsp;用于对&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;分析服务中定义的一个或多个对象执行处理。&nbsp;<BR>数据挖掘任务1,2&nbsp;用于从&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;分析服务中定义的数据挖掘模式对象中创建谓词查询或输出表。&nbsp;</P>
<P>1&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;中的新功能。&nbsp;<BR>2&nbsp;只在安装了&nbsp;SQL&nbsp;Server&nbsp;2000&nbsp;分析服务的前提下可用。</P></FONT>