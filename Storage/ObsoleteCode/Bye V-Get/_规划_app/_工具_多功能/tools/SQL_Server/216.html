<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Phone&nbsp;Number&nbsp;Convertor</B><BR>Phone&nbsp;Number&nbsp;Convertor
<P></P>
<P></P>
<P><BR>&gt;&gt;Script&nbsp;Language&nbsp;and&nbsp;Platform:&nbsp;MS&nbsp;SQL&nbsp;7.0&nbsp;and&nbsp;MS&nbsp;SQL&nbsp;2000<BR>--Objective:&nbsp;To&nbsp;format&nbsp;the&nbsp;phone&nbsp;number&nbsp;and&nbsp;to&nbsp;convert&nbsp;Alphabetic&nbsp;telephone&nbsp;number&nbsp;to&nbsp;Numeric<BR>--eg:&nbsp;exec&nbsp;telephone&nbsp;'900-call-cloe'&nbsp;will&nbsp;display&nbsp;'(900)225-5256'&nbsp;and&nbsp;<BR>--exec&nbsp;telephone&nbsp;'609@@34$$$6068D'&nbsp;will&nbsp;display&nbsp;(609)346-0683&nbsp;</P>
<P>Author:&nbsp;Claire&nbsp;Hsu&nbsp;</P>
<P></P>
<P><BR>create&nbsp;procedure&nbsp;telephone&nbsp;@phone&nbsp;varchar(100)&nbsp;as</P>
<P>declare&nbsp;@length&nbsp;int<BR>declare&nbsp;@count&nbsp;int<BR>declare&nbsp;@digit&nbsp;varchar(1)<BR>declare&nbsp;@string&nbsp;varchar(100)<BR>declare&nbsp;@ascii&nbsp;int</P>
<P>set&nbsp;@string&nbsp;=&nbsp;''<BR>set&nbsp;@count&nbsp;=&nbsp;1<BR>set&nbsp;@length&nbsp;=&nbsp;len(@phone)<BR>while&nbsp;@count&nbsp;&lt;=@length<BR>begin<BR>set&nbsp;@digit&nbsp;=&nbsp;substring(@phone,&nbsp;@count,&nbsp;1)<BR>set&nbsp;@ascii&nbsp;=&nbsp;ascii(@digit)<BR>&nbsp;if&nbsp;@ascii&nbsp;&gt;=48&nbsp;and&nbsp;@ascii&nbsp;&lt;=57<BR>&nbsp;begin<BR>&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;end<BR>&nbsp;if&nbsp;(@ascii&nbsp;&gt;=97&nbsp;and&nbsp;@ascii&nbsp;&lt;=122)&nbsp;or&nbsp;(@ascii&nbsp;&gt;=65&nbsp;and&nbsp;@ascii&nbsp;&lt;=90)<BR>&nbsp;begin<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('a','b','c')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;2<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&nbsp;end&nbsp;<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('d','e','f')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;3<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&nbsp;end<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('g','h','i')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;4<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&amp;n!<BR>bsp;end&nbsp;<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('j','k','l')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;5<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&nbsp;end<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('m','n','o')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;6<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&nbsp;end<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('p','q','r','s')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;7<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&nbsp;end<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('t','u','v')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;8<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&nbsp;end<BR>&nbsp;&nbsp;if&nbsp;@digit&nbsp;in&nbsp;('w','x','y','z')<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;set&nbsp;@digit&nbsp;=&nbsp;9<BR>&nbsp;&nbsp;set&nbsp;@string&nbsp;=&nbsp;@string&nbsp;+&nbsp;@digit&nbsp;<BR>&nbsp;&nbsp;end</P>
<P>&nbsp;end</P>
<P>&nbsp;</P>
<P>set&nbsp;@count&nbsp;=&nbsp;@count+1<BR>end<BR>set&nbsp;@string&nbsp;=&nbsp;substring&nbsp;(@string,1,10)</P>
<P>set&nbsp;@string&nbsp;=&nbsp;<BR>"("+substring(@string,1,3)+")"+substring(@string,4,3)+"-"+substring(@string,7,4)<BR>print&nbsp;@string</P>
<P>--Usage<BR>--exec&nbsp;telephone&nbsp;'(609ktln1w1!@#@#@$##%$#$^%$^%$&amp;)'<BR>--exec&nbsp;telephone&nbsp;'((888-!@##$#%#$%#$%XXXX-xx'<BR>--exec&nbsp;telephone&nbsp;'800-Aaa-XXxx'<BR>--exec&nbsp;telephone&nbsp;'609@@34$$$6068D'<BR>--exec&nbsp;telephone&nbsp;'900-call-cloe'</P></FONT>