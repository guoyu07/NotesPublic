<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><BR>1.&nbsp;exec&nbsp;procsstab&nbsp;'stor_id','ord_date','qty','sales',1,1&nbsp;--weekday<BR>&nbsp;insert&nbsp;#colnames<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;col1,col2&nbsp;from&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;(select&nbsp;distinct&nbsp;col1=datename(weekday,ord_date),<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col2=datepart(weekday,ord_date),col3=datepart(weekday,ord_date)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sales)xyz<BR>&nbsp;&nbsp;&nbsp;order&nbsp;by&nbsp;col3<BR>2.exec&nbsp;proc&nbsp;'stor_id','ord_date','qty','sales',1,4&nbsp;--quarter<BR>&nbsp;&nbsp;insert&nbsp;#colnames<BR>&nbsp;&nbsp;select&nbsp;col1,col2<BR>&nbsp;&nbsp;from&nbsp;(select&nbsp;distinct&nbsp;col1='quarter_'+datename(quarter,ord_date),<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col2=datepart(quarter,ord_date),col3=datepart(quarter,ord_date)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sales)xyz<BR>&nbsp;&nbsp;order&nbsp;by&nbsp;col3<BR>&nbsp;&nbsp;第二列是仅用于一个数值(0除外),该数值用于当交叉表在过程的后面部分被更新时查找该列.对于非日期型数据,该数值只简单的转换成char并进行比较.<BR>&nbsp;&nbsp;第三列用于提供合适的分类.通过合适的数据类型上进行分组,这些列以合适的顺序被列举出,而不管原始数据类型是什么.</FONT> 