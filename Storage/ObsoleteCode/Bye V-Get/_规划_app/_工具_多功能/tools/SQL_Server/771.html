<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Dynamic&nbsp;String&nbsp;Compare</B><BR>Dynamic&nbsp;String&nbsp;Compare&nbsp;(W/O&nbsp;the&nbsp;dynamic&nbsp;sql)<BR>Script&nbsp;Rating&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total&nbsp;number&nbsp;of&nbsp;votes&nbsp;[3]&nbsp;<BR>By:&nbsp;tcartwright&nbsp;<BR>Purpose:&nbsp;To&nbsp;compare&nbsp;two&nbsp;strings&nbsp;with&nbsp;a&nbsp;supplied&nbsp;operator&nbsp;and&nbsp;return&nbsp;true&nbsp;if&nbsp;the&nbsp;strings&nbsp;evaluate&nbsp;to&nbsp;true&nbsp;using&nbsp;the&nbsp;operator&nbsp;provided.&nbsp;This&nbsp;is&nbsp;useful&nbsp;for&nbsp;stored&nbsp;procs&nbsp;to&nbsp;use&nbsp;instead&nbsp;of&nbsp;dynamic&nbsp;sql.&nbsp;YAY!?Allowing&nbsp;for&nbsp;the&nbsp;operator&nbsp;and&nbsp;value&nbsp;to&nbsp;be&nbsp;passed&nbsp;in&nbsp;as&nbsp;parms.&nbsp;So&nbsp;that&nbsp;the&nbsp;user&nbsp;on&nbsp;the&nbsp;front&nbsp;end&nbsp;can&nbsp;pick&nbsp;the&nbsp;comparison&nbsp;he&nbsp;wants&nbsp;to&nbsp;use&nbsp;against&nbsp;the&nbsp;field&nbsp;being&nbsp;searched.?I&nbsp;based&nbsp;my&nbsp;idea&nbsp;for&nbsp;this&nbsp;function&nbsp;upon&nbsp;2&nbsp;excellent&nbsp;articles&nbsp;from&nbsp;Robert&nbsp;Marda&nbsp;:<BR><IMG 
src="771_files/url[2].gif" align=absMiddle border=0><A 
href="http://www.sqlservercentral.com/columnists/rmarda/howdynamiccanstaticbe.asp" 
target=_blank>http://www.sqlservercentral.com/columnists/rmarda/howdynamiccanstaticbe.asp</A>
<P></P>
<P><IMG src="771_files/url[2].gif" align=absMiddle border=0><A 
href="http://www.sqlservercentral.com/columnists/rmarda/howdynamicsqlcanbestatic2.asp" 
target=_blank>http://www.sqlservercentral.com/columnists/rmarda/howdynamicsqlcanbestatic2.asp</A></P>
<P>EX:&nbsp;SELECT&nbsp;dbo.fnStringCompare('test',&nbsp;default,&nbsp;'test')<BR>OR<BR>??SELECT&nbsp;*&nbsp;FROM&nbsp;TABLE&nbsp;WHERE&nbsp;dbo.fnStringCompare(TABLE.COLUMN,&nbsp;'LIKE&nbsp;%VAL%',&nbsp;'test')&nbsp;=&nbsp;1<BR>???????????<BR>NOTE&nbsp;:&nbsp;Depending&nbsp;upon&nbsp;the&nbsp;collation&nbsp;of&nbsp;your&nbsp;sql&nbsp;server&nbsp;<BR>text&nbsp;case&nbsp;may&nbsp;be&nbsp;important&nbsp;and&nbsp;affect&nbsp;the&nbsp;results<BR>???????????  &nbsp;<BR>Returns&nbsp;(smallint)&nbsp;:??<BR>-1&nbsp;:&nbsp;Null&nbsp;or&nbsp;empty&nbsp;string&nbsp;operator<BR>-2&nbsp;:&nbsp;Invalid&nbsp;operator&nbsp;type<BR>?1&nbsp;:&nbsp;The&nbsp;expression&nbsp;was&nbsp;valid<BR>?0&nbsp;:&nbsp;None&nbsp;of&nbsp;the&nbsp;above&nbsp;was&nbsp;true,&nbsp;and&nbsp;somehow&nbsp;got&nbsp;<BR>  &nbsp;past&nbsp;my&nbsp;checks,&nbsp;should&nbsp;never&nbsp;happen</P>
<P><BR>SET&nbsp;QUOTED_IDENTIFIER&nbsp;ON&nbsp;<BR>GO<BR>SET&nbsp;ANSI_NULLS&nbsp;ON&nbsp;<BR>GO</P>
<P>if&nbsp;exists&nbsp;(select&nbsp;*&nbsp;from&nbsp;dbo.sysobjects&nbsp;where&nbsp;id&nbsp;=&nbsp;object_id(N'[dbo].[fnStringCompare]')&nbsp;and&nbsp;xtype&nbsp;in&nbsp;(N'FN',&nbsp;N'IF',&nbsp;N'TF'))<BR>drop&nbsp;function&nbsp;[dbo].[fnStringCompare]<BR>GO</P>
<P>CREATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUNCTION&nbsp;fnStringCompare(@String1&nbsp;nvarchar(4000),<BR>&nbsp;@Operator&nbsp;varchar(40)&nbsp;=&nbsp;'=',<BR>&nbsp;@String2&nbsp;nvarchar(4000))<BR>RETURNS&nbsp;smallint<BR>AS<BR>BEGIN<BR>&nbsp;--&nbsp;'---------------------------------------------<BR>&nbsp;--&nbsp;'&nbsp;Function&nbsp;fnStringCompare<BR>&nbsp;--&nbsp;'<BR>&nbsp;--&nbsp;'&nbsp;Created&nbsp;by&nbsp;tcartwright&nbsp;/&nbsp;The&nbsp;System&nbsp;Shop&nbsp;Inc.<BR>&nbsp;--&nbsp;'&nbsp;Date:&nbsp;12-06-2002&nbsp;&nbsp;&nbsp;&nbsp;Time:&nbsp;23:14<BR>&nbsp;--&nbsp;'&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;Purpose:&nbsp;To&nbsp;compare&nbsp;two&nbsp;strings&nbsp;with&nbsp;a&nbsp;supplied&nbsp;operator&nbsp;and&nbsp;return&nbsp;true&nbsp;if&nbsp;the&nbsp;strings&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;evaluate&nbsp;to&nbsp;true&nbsp;using&nbsp;the&nbsp;operator&nbsp;provided.&nbsp;This&nbsp;is&nbsp;useful&nbsp;for&nbsp;stored&nbsp;procs&nbsp;to&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;use&nbsp;for&nbsp;where&nbsp;clauses&nbsp;instead&nbsp;of&nbsp;dynamic&nbsp;sql.&nbsp;YEE-HA!&nbsp;Allowing&nbsp;for&nbsp;the&nbsp;operator&nbsp;and&nbsp;value&nbsp;to&nbsp;be&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;passed&nbsp;in&nbsp;as&nbsp;parms.&nbsp;I&nbsp;based&nbsp;my&nbsp;idea&nbsp;for&nbsp;this&nbsp;function&nbsp;upon&nbsp;2&nbsp;excellent&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;articles&nbsp;from&nbsp;Robert&nbsp;Marda&nbsp;:<BR>&nbsp;--&nbsp;'&nbsp;1)&nbsp;<IMG 
src="771_files/url[2].gif" align=absMiddle border=0><A 
href="http://www.sqlservercentral.com/columnists/rmarda/howdynamiccanstaticbe.asp" 
target=_blank>http://www.sqlservercentral.com/columnists/rmarda/howdynamiccanstaticbe.asp</A><BR>&nbsp;--&nbsp;'&nbsp;2)&nbsp;<IMG 
src="771_files/url[2].gif" align=absMiddle border=0><A 
href="http://www.sqlservercentral.com/columnists/rmarda/howdynamicsqlcanbestatic2.asp" 
target=_blank>http://www.sqlservercentral.com/columnists/rmarda/howdynamicsqlcanbestatic2.asp</A><BR>&nbsp;--&nbsp;'<BR>&nbsp;--&nbsp;'&nbsp;EX:&nbsp;SELECT&nbsp;dbo.fnStringCompare('test',&nbsp;default,&nbsp;'test')<BR>&nbsp;--&nbsp;'&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;OR<BR>&nbsp;--&nbsp;'&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;TABLE&nbsp;WHERE&nbsp;dbo.fnStringCompare(TABLE.COLUMN,&nbsp;'LIKE&nbsp;%VAL%',&nbsp;'test')&nbsp;=&nbsp;1<BR>&nbsp;--&nbsp;'&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;OR<BR>&nbsp;--&nbsp;'&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;PROCEDURE&nbsp;spWhereTest(@au_fname&nbsp;varchar(40)&nbsp;=&nbsp;NULL,&nbsp;@au_fname_op&nbsp;varchar(30))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;pubs..authors&nbsp;WHERE&nbsp;dbo.fnStringCompare(au_fname,&nbsp;@au_fname_op,&nbsp;@au_fname)&nbsp;=&nbsp;1<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;=============================================&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;example(s)&nbsp;to&nbsp;execute&nbsp;the&nbsp;store&nbsp;procedure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;=============================================&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXECUTE&nbsp;spWhereTest&nbsp;'e',&nbsp;'LIKE&nbsp;%VAL%'&nbsp;--contains&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXECUTE&nbsp;spWhereTest&nbsp;'e',&nbsp;'LIKE&nbsp;%VAL'&nbsp;--ends&nbsp;with&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXECUTE&nbsp;spWhereTest&nbsp;default,&nbsp;'='&nbsp;--null&nbsp;string,&nbsp;and&nbsp;not&nbsp;checing&nbsp;for&nbsp;nullable&nbsp;so&nbsp;all&nbsp;records&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXECUTE&nbsp;spWhereTest&nbsp;default,&nbsp;'IS&nbsp;NULL'&nbsp;--IS&nbsp;NULL<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;DROP&nbsp;PROCEDURE&nbsp;spWhereTest<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;GO<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;NOTE&nbsp;:&nbsp;Depending&nbsp;upon&nbsp;the&nbsp;collation&nbsp;of&nbsp;your&nbsp;sql&nbsp;server&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;text&nbsp;case&nbsp;may&nbsp;be&nbsp;important&nbsp;and&nbsp;affect&nbsp;the&nbsp;results<BR>&nbsp;--&nbsp;'<BR>&nbsp;--&nbsp;'&nbsp;Returns&nbsp;(smallint)&nbsp;:<BR>&nbsp;--&nbsp;'&nbsp;-1&nbsp;:&nbsp;Null&nbsp;or&nbsp;empty&nbsp;string&nbsp;operator<BR>&nbsp;--&nbsp;'&nbsp;-2&nbsp;:&nbsp;Invalid&nbsp;operator&nbsp;type<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;1&nbsp;:&nbsp;The&nbsp;expression&nbsp;was&nbsp;Valid<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;0&nbsp;:&nbsp;None&nbsp;of&nbsp;the&nbsp;above&nbsp;was&nbsp;true,&nbsp;and&nbsp;somehow&nbsp;got&nbsp;<BR>&nbsp;--&nbsp;'&nbsp;&nbsp;&nbsp;past&nbsp;my&nbsp;checks,&nbsp;should&nbsp;never&nbsp;happen<BR>&nbsp;--&nbsp;'---------------------------------------------</P>
<P>&nbsp;--check&nbsp;if&nbsp;they&nbsp;sent&nbsp;in&nbsp;an&nbsp;operator<BR>&nbsp;IF&nbsp;@Operator&nbsp;IS&nbsp;NULL&nbsp;OR&nbsp;LEN(RTRIM(LTRIM(@Operator)))&nbsp;=&nbsp;0<BR>&nbsp;&nbsp;RETURN&nbsp;-1</P>
<P>&nbsp;--prep&nbsp;the&nbsp;operator<BR>&nbsp;SET&nbsp;@Operator&nbsp;=&nbsp;UPPER(LTRIM(RTRIM(@Operator)))<BR>&nbsp;--remove&nbsp;any&nbsp;arbitrary&nbsp;single&nbsp;quotes<BR>&nbsp;SET&nbsp;@Operator&nbsp;=&nbsp;REPLACE(@Operator,&nbsp;CHAR(39),&nbsp;'')</P>
<P>&nbsp;--check&nbsp;for&nbsp;a&nbsp;Valid&nbsp;operator<BR>&nbsp;IF&nbsp;PATINDEX('%;'&nbsp;+&nbsp;@Operator&nbsp;+&nbsp;';%',&nbsp;';=;!=;&lt;;&lt;=;&gt;;&gt;=;LIKE&nbsp;%VAL%;NOT&nbsp;LIKE&nbsp;%VAL%;LIKE&nbsp;VAL%;NOT&nbsp;LIKE&nbsp;VAL%;LIKE&nbsp;%VAL;NOT&nbsp;LIKE&nbsp;%VAL;IS&nbsp;NULL;IS&nbsp;NOT&nbsp;NULL;')&nbsp;&lt;=&nbsp;0<BR>&nbsp;&nbsp;RETURN&nbsp;-2<BR>&nbsp;<BR>&nbsp;--sent&nbsp;in&nbsp;a&nbsp;null&nbsp;@string2&nbsp;but&nbsp;not&nbsp;checking&nbsp;for&nbsp;nullable&nbsp;<BR>&nbsp;--so&nbsp;it&nbsp;invalidates&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;checks<BR>&nbsp;--allows&nbsp;for&nbsp;the&nbsp;possibility&nbsp;to&nbsp;NOT&nbsp;check<BR>&nbsp;IF&nbsp;@String2&nbsp;IS&nbsp;NULL&nbsp;AND&nbsp;(@Operator&nbsp;&lt;&gt;&nbsp;'IS&nbsp;NULL'&nbsp;AND&nbsp;@Operator&nbsp;&lt;&gt;&nbsp;'IS&nbsp;NOT&nbsp;NULL')<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'='&nbsp;AND&nbsp;@String1&nbsp;=&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;IF&nbsp;(@Operator&nbsp;=&nbsp;'!='&nbsp;OR&nbsp;@Operator&nbsp;=&nbsp;'&lt;&gt;')&nbsp;AND&nbsp;@String1&nbsp;&lt;&gt;&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'&lt;'&nbsp;AND&nbsp;@String1&nbsp;&lt;&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'&lt;='&nbsp;AND&nbsp;@String1&nbsp;&lt;=&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;</P>
<P>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'&gt;'&nbsp;AND&nbsp;@String1&nbsp;&gt;&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'&gt;='&nbsp;AND&nbsp;@String1&nbsp;&gt;=&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;--Contains<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'LIKE&nbsp;%VAL%'&nbsp;AND&nbsp;@String1&nbsp;LIKE&nbsp;'%'&nbsp;+&nbsp;@String2&nbsp;+&nbsp;'%'<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;--Does&nbsp;not&nbsp;contain<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'NOT&nbsp;LIKE&nbsp;%VAL%'&nbsp;AND&nbsp;@String1&nbsp;NOT&nbsp;LIKE&nbsp;'%'&nbsp;+&nbsp;@String2&nbsp;+&nbsp;'%'<BR>&nbsp;&nbsp;RETURN&nbsp;1</P>
<P>&nbsp;--begins&nbsp;with<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'LIKE&nbsp;VAL%'&nbsp;AND&nbsp;@String1&nbsp;LIKE&nbsp;@String2&nbsp;+&nbsp;'%'<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;--does&nbsp;not&nbsp;begin&nbsp;with<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'NOT&nbsp;LIKE&nbsp;VAL%'&nbsp;AND&nbsp;@String1&nbsp;NOT&nbsp;LIKE&nbsp;@String2&nbsp;+&nbsp;'%'<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;--starts&nbsp;with<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'LIKE&nbsp;%VAL'&nbsp;AND&nbsp;@String1&nbsp;LIKE&nbsp;'%'&nbsp;+&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;--does&nbsp;not&nbsp;start&nbsp;with<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'NOT&nbsp;LIKE&nbsp;%VAL'&nbsp;AND&nbsp;@String1&nbsp;NOT&nbsp;LIKE&nbsp;'%'&nbsp;+&nbsp;@String2<BR>&nbsp;&nbsp;RETURN&nbsp;1</P>
<P>&nbsp;--is&nbsp;null&nbsp;:)<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'IS&nbsp;NULL'&nbsp;AND&nbsp;@String1&nbsp;IS&nbsp;NULL<BR>&nbsp;&nbsp;RETURN&nbsp;1<BR>&nbsp;<BR>&nbsp;--is&nbsp;not&nbsp;null<BR>&nbsp;IF&nbsp;@Operator&nbsp;=&nbsp;'IS&nbsp;NOT&nbsp;NULL'&nbsp;AND&nbsp;@String1&nbsp;IS&nbsp;NOT&nbsp;NULL<BR>&nbsp;&nbsp;RETURN&nbsp;1</P>
<P>&nbsp;--IF&nbsp;we&nbsp;got&nbsp;here&nbsp;something&nbsp;is&nbsp;not&nbsp;right&nbsp;:(&nbsp;or&nbsp;we&nbsp;have&nbsp;a&nbsp;PEBCAK&nbsp;issue&nbsp;<BR>&nbsp;--of&nbsp;course&nbsp;it&nbsp;can't&nbsp;be&nbsp;my&nbsp;code.....&nbsp;:D&nbsp;LOL&nbsp;{{Tim&nbsp;C&nbsp;12-06-2002&nbsp;23:13:25}}<BR>&nbsp;--OR&nbsp;it&nbsp;COULD&nbsp;be&nbsp;that&nbsp;the&nbsp;check&nbsp;was&nbsp;invalid.........<BR>&nbsp;RETURN&nbsp;0<BR>END</P>
<P>GO</P>
<P>SET&nbsp;QUOTED_IDENTIFIER&nbsp;OFF&nbsp;<BR>GO<BR>SET&nbsp;ANSI_NULLS&nbsp;ON&nbsp;<BR>GO</P>
<P></P>
<P>&nbsp;<BR>Either&nbsp;cut-and-paste&nbsp;the&nbsp;script&nbsp;from&nbsp;the&nbsp;above&nbsp;box&nbsp;or&nbsp;click&nbsp;the&nbsp;below&nbsp;Full&nbsp;Screen&nbsp;text&nbsp;to&nbsp;go&nbsp;to&nbsp;full&nbsp;screen&nbsp;mode.</P></FONT>