<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>º¯Êý-A&nbsp;Few&nbsp;Meta&nbsp;Data&nbsp;UDFs</B><BR>Introduction<BR>I&nbsp;would&nbsp;like&nbsp;to&nbsp;write&nbsp;the&nbsp;series&nbsp;of&nbsp;articles&nbsp;about&nbsp;useful&nbsp;User-Defined<BR>Functions&nbsp;grouped&nbsp;by&nbsp;the&nbsp;following&nbsp;categories: 

<P></P>
<P>Date&nbsp;and&nbsp;Time&nbsp;User-Defined&nbsp;Functions<BR>Mathematical&nbsp;User-Defined&nbsp;Functions<BR>Metadata&nbsp;User-Defined&nbsp;Functions<BR>Security&nbsp;User-Defined&nbsp;Functions<BR>String&nbsp;User-Defined&nbsp;Functions<BR>System&nbsp;User-Defined&nbsp;Functions<BR>Text&nbsp;and&nbsp;Image&nbsp;User-Defined&nbsp;Functions</P>
<P>In&nbsp;this&nbsp;article,&nbsp;I&nbsp;wrote&nbsp;some&nbsp;useful&nbsp;Meta&nbsp;Data&nbsp;User-Defined<BR>Functions.</P>
<P>Meta&nbsp;Data&nbsp;UDFs<BR>These&nbsp;scalar&nbsp;User-Defined&nbsp;Functions&nbsp;return&nbsp;information&nbsp;about&nbsp;the<BR>database&nbsp;and&nbsp;database&nbsp;objects.</P>
<P>To&nbsp;download&nbsp;Meta&nbsp;Data&nbsp;User-Defined&nbsp;Functions&nbsp;click&nbsp;this&nbsp;link:<BR>Download&nbsp;<BR>Meta&nbsp;Data&nbsp;UDFs</P>
<P>COL_LENGTH2<BR>Returns&nbsp;the&nbsp;defined&nbsp;length&nbsp;(in&nbsp;bytes)&nbsp;of&nbsp;a&nbsp;column&nbsp;for&nbsp;a&nbsp;given&nbsp;table<BR>and&nbsp;for&nbsp;a&nbsp;given&nbsp;database.</P>
<P>Syntax<BR>COL_LENGTH2&nbsp;(&nbsp;'database'&nbsp;,&nbsp;'table'&nbsp;,&nbsp;'column'&nbsp;)</P>
<P>Arguments<BR>'database'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;database.&nbsp;database&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>'table'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;table&nbsp;for&nbsp;which&nbsp;to&nbsp;determine&nbsp;column&nbsp;length<BR>information.&nbsp;table&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>'column'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;column&nbsp;for&nbsp;which&nbsp;to&nbsp;determine&nbsp;length.<BR>column&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>Return&nbsp;Types<BR>int</P>
<P>The&nbsp;function's&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;COL_LENGTH2<BR>&nbsp;&nbsp;(&nbsp;@database&nbsp;sysname,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@table&nbsp;sysname,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@column&nbsp;sysname&nbsp;)<BR>RETURNS&nbsp;int<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;RETURN&nbsp;(COL_LENGTH(@database&nbsp;+&nbsp;'..'&nbsp;+&nbsp;@table,&nbsp;@column))<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>This&nbsp;example&nbsp;returns&nbsp;the&nbsp;defined&nbsp;length&nbsp;(in&nbsp;bytes)&nbsp;of&nbsp;the&nbsp;au_id&nbsp;<BR>column<BR>of&nbsp;the&nbsp;authors&nbsp;table&nbsp;in&nbsp;the&nbsp;pubs&nbsp;database:</P>
<P>SELECT&nbsp;dbo.COL_LENGTH2('pubs',&nbsp;'authors',&nbsp;'au_id')<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------<BR>11</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>COL_ID<BR>Returns&nbsp;the&nbsp;ID&nbsp;of&nbsp;a&nbsp;database&nbsp;column&nbsp;given&nbsp;the&nbsp;corresponding<BR>table&nbsp;name&nbsp;and&nbsp;column&nbsp;name.</P>
<P>Syntax<BR>COL_ID&nbsp;(&nbsp;'table'&nbsp;,&nbsp;'column'&nbsp;)</P>
<P>Arguments<BR>'table'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;table.&nbsp;table&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>'column'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;column.&nbsp;column&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>Return&nbsp;Types<BR>int</P>
<P>The&nbsp;function's&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;COL_ID<BR>&nbsp;&nbsp;(&nbsp;@table&nbsp;sysname,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@column&nbsp;sysname&nbsp;)<BR>RETURNS&nbsp;int<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;DECLARE&nbsp;@col_id&nbsp;int<BR>&nbsp;&nbsp;SELECT&nbsp;@col_id&nbsp;=&nbsp;colid&nbsp;FROM&nbsp;syscolumns<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(@table)&nbsp;AND&nbsp;name&nbsp;=&nbsp;@column<BR>&nbsp;&nbsp;RETURN&nbsp;@col_id<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>This&nbsp;example&nbsp;returns&nbsp;the&nbsp;ID&nbsp;of&nbsp;the&nbsp;au_fname&nbsp;column&nbsp;of&nbsp;the<BR>authors&nbsp;table&nbsp;in&nbsp;the&nbsp;pubs&nbsp;database:</P>
<P>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;dbo.COL_ID('authors',&nbsp;'au_fname')<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------<BR>3</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>INDEX_ID<BR>Returns&nbsp;the&nbsp;ID&nbsp;of&nbsp;an&nbsp;index&nbsp;given&nbsp;the&nbsp;corresponding<BR>table&nbsp;name&nbsp;and&nbsp;index&nbsp;name.</P>
<P>Syntax<BR>INDEX_ID&nbsp;(&nbsp;'table'&nbsp;,&nbsp;'index_name'&nbsp;)</P>
<P>Arguments<BR>'table'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;table.&nbsp;table&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>'index_name'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;index.&nbsp;index_name&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>Return&nbsp;Types<BR>int</P>
<P>The&nbsp;function's&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;INDEX_ID<BR>&nbsp;&nbsp;(&nbsp;@table&nbsp;sysname,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@index_name&nbsp;sysname&nbsp;)<BR>RETURNS&nbsp;int<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;DECLARE&nbsp;@indid&nbsp;int<BR>&nbsp;&nbsp;SELECT&nbsp;@indid&nbsp;=&nbsp;indid&nbsp;FROM&nbsp;sysindexes<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(@table)&nbsp;AND&nbsp;name&nbsp;=&nbsp;@index_name<BR>&nbsp;&nbsp;RETURN&nbsp;@indid<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>This&nbsp;example&nbsp;returns&nbsp;the&nbsp;ID&nbsp;of&nbsp;the&nbsp;aunmind&nbsp;index&nbsp;of&nbsp;the<BR>authors&nbsp;table&nbsp;in&nbsp;the&nbsp;pubs&nbsp;database:</P>
<P>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;dbo.INDEX_ID('authors',&nbsp;'aunmind')<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------<BR>2</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>INDEX_COL2<BR>Returns&nbsp;the&nbsp;indexed&nbsp;column&nbsp;name&nbsp;for&nbsp;a&nbsp;given&nbsp;table&nbsp;and&nbsp;for<BR>a&nbsp;given&nbsp;database.</P>
<P>Syntax<BR>INDEX_COL2&nbsp;(&nbsp;'database'&nbsp;,&nbsp;'table'&nbsp;,&nbsp;index_id&nbsp;,&nbsp;key_id&nbsp;)</P>
<P>Arguments<BR>'database'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;database.&nbsp;database&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>'table'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;table.</P>
<P>index_id</P>
<P>Is&nbsp;the&nbsp;ID&nbsp;of&nbsp;the&nbsp;index.</P>
<P>key_id</P>
<P>Is&nbsp;the&nbsp;ID&nbsp;of&nbsp;the&nbsp;key.</P>
<P>Return&nbsp;Types<BR>nvarchar&nbsp;(256)</P>
<P>The&nbsp;function's&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;INDEX_COL2<BR>&nbsp;&nbsp;(&nbsp;@database&nbsp;sysname,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@table&nbsp;sysname,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@index_id&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@key_id&nbsp;int&nbsp;)<BR>RETURNS&nbsp;nvarchar&nbsp;(256)<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;RETURN&nbsp;(INDEX_COL(@database&nbsp;+&nbsp;'..'&nbsp;+&nbsp;@table,&nbsp;@index_id,&nbsp;@key_id))<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>This&nbsp;example&nbsp;returns&nbsp;the&nbsp;indexed&nbsp;column&nbsp;name&nbsp;of&nbsp;the&nbsp;authors&nbsp;table<BR>in&nbsp;the&nbsp;pubs&nbsp;database&nbsp;(for&nbsp;index_id&nbsp;=&nbsp;2&nbsp;and&nbsp;key_id&nbsp;=&nbsp;1):</P>
<P>SELECT&nbsp;dbo.INDEX_COL2('pubs',&nbsp;'authors',&nbsp;2,&nbsp;1)<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------------------<BR>au_lname</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>ROW_COUNT<BR>Returns&nbsp;the&nbsp;total&nbsp;row&nbsp;count&nbsp;for&nbsp;a&nbsp;given&nbsp;table.</P>
<P>Syntax<BR>ROW_COUNT&nbsp;(&nbsp;'table'&nbsp;)</P>
<P>Arguments<BR>'table'</P>
<P>Is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;table&nbsp;for&nbsp;which&nbsp;to&nbsp;determine&nbsp;the&nbsp;total&nbsp;row&nbsp;count.<BR>table&nbsp;is&nbsp;an&nbsp;expression&nbsp;of&nbsp;type&nbsp;nvarchar.</P>
<P>Return&nbsp;Types<BR>int</P>
<P>The&nbsp;function's&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;ROW_COUNT<BR>&nbsp;&nbsp;(&nbsp;@table&nbsp;sysname&nbsp;)<BR>RETURNS&nbsp;int<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;DECLARE&nbsp;@row_count&nbsp;int<BR>&nbsp;&nbsp;SELECT&nbsp;@row_count&nbsp;=&nbsp;rows&nbsp;FROM&nbsp;sysindexes<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;OBJECT_ID(@table)&nbsp;AND&nbsp;indid&nbsp;&lt;&nbsp;2<BR>&nbsp;&nbsp;RETURN&nbsp;@row_count<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>This&nbsp;example&nbsp;returns&nbsp;the&nbsp;total&nbsp;row&nbsp;count&nbsp;of&nbsp;the&nbsp;authors&nbsp;table<BR>in&nbsp;the&nbsp;pubs&nbsp;database:</P>
<P>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;dbo.ROW_COUNT('authors')<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------<BR>23</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P>See&nbsp;this&nbsp;link&nbsp;for&nbsp;more&nbsp;information:</P></FONT>