<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>取得SQLServer字段的描述内容</B><BR>fn_listextendedproperty<BR>返回数据库对象的扩展属性值。
<P></P>
<P>语法<BR>fn_listextendedproperty&nbsp;(<BR>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;default&nbsp;|&nbsp;[&nbsp;@name&nbsp;=&nbsp;]&nbsp;'property_name'&nbsp;|&nbsp;NULL&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;default&nbsp;|&nbsp;[&nbsp;@level0type&nbsp;=&nbsp;]&nbsp;'level0_object_type'&nbsp;|&nbsp;NULL&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;default&nbsp;|&nbsp;[&nbsp;@level0name&nbsp;=&nbsp;]&nbsp;'level0_object_name'&nbsp;|&nbsp;NULL&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;default&nbsp;|&nbsp;[&nbsp;@level1type&nbsp;=&nbsp;]&nbsp;'level1_object_type'&nbsp;|&nbsp;NULL&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;default&nbsp;|&nbsp;[&nbsp;@level1name&nbsp;=&nbsp;]&nbsp;'level1_object_name'&nbsp;|&nbsp;NULL&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;default&nbsp;|&nbsp;[&nbsp;@level2type&nbsp;=&nbsp;]&nbsp;'level2_object_type'&nbsp;|&nbsp;NULL&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;default&nbsp;|&nbsp;[&nbsp;@level2name&nbsp;=&nbsp;]&nbsp;'level2_object_name'&nbsp;|&nbsp;NULL&nbsp;}&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;</P>
<P>参数<BR>{default|[@name&nbsp;=]&nbsp;'property_name'|NULL}</P>
<P>是属性的名称。property_name&nbsp;为&nbsp;sysname&nbsp;类型。有效的输入为&nbsp;default、NULL&nbsp;或属性名。</P>
<P>{default|[@level0type&nbsp;=]&nbsp;'level0_object_type'|NULL}</P>
<P>用户或用户定义类型。level0_object_type&nbsp;的数据类型为&nbsp;varchar(128)，其默认值为&nbsp;NULL。有效的输入是&nbsp;USER、TYPE、default&nbsp;和&nbsp;NULL。</P>
<P>{default|[@level0name&nbsp;=]&nbsp;'level0_object_name'|NULL}</P>
<P>指定的&nbsp;0&nbsp;级对象类型的名称。level0_object_name&nbsp;的数据类型为&nbsp;sysname，其默认值为&nbsp;NULL。有效的输入为&nbsp;default、NULL&nbsp;或对象名。</P>
<P>{default|[@level1type&nbsp;=]&nbsp;'level1_object_type'|NULL}</P>
<P>1&nbsp;级对象的类型。level1_object_type&nbsp;的数据类型为&nbsp;varchar(128)，其默认值为&nbsp;NULL。有效的输入为&nbsp;TABLE、VIEW、PROCEDURE、FUNCTION、DEFAULT、RULE、default&nbsp;和&nbsp;NULL。&nbsp;</P>
<P></P>
<P>说明&nbsp;&nbsp;默认映射&nbsp;NULL，而"default"映射对象类型&nbsp;DEFAULT。</P>
<P><BR>{default|[@level1name&nbsp;=]&nbsp;'level1_object_name'|NULL}</P>
<P>指定的&nbsp;1&nbsp;级对象类型的名称。level1_object_name&nbsp;的数据类型为&nbsp;sysname，其默认值为&nbsp;NULL。有效的输入为&nbsp;default、NULL&nbsp;或对象名。</P>
<P>{default|[@level2type&nbsp;=]&nbsp;'level2_object_type'|NULL}</P>
<P>2&nbsp;级对象的类型。level2_object_type&nbsp;的数据类型为&nbsp;varchar(128)，其默认值为&nbsp;NULL。有效的输入为&nbsp;COLUMN、PARAMETER、INDEX、CONSTRAINT、TRIGGER、DEFAULT、default（映射&nbsp;NULL）和&nbsp;NULL。</P>
<P>{default|[@level2name&nbsp;=]&nbsp;'level2_object_name'|NULL}</P>
<P>指定的&nbsp;2&nbsp;级对象类型的名称。level2_object_name&nbsp;的数据类型为&nbsp;sysname，其默认值为&nbsp;NULL。有效的输入为&nbsp;default、NULL&nbsp;或对象名。</P>
<P>返回表<BR>下面是&nbsp;fn_listextendedproperty&nbsp;返回的表的格式。</P>
<P>列名&nbsp;数据类型&nbsp;<BR>objtype&nbsp;sysname&nbsp;<BR>objname&nbsp;sysname&nbsp;<BR>name&nbsp;sysname&nbsp;<BR>value&nbsp;sql_variant&nbsp;</P>
<P><BR>如果返回的表为空，可能对象没有扩展属性或用户没有列出对象扩展属性的权限。</P>
<P>注释<BR>系统对象不允许有扩展属性。&nbsp;</P>
<P>如果&nbsp;property_name&nbsp;的值为&nbsp;NULL&nbsp;或&nbsp;default，fn_listextendedproperty&nbsp;返回对象的所有属性。</P>
<P>如果指定了对象类型且相应的对象名的值为&nbsp;NULL&nbsp;或&nbsp;default，则&nbsp;fn_listextendedproperty&nbsp;返回指定类型的所有对象的所有扩展属性。</P>
<P>对象是按级别区分的，0&nbsp;级为最高，2&nbsp;级为最低。如果指定了较低级别的对象（1&nbsp;或&nbsp;2&nbsp;级）类型和名称，则父对象类型和名称的值不能为&nbsp;NULL&nbsp;或&nbsp;default。否则，函数将返回错误。</P>
<P>用于列出某些级别对象类型的扩展属性的权限有所不同。&nbsp;</P>
<P>对于级别&nbsp;0&nbsp;的对象，如果某用户为级别&nbsp;0&nbsp;的名称中所标识的用户，或者是&nbsp;db_owner&nbsp;和&nbsp;db_ddladmin&nbsp;固定数据库角色的成员，则该用户可以列出指定"user"类型的扩展属性。&nbsp;</P>
<P><BR>所有用户可使用&nbsp;0&nbsp;级对象类型"type"列出扩展属性。</P>
<P><BR>对于&nbsp;1&nbsp;级对象，如果用户为对象的所有者或用户对于对象有权限，该用户可以用任何有效的类型值列出扩展属性。&nbsp;</P>
<P><BR>对于&nbsp;2&nbsp;级对象，如果当前用户对父对象（1&nbsp;级和&nbsp;0级）有任何权限，该用户可以用任何有效的类型值列出扩展属性。&nbsp;<BR>示例<BR>此示例列出数据库的所有扩展属性。</P>
<P>SELECT&nbsp;&nbsp;&nbsp;*<BR>FROM&nbsp;&nbsp;&nbsp;::fn_listextendedproperty(NULL,&nbsp;NULL,&nbsp;NULL,&nbsp;NULL,&nbsp;NULL,&nbsp;NULL,&nbsp;NULL)</P>
<P>-或-</P>
<P>SELECT&nbsp;&nbsp;&nbsp;*<BR>FROM&nbsp;&nbsp;&nbsp;::fn_listextendedproperty(default,&nbsp;default,&nbsp;default,&nbsp;default,&nbsp;default,&nbsp;default,&nbsp;default)</P>
<P>此示例列出表"T1"中所有列的所有扩展属性。</P>
<P>CREATE&nbsp;&nbsp;&nbsp;table&nbsp;T1&nbsp;(id&nbsp;int&nbsp;,&nbsp;name&nbsp;char&nbsp;(20))</P>
<P>EXEC&nbsp;&nbsp;&nbsp;sp_addextendedproperty&nbsp;'caption',&nbsp;'Employee&nbsp;ID',&nbsp;'user',&nbsp;dbo,&nbsp;'table',&nbsp;'T1',&nbsp;'column',&nbsp;id</P>
<P>EXEC&nbsp;&nbsp;&nbsp;sp_addextendedproperty&nbsp;'caption',&nbsp;'Employee&nbsp;Name',&nbsp;'user',&nbsp;dbo,&nbsp;'table',&nbsp;'T1',&nbsp;'column',&nbsp;name</P>
<P>SELECT&nbsp;&nbsp;&nbsp;*<BR>FROM&nbsp;&nbsp;&nbsp;::fn_listextendedproperty&nbsp;(NULL,&nbsp;'user',&nbsp;'dbo',&nbsp;'table',&nbsp;'T1',&nbsp;'column',&nbsp;default)</P>
<P>下面是结果集：</P>
<P>objtype&nbsp;objname&nbsp;name&nbsp;value&nbsp;<BR>COLUMN&nbsp;id&nbsp;caption&nbsp;Employee&nbsp;ID&nbsp;<BR>COLUMN&nbsp;name&nbsp;caption&nbsp;Employee&nbsp;N&nbsp;<BR></P></FONT>