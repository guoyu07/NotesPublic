<meta http-equiv="content-type" content="text/html; charset=gb2312">Also&nbsp;they&nbsp;might&nbsp;be&nbsp;used&nbsp;after&nbsp;substantial&nbsp;data&nbsp;population/data&nbsp;scrubbing.&nbsp;
<P></P>
<P>Execution&nbsp;should&nbsp;be&nbsp;done&nbsp;in&nbsp;absence&nbsp;of&nbsp;user&nbsp;activity&nbsp;on&nbsp;the&nbsp;DB&nbsp;(might&nbsp;slow&nbsp;down&nbsp;users).&nbsp;</P>
<P>--&nbsp;exec&nbsp;sp_CheckIdent&nbsp;--&nbsp;checks&nbsp;identity&nbsp;colulmns&nbsp;for&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminReindexTables&nbsp;--&nbsp;reindexes&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminRecompileStoredProc&nbsp;--&nbsp;recompiles&nbsp;all&nbsp;SPs<BR>--&nbsp;go&nbsp;</P>
<P><BR>These&nbsp;SPs&nbsp;were&nbsp;tested&nbsp;against&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;and&nbsp;work&nbsp;on&nbsp;production&nbsp;DBs&nbsp;on&nbsp;<BR>a&nbsp;large&nbsp;Real&nbsp;Estate&nbsp;SQL/VB&nbsp;package.&nbsp;They&nbsp;should&nbsp;work&nbsp;also&nbsp;on&nbsp;6.5&nbsp;and&nbsp;2000&nbsp;SQL&nbsp;Server.</P>
<P>Input&nbsp;-&nbsp;cortesy&nbsp;of&nbsp;Christopher&nbsp;B.&nbsp;Snider:<BR>If&nbsp;your&nbsp;tables&nbsp;contain&nbsp;spaces&nbsp;in&nbsp;table&nbsp;name&nbsp;or&nbsp;some&nbsp;weird&nbsp;symbols,&nbsp;you&nbsp;may&nbsp;try&nbsp;to:<BR>enclose&nbsp;table&nbsp;name&nbsp;in&nbsp;square&nbsp;brackets&nbsp;like&nbsp;this:</P>
<P>exec&nbsp;("dbcc&nbsp;checkident&nbsp;(["&nbsp;+&nbsp;@TableName&nbsp;+&nbsp;"])")</P>
<P>Wrapping&nbsp;the&nbsp;table&nbsp;name&nbsp;in&nbsp;the&nbsp;brackets&nbsp;"[&nbsp;]"&nbsp;allows&nbsp;the&nbsp;odd&nbsp;names&nbsp;that<BR>exist&nbsp;in&nbsp;some&nbsp;DBs.</P>
<P>I&nbsp;also&nbsp;discovered&nbsp;that&nbsp;the&nbsp;brackets&nbsp;do&nbsp;not&nbsp;work&nbsp;at&nbsp;all&nbsp;when&nbsp;the&nbsp;table&nbsp;name&nbsp;has&nbsp;parentheses<BR>"(&nbsp;)"&nbsp;in&nbsp;it.&nbsp;&nbsp;I&nbsp;have&nbsp;some&nbsp;tables&nbsp;in&nbsp;a&nbsp;DB&nbsp;that&nbsp;was&nbsp;written&nbsp;in&nbsp;ACCESS&nbsp;and<BR>migrated&nbsp;to&nbsp;SQL&nbsp;Server&nbsp;that&nbsp;contain&nbsp;the&nbsp;parens...&nbsp;&nbsp;I&nbsp;am&nbsp;still&nbsp;searching<BR>for&nbsp;a&nbsp;better&nbsp;way&nbsp;of&nbsp;accessing&nbsp;those&nbsp;tables&nbsp;with&nbsp;the&nbsp;SP's,&nbsp;but&nbsp;the<BR>sysnames&nbsp;table&nbsp;does&nbsp;not&nbsp;show&nbsp;the&nbsp;name&nbsp;with&nbsp;the&nbsp;parens.</P>
<P></P>
<P>*****************/</P>
<P><BR>CREATE&nbsp;PROCEDURE&nbsp;sp_AdminRecompileStoredProc<BR>AS<BR>BEGIN&nbsp;</P>
<P><BR>/*********************************************************************************&nbsp;<BR>Changes,&nbsp;starting&nbsp;from&nbsp;the&nbsp;latest:</P>
<P>SP&nbsp;written&nbsp;to&nbsp;recompile&nbsp;all&nbsp;user&nbsp;SPs&nbsp;in&nbsp;the&nbsp;current&nbsp;Database</P>
<P>You&nbsp;can&nbsp;schedule&nbsp;these&nbsp;SPs&nbsp;for&nbsp;periodic&nbsp;execution.&nbsp;<BR>They&nbsp;might&nbsp;be&nbsp;useful&nbsp;for&nbsp;defragmenting&nbsp;and&nbsp;speeding&nbsp;up&nbsp;large&nbsp;DBs.&nbsp;<BR>Also&nbsp;they&nbsp;might&nbsp;be&nbsp;used&nbsp;after&nbsp;substantial&nbsp;data&nbsp;population/data&nbsp;scrubbing.&nbsp;</P>
<P>Execution&nbsp;should&nbsp;be&nbsp;done&nbsp;in&nbsp;absence&nbsp;of&nbsp;user&nbsp;activity&nbsp;on&nbsp;the&nbsp;DB&nbsp;(might&nbsp;slow&nbsp;down&nbsp;users).&nbsp;</P>
<P>--&nbsp;exec&nbsp;sp_CheckIdent&nbsp;--&nbsp;checks&nbsp;identity&nbsp;colulmns&nbsp;for&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminReindexTables&nbsp;--&nbsp;reindexes&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminRecompileStoredProc&nbsp;--&nbsp;recompiles&nbsp;all&nbsp;SPs<BR>--&nbsp;go&nbsp;</P>
<P><BR>These&nbsp;SPs&nbsp;were&nbsp;tested&nbsp;against&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;and&nbsp;work&nbsp;on&nbsp;production&nbsp;DBs&nbsp;on&nbsp;<BR>a&nbsp;large&nbsp;Real&nbsp;Estate&nbsp;SQL/VB&nbsp;package.&nbsp;They&nbsp;should&nbsp;work&nbsp;also&nbsp;on&nbsp;6.5&nbsp;and&nbsp;2000&nbsp;SQL&nbsp;Server.</P>
<P></P>
<P>Alexei&nbsp;Akimov&nbsp;alakimov@hotmail.com<BR>Colliers&nbsp;International,&nbsp;SQL&nbsp;DB&nbsp;Design,&nbsp;VB,&nbsp;ASP,&nbsp;Crystal&nbsp;Development<BR>tel:&nbsp;416-777-9377,&nbsp;ext.332<BR>P.S.&nbsp;I&nbsp;am&nbsp;looking&nbsp;for&nbsp;job&nbsp;in&nbsp;SQL&nbsp;Server/Oracle/VB&nbsp;DB&nbsp;Design&nbsp;development<BR>in&nbsp;USA&nbsp;by&nbsp;TN1(Canadian&nbsp;citizen)&nbsp;or&nbsp;H1B&nbsp;Visa.&nbsp;<BR>******************************************************************/</P>
<P></P>
<P>&nbsp;declare&nbsp;&nbsp;@continue&nbsp;integer,<BR>&nbsp;&nbsp;&nbsp;@TableCounter&nbsp;integer,<BR>&nbsp;&nbsp;&nbsp;@string&nbsp;&nbsp;varchar(80),<BR>&nbsp;&nbsp;&nbsp;@TableName&nbsp;varchar(50),<BR>&nbsp;&nbsp;&nbsp;@SQL&nbsp;&nbsp;varchar&nbsp;(255)</P>
<P><BR>&nbsp;set&nbsp;nocount&nbsp;on&nbsp;</P>
<P><BR>&nbsp;declare&nbsp;curTable&nbsp;cursor</P>
<P>&nbsp;for&nbsp;&nbsp;SELECT&nbsp;&nbsp;&nbsp;name<BR>&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;sysobjects<BR>&nbsp;&nbsp;WHERE&nbsp;&nbsp;&nbsp;type&nbsp;=&nbsp;'U'<BR>&nbsp;&nbsp;order&nbsp;by&nbsp;name<BR>&nbsp;for&nbsp;read&nbsp;only</P>
<P>&nbsp;--&nbsp;open&nbsp;cursor<BR>&nbsp;open&nbsp;curTable</P>
<P>&nbsp;select&nbsp;&nbsp;<BR>&nbsp;@continue&nbsp;=&nbsp;1,<BR>&nbsp;@TableCounter&nbsp;=&nbsp;0,<BR>&nbsp;@string&nbsp;&nbsp;=&nbsp;""</P>
<P>&nbsp;while&nbsp;&nbsp;(@continue&nbsp;=&nbsp;1)<BR>&nbsp;begin</P>
<P>&nbsp;&nbsp;fetch&nbsp;&nbsp;next&nbsp;from&nbsp;curTable<BR>&nbsp;&nbsp;into&nbsp;&nbsp;@TableName</P>
<P>&nbsp;&nbsp;if&nbsp;(@@FETCH_STATUS&nbsp;&lt;&gt;&nbsp;0)<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;--fetch&nbsp;failed;&nbsp;end&nbsp;loop<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@continue&nbsp;=&nbsp;0<BR>&nbsp;&nbsp;&nbsp;break<BR>&nbsp;&nbsp;end&nbsp;--if&nbsp;fetchstatus&nbsp;&lt;&gt;&nbsp;0</P>
<P>&nbsp;&nbsp;else&nbsp;--&nbsp;continue&nbsp;next&nbsp;table<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;--successful&nbsp;fetch<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@TableCounter&nbsp;=&nbsp;@TableCounter&nbsp;+&nbsp;1</P>
<P><BR>&nbsp;&nbsp;&nbsp;select&nbsp;@SQL&nbsp;=&nbsp;"sp_recompile&nbsp;"&nbsp;+&nbsp;@TableName</P>
<P>&nbsp;&nbsp;&nbsp;/**********&nbsp;For&nbsp;Debug&nbsp;<BR>&nbsp;&nbsp;&nbsp;select&nbsp;"@SQL"&nbsp;=&nbsp;@SQL<BR>&nbsp;&nbsp;&nbsp;***************************/</P>
<P>&nbsp;&nbsp;&nbsp;exec&nbsp;(@SQL)</P>
<P><BR>&nbsp;&nbsp;end&nbsp;--&nbsp;else&nbsp;successful&nbsp;fetch</P>
<P>&nbsp;end&nbsp;--while&nbsp;(@continue&nbsp;=&nbsp;1)</P>
<P><BR>&nbsp;--&nbsp;final&nbsp;cleanup<BR>&nbsp;close&nbsp;curTable<BR>&nbsp;deallocate&nbsp;curTable</P>
<P>&nbsp;select&nbsp;"Total&nbsp;Number&nbsp;of&nbsp;Tables:"&nbsp;=&nbsp;@TableCounter</P>
<P><BR>END</P>
<P>go</P>
<P><BR>CREATE&nbsp;PROCEDURE&nbsp;sp_AdminReindexTables<BR>AS<BR>BEGIN&nbsp;</P>
<P><BR>/*********************************************************************************&nbsp;<BR>Changes,&nbsp;starting&nbsp;from&nbsp;the&nbsp;latest:</P>
<P>SP&nbsp;written&nbsp;to&nbsp;reindex&nbsp;all&nbsp;user&nbsp;tables&nbsp;in&nbsp;the&nbsp;current&nbsp;DB</P>
<P>You&nbsp;can&nbsp;schedule&nbsp;these&nbsp;SPs&nbsp;for&nbsp;periodic&nbsp;execution.&nbsp;<BR>They&nbsp;might&nbsp;be&nbsp;useful&nbsp;for&nbsp;defragmenting&nbsp;and&nbsp;speeding&nbsp;up&nbsp;large&nbsp;DBs.&nbsp;<BR>Also&nbsp;they&nbsp;might&nbsp;be&nbsp;used&nbsp;after&nbsp;substantial&nbsp;data&nbsp;population/data&nbsp;scrubbing.&nbsp;</P>
<P>Execution&nbsp;should&nbsp;be&nbsp;done&nbsp;in&nbsp;absence&nbsp;of&nbsp;user&nbsp;activity&nbsp;on&nbsp;the&nbsp;DB&nbsp;(might&nbsp;slow&nbsp;down&nbsp;users).&nbsp;</P>
<P>--&nbsp;exec&nbsp;sp_CheckIdent&nbsp;--&nbsp;checks&nbsp;identity&nbsp;colulmns&nbsp;for&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminReindexTables&nbsp;--&nbsp;reindexes&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminRecompileStoredProc&nbsp;--&nbsp;recompiles&nbsp;all&nbsp;SPs<BR>--&nbsp;go&nbsp;</P>
<P><BR>These&nbsp;SPs&nbsp;were&nbsp;tested&nbsp;against&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;and&nbsp;work&nbsp;on&nbsp;production&nbsp;DBs&nbsp;on&nbsp;<BR>a&nbsp;large&nbsp;Real&nbsp;Estate&nbsp;SQL/VB&nbsp;package.&nbsp;They&nbsp;should&nbsp;work&nbsp;also&nbsp;on&nbsp;6.5&nbsp;and&nbsp;2000&nbsp;SQL&nbsp;Server.</P>
<P></P>
<P>Alexei&nbsp;Akimov&nbsp;alakimov@hotmail.com<BR>Colliers&nbsp;International,&nbsp;SQL&nbsp;DB&nbsp;Design,&nbsp;VB,&nbsp;ASP,&nbsp;Crystal&nbsp;Development<BR>tel:&nbsp;416-777-9377,&nbsp;ext.332</P>
<P>P.S.&nbsp;I&nbsp;am&nbsp;looking&nbsp;for&nbsp;job&nbsp;in&nbsp;SQL&nbsp;Server/Oracle/VB&nbsp;DB&nbsp;Design&nbsp;development<BR>in&nbsp;USA&nbsp;by&nbsp;TN1(Canadian&nbsp;citizen)&nbsp;or&nbsp;H1B&nbsp;Visa.&nbsp;</P>
<P><BR>******************************************************************/</P>
<P></P>
<P>&nbsp;declare&nbsp;&nbsp;@continue&nbsp;integer,<BR>&nbsp;&nbsp;&nbsp;@TableCounter&nbsp;integer,<BR>&nbsp;&nbsp;&nbsp;@string&nbsp;&nbsp;varchar(80),<BR>&nbsp;&nbsp;&nbsp;@TableName&nbsp;varchar(50),<BR>&nbsp;&nbsp;&nbsp;@SQL&nbsp;&nbsp;varchar&nbsp;(255)</P>
<P><BR>&nbsp;set&nbsp;nocount&nbsp;on&nbsp;</P>
<P><BR>&nbsp;declare&nbsp;curTable&nbsp;cursor</P>
<P>&nbsp;for&nbsp;&nbsp;SELECT&nbsp;&nbsp;&nbsp;name<BR>&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;sysobjects<BR>&nbsp;&nbsp;WHERE&nbsp;&nbsp;&nbsp;type&nbsp;=&nbsp;'U'</P>
<P>&nbsp;&nbsp;order&nbsp;by&nbsp;name<BR>&nbsp;for&nbsp;read&nbsp;only</P>
<P>&nbsp;--&nbsp;open&nbsp;cursor<BR>&nbsp;open&nbsp;curTable</P>
<P>&nbsp;select&nbsp;&nbsp;<BR>&nbsp;@continue&nbsp;=&nbsp;1,<BR>&nbsp;@TableCounter&nbsp;=&nbsp;0,<BR>&nbsp;@string&nbsp;&nbsp;=&nbsp;""</P>
<P>&nbsp;while&nbsp;&nbsp;(@continue&nbsp;=&nbsp;1)<BR>&nbsp;begin</P>
<P>&nbsp;&nbsp;fetch&nbsp;&nbsp;next&nbsp;from&nbsp;curTable<BR>&nbsp;&nbsp;into&nbsp;&nbsp;@TableName</P>
<P>&nbsp;&nbsp;if&nbsp;(@@FETCH_STATUS&nbsp;&lt;&gt;&nbsp;0)<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;--fetch&nbsp;failed;&nbsp;end&nbsp;loop<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@continue&nbsp;=&nbsp;0<BR>&nbsp;&nbsp;&nbsp;break<BR>&nbsp;&nbsp;end&nbsp;--if&nbsp;fetchstatus&nbsp;&lt;&gt;&nbsp;0</P>
<P>&nbsp;&nbsp;else&nbsp;--&nbsp;continue&nbsp;next&nbsp;table<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;--successful&nbsp;fetch<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@TableCounter&nbsp;=&nbsp;@TableCounter&nbsp;+&nbsp;1</P>
<P>&nbsp;&nbsp;&nbsp;--&nbsp;DBCC&nbsp;DBREINDEX&nbsp;(authors,&nbsp;'',&nbsp;70)</P>
<P>&nbsp;&nbsp;&nbsp;select&nbsp;@SQL&nbsp;=&nbsp;"DBCC&nbsp;DBREINDEX&nbsp;("&nbsp;+&nbsp;@TableName&nbsp;+&nbsp;",&nbsp;'',&nbsp;70)&nbsp;"</P>
<P>&nbsp;&nbsp;&nbsp;/**********&nbsp;For&nbsp;Debug&nbsp;<BR>&nbsp;&nbsp;&nbsp;select&nbsp;"@SQL"&nbsp;=&nbsp;@SQL<BR>&nbsp;&nbsp;&nbsp;***************************/</P>
<P>&nbsp;&nbsp;&nbsp;exec&nbsp;(@SQL)</P>
<P><BR>&nbsp;&nbsp;end&nbsp;--&nbsp;else&nbsp;successful&nbsp;fetch</P>
<P>&nbsp;end&nbsp;--while&nbsp;(@continue&nbsp;=&nbsp;1)</P>
<P><BR>&nbsp;--&nbsp;final&nbsp;cleanup<BR>&nbsp;close&nbsp;curTable<BR>&nbsp;deallocate&nbsp;curTable</P>
<P>&nbsp;select&nbsp;"Total&nbsp;Number&nbsp;of&nbsp;Tables:"&nbsp;=&nbsp;@TableCounter</P>
<P><BR>END</P>
<P>go</P>
<P>CREATE&nbsp;PROCEDURE&nbsp;sp_CheckIdent</P>
<P><BR>AS<BR>BEGIN&nbsp;</P>
<P><BR>/******************************************************************&nbsp;<BR>Changes,&nbsp;starting&nbsp;from&nbsp;the&nbsp;latest:</P>
<P>CheckIdent&nbsp;SP&nbsp;runs&nbsp;DBCC&nbsp;checkident&nbsp;command&nbsp;for&nbsp;all&nbsp;user&nbsp;tables;<BR>Checking&nbsp;Identity&nbsp;for&nbsp;all&nbsp;User&nbsp;tables<BR>You&nbsp;can&nbsp;schedule&nbsp;these&nbsp;SPs&nbsp;for&nbsp;periodic&nbsp;execution.&nbsp;<BR>They&nbsp;might&nbsp;be&nbsp;useful&nbsp;for&nbsp;defragmenting&nbsp;and&nbsp;speeding&nbsp;up&nbsp;large&nbsp;DBs.&nbsp;<BR>Also&nbsp;they&nbsp;might&nbsp;be&nbsp;used&nbsp;after&nbsp;substantial&nbsp;data&nbsp;population/data&nbsp;scrubbing.&nbsp;</P>
<P>Execution&nbsp;should&nbsp;be&nbsp;done&nbsp;in&nbsp;absence&nbsp;of&nbsp;user&nbsp;activity&nbsp;on&nbsp;the&nbsp;DB&nbsp;(might&nbsp;slow&nbsp;down&nbsp;users).&nbsp;</P>
<P>--&nbsp;exec&nbsp;sp_CheckIdent&nbsp;--&nbsp;checks&nbsp;identity&nbsp;colulmns&nbsp;for&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminReindexTables&nbsp;--&nbsp;reindexes&nbsp;all&nbsp;user&nbsp;tables<BR>--&nbsp;go<BR>--&nbsp;exec&nbsp;sp_AdminRecompileStoredProc&nbsp;--&nbsp;recompiles&nbsp;all&nbsp;SPs<BR>--&nbsp;go&nbsp;</P>
<P><BR>These&nbsp;SPs&nbsp;were&nbsp;tested&nbsp;against&nbsp;SQL&nbsp;Server&nbsp;7.0&nbsp;and&nbsp;work&nbsp;on&nbsp;production&nbsp;DBs&nbsp;on&nbsp;<BR>a&nbsp;large&nbsp;Real&nbsp;Estate&nbsp;SQL/VB&nbsp;package.&nbsp;They&nbsp;should&nbsp;work&nbsp;also&nbsp;on&nbsp;6.5&nbsp;and&nbsp;2000&nbsp;SQL&nbsp;Server.</P>
<P><BR>Alexei&nbsp;Akimov&nbsp;alakimov@hotmail.com<BR>Colliers&nbsp;International,&nbsp;SQL&nbsp;DB&nbsp;Design,&nbsp;VB,&nbsp;ASP,&nbsp;Crystal&nbsp;Development<BR>tel:&nbsp;416-777-9377,&nbsp;ext.332</P>
<P>P.S.&nbsp;I&nbsp;am&nbsp;looking&nbsp;for&nbsp;job&nbsp;in&nbsp;SQL&nbsp;Server/Oracle/VB&nbsp;DB&nbsp;Design&nbsp;development<BR>in&nbsp;USA&nbsp;by&nbsp;TN1(Canadian&nbsp;citizen)&nbsp;or&nbsp;H1B&nbsp;Visa.&nbsp;</P>
<P><BR>********************************************************************<BR>--Below&nbsp;goes&nbsp;List&nbsp;of&nbsp;commonly&nbsp;used&nbsp;DBCC&nbsp;and&nbsp;information&nbsp;commands&nbsp;<BR>--&nbsp;exactly&nbsp;how&nbsp;they&nbsp;are&nbsp;spelled:</P>
<P>--dbcc&nbsp;checktable&nbsp;(tablename)<BR>--dbcc&nbsp;checkident&nbsp;(tablename)<BR>--dbcc&nbsp;memusage<BR>--dbcc&nbsp;show_statistics&nbsp;(tablename,&nbsp;indexname)<BR>--Update&nbsp;Statistics&nbsp;tablename&nbsp;--&nbsp;not&nbsp;dbcc&nbsp;command,&nbsp;no&nbsp;brackets,&nbsp;no&nbsp;quotes,exactly&nbsp;like&nbsp;shown</P>
<P>******************************************************************/</P>
<P><BR>&nbsp;Print&nbsp;"sp_CheckIdent"<BR>&nbsp;Print&nbsp;"Checking&nbsp;&nbsp;Identity&nbsp;for&nbsp;all&nbsp;User&nbsp;Tables"<BR>&nbsp;print&nbsp;"This&nbsp;may&nbsp;take&nbsp;up&nbsp;to&nbsp;3-5&nbsp;minutes"<BR>&nbsp;Print&nbsp;"*******************************************************"</P>
<P><BR>&nbsp;declare&nbsp;<BR>&nbsp;@continue&nbsp;integer,<BR>&nbsp;@TableCounter&nbsp;integer,<BR>&nbsp;@string&nbsp;&nbsp;varchar(80),<BR>&nbsp;@TableName&nbsp;varchar(50)</P>
<P></P>
<P>&nbsp;set&nbsp;nocount&nbsp;on&nbsp;</P>
<P><BR>&nbsp;declare&nbsp;curTable&nbsp;cursor</P>
<P>&nbsp;for&nbsp;&nbsp;SELECT&nbsp;&nbsp;&nbsp;name<BR>&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;sysobjects<BR>&nbsp;&nbsp;WHERE&nbsp;&nbsp;&nbsp;type&nbsp;=&nbsp;'U'<BR>&nbsp;for&nbsp;read&nbsp;only</P>
<P>&nbsp;--&nbsp;open&nbsp;cursor<BR>&nbsp;open&nbsp;curTable</P>
<P>&nbsp;select&nbsp;&nbsp;<BR>&nbsp;@continue&nbsp;=&nbsp;1,<BR>&nbsp;@TableCounter&nbsp;=&nbsp;0,<BR>&nbsp;@string&nbsp;&nbsp;=&nbsp;""</P>
<P>Loop:<BR>&nbsp;while&nbsp;&nbsp;(@continue&nbsp;=&nbsp;1)<BR>&nbsp;begin</P>
<P>&nbsp;&nbsp;fetch&nbsp;&nbsp;next&nbsp;from&nbsp;curTable<BR>&nbsp;&nbsp;into&nbsp;&nbsp;@TableName</P>
<P>&nbsp;&nbsp;if&nbsp;(@@FETCH_STATUS&nbsp;&lt;&gt;&nbsp;0)<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;--fetch&nbsp;failed;&nbsp;end&nbsp;loop<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@continue&nbsp;=&nbsp;0<BR>&nbsp;&nbsp;&nbsp;break<BR>&nbsp;&nbsp;end&nbsp;--if&nbsp;fetchstatus&nbsp;&lt;&gt;&nbsp;0</P>
<P>&nbsp;&nbsp;else&nbsp;--&nbsp;continue&nbsp;next&nbsp;table<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;--successful&nbsp;fetch<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@TableCounter&nbsp;=&nbsp;@TableCounter&nbsp;+&nbsp;1</P>
<P>&nbsp;&nbsp;&nbsp;select&nbsp;@string&nbsp;=&nbsp;"Checking&nbsp;identity&nbsp;of&nbsp;"&nbsp;+&nbsp;RTRIM(@TableName)<BR>&nbsp;&nbsp;&nbsp;print&nbsp;@string</P>
<P>&nbsp;&nbsp;&nbsp;exec&nbsp;("dbcc&nbsp;checkident&nbsp;("&nbsp;+&nbsp;@TableName&nbsp;+&nbsp;")")<BR>&nbsp;</P>
<P>&nbsp;&nbsp;end&nbsp;--&nbsp;else&nbsp;successful&nbsp;fetch</P>
<P>&nbsp;end&nbsp;--while&nbsp;(@continue&nbsp;=&nbsp;1)</P>
<P>EndLoop:</P>
<P>&nbsp;--&nbsp;final&nbsp;cleanup<BR>&nbsp;close&nbsp;curTable<BR>&nbsp;deallocate&nbsp;curTable</P>
<P>&nbsp;print&nbsp;""<BR>&nbsp;print&nbsp;"******************************************************"<BR>&nbsp;print&nbsp;"Check&nbsp;Identity&nbsp;had&nbsp;been&nbsp;done&nbsp;for&nbsp;all&nbsp;User-defined&nbsp;tables."<BR>&nbsp;select&nbsp;"Total&nbsp;Number&nbsp;of&nbsp;Tables:"&nbsp;=&nbsp;@TableCounter</P>
<P><BR>END</P>
<P>go</P>