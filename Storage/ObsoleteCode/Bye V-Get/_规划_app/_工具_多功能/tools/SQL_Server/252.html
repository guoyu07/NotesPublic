<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>交叉制表的存储过程变量部分的定义(2)</B><BR>create&nbsp;proc&nbsp;prcrosstab<BR>&nbsp;&nbsp;@chrrowhead&nbsp;char(30),--表示列,在交叉制表的结果中作为第一列出现<BR>&nbsp;&nbsp;@chrcolhead&nbsp;char(30),--表示列,在交叉制表的结果中该列中的数据被转换为新列名称<BR>&nbsp;&nbsp;@chrvalue&nbsp;char(30),--表示列,在该列中执行聚合函数<BR>&nbsp;&nbsp;@chrsource&nbsp;char(30),--源表或视图<BR>&nbsp;&nbsp;@inytype&nbsp;tinyint=1,--1-求和2-平均值&nbsp;3-最小值&nbsp;4-最大值5-计数<BR>&nbsp;&nbsp;@inygrouping&nbsp;tinyint=0--1工作日&nbsp;1-年内的周数&nbsp;3-月份&nbsp;4-季度&nbsp;5-年份<BR>as<BR>&nbsp;&nbsp;declare&nbsp;<BR>&nbsp;&nbsp;&nbsp;@chvrow&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;@chvcol&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;@chvtype&nbsp;varchar(10),<BR>&nbsp;&nbsp;&nbsp;@chvrowtype&nbsp;varchar(10),<BR>&nbsp;&nbsp;&nbsp;@chvcoltype&nbsp;varchar(10),<BR>&nbsp;&nbsp;&nbsp;@chvtemp&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;@chvcoltemp&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;@chvrowtemp&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;@inttype&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;@introwtype&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;@intcoltype&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;@chvexec&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;@chvgroup&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;@flttemp&nbsp;float,<BR>&nbsp;&nbsp;&nbsp;@dtmtemp&nbsp;datetime,<BR>&nbsp;&nbsp;&nbsp;@insR&nbsp;smallint,<BR>&nbsp;&nbsp;&nbsp;@intcolumn&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;@intreturn&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;@inttemp&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;@intcolnamelen&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;@intmaxrowhead&nbsp;int<BR>&nbsp;&nbsp;<BR>set&nbsp;nocount&nbsp;on&nbsp;</FONT>