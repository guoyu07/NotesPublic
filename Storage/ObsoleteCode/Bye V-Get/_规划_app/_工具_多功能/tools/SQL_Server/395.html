<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>将表信息导出Excel(pjessica收藏)</B><BR>列出SQL&nbsp;SERVER&nbsp;所有表、字段定义，类型，长度，一个值等信息
<P></P>
<P>并导出到Excel&nbsp;中</P>
<P>--&nbsp;======================================================</P>
<P>--&nbsp;Export&nbsp;all&nbsp;user&nbsp;tables&nbsp;definition&nbsp;and&nbsp;one&nbsp;sample&nbsp;value</P>
<P>--&nbsp;jan-13-2003,Dr.Zhang</P>
<P>--&nbsp;======================================================</P>
<P>在查询分析器里运行：</P>
<P>SET&nbsp;ANSI_NULLS&nbsp;OFF&nbsp;</P>
<P>GO</P>
<P>SET&nbsp;NOCOUNT&nbsp;ON</P>
<P>GO</P>
<P></P>
<P>SET&nbsp;LANGUAGE&nbsp;'Simplified&nbsp;Chinese'</P>
<P>go</P>
<P>DECLARE&nbsp;@tbl&nbsp;nvarchar(200),@fld&nbsp;nvarchar(200),@sql&nbsp;nvarchar(4000),@maxlen&nbsp;int,@sample&nbsp;nvarchar(40)</P>
<P></P>
<P>SELECT&nbsp;d.name&nbsp;TableName,a.name&nbsp;FieldName,b.name&nbsp;TypeName,a.length&nbsp;Length,a.isnullable&nbsp;IS_NULL&nbsp;INTO&nbsp;#t</P>
<P>FROM&nbsp;&nbsp;syscolumns&nbsp;&nbsp;a,&nbsp;&nbsp;systypes&nbsp;b,sysobjects&nbsp;d&nbsp;&nbsp;</P>
<P>WHERE&nbsp;&nbsp;a.xtype=b.xusertype&nbsp;&nbsp;and&nbsp;&nbsp;a.id=d.id&nbsp;&nbsp;and&nbsp;&nbsp;d.xtype='U'&nbsp;</P>
<P></P>
<P>DECLARE&nbsp;read_cursor&nbsp;CURSOR</P>
<P>FOR&nbsp;SELECT&nbsp;TableName,FieldName&nbsp;FROM&nbsp;#t</P>
<P></P>
<P>SELECT&nbsp;TOP&nbsp;1&nbsp;'_TableName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;TableName,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'FieldName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;FieldName,'TypeName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;TypeName,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Length'&nbsp;Length,'IS_NULL'&nbsp;IS_NULL,&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'MaxLenUsed'&nbsp;AS&nbsp;MaxLenUsed,'Sample&nbsp;value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;Sample,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Comment&nbsp;&nbsp;&nbsp;'&nbsp;Comment&nbsp;INTO&nbsp;#tc&nbsp;FROM&nbsp;#t</P>
<P></P>
<P>OPEN&nbsp;read_cursor</P>
<P></P>
<P>FETCH&nbsp;NEXT&nbsp;FROM&nbsp;read_cursor&nbsp;INTO&nbsp;@tbl,@fld</P>
<P>WHILE&nbsp;(@@fetch_status&nbsp;&lt;&gt;&nbsp;-1)&nbsp;&nbsp;---&nbsp;failes</P>
<P>BEGIN</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(@@fetch_status&nbsp;&lt;&gt;&nbsp;-2)&nbsp;--&nbsp;Missing</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@sql=N'SET&nbsp;@maxlen=(SELECT&nbsp;max(len(cast('+@fld+'&nbsp;as&nbsp;nvarchar)))&nbsp;FROM&nbsp;'+@tbl+')'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--PRINT&nbsp;@sql</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_EXECUTESQL&nbsp;@sql,N'@maxlen&nbsp;int&nbsp;OUTPUT',@maxlen&nbsp;OUTPUT</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--print&nbsp;@maxlen</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@sql=N'SET&nbsp;@sample=(SELECT&nbsp;TOP&nbsp;1&nbsp;cast('+@fld+'&nbsp;as&nbsp;nvarchar)&nbsp;FROM&nbsp;'+@tbl+'&nbsp;WHERE&nbsp;len(cast('+@fld+'&nbsp;as&nbsp;nvarchar))='+convert(nvarchar(5),@maxlen)+')'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_EXECUTESQL&nbsp;@sql,N'@sample&nbsp;varchar(30)&nbsp;OUTPUT',@sample&nbsp;OUTPUT</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--for&nbsp;quickly&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--SET&nbsp;@sql=N'SET&nbsp;@sample=convert(varchar(20),(SELECT&nbsp;TOP&nbsp;1&nbsp;'+@fld+'&nbsp;FROM&nbsp;'+</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--@tbl+'&nbsp;order&nbsp;by&nbsp;1&nbsp;desc&nbsp;))'&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRINT&nbsp;@sql</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;@sample</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;@tbl</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_EXECUTESQL&nbsp;@sql,N'@sample&nbsp;nvarchar(30)&nbsp;OUTPUT',@sample&nbsp;OUTPUT</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;INTO&nbsp;#tc&nbsp;SELECT&nbsp;*,ltrim(ISNULL(@maxlen,0))&nbsp;as&nbsp;MaxLenUsed,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convert(nchar(20),ltrim(ISNULL(@sample,'&nbsp;')))&nbsp;as&nbsp;Sample,'&nbsp;'&nbsp;Comment&nbsp;FROM&nbsp;#t&nbsp;where&nbsp;TableName=@tbl&nbsp;and&nbsp;FieldName=@fld</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FETCH&nbsp;NEXT&nbsp;FROM&nbsp;read_cursor&nbsp;INTO&nbsp;@tbl,@fld</P>
<P>END</P>
<P></P>
<P>CLOSE&nbsp;read_cursor</P>
<P>DEALLOCATE&nbsp;read_cursor</P>
<P>GO</P>
<P></P>
<P>SET&nbsp;ANSI_NULLS&nbsp;ON</P>
<P>GO</P>
<P>SET&nbsp;NOCOUNT&nbsp;OFF</P>
<P>GO</P>
<P>select&nbsp;count(*)&nbsp;&nbsp;from&nbsp;#t</P>
<P>DROP&nbsp;TABLE&nbsp;#t</P>
<P>GO</P>
<P></P>
<P>select&nbsp;count(*)-1&nbsp;&nbsp;from&nbsp;#tc</P>
<P></P>
<P>select&nbsp;*&nbsp;into&nbsp;##tx&nbsp;from&nbsp;#tc&nbsp;order&nbsp;by&nbsp;tablename</P>
<P>DROP&nbsp;TABLE&nbsp;#tc</P>
<P></P>
<P>--select&nbsp;*&nbsp;from&nbsp;##tx</P>
<P></P>
<P>declare&nbsp;@db&nbsp;nvarchar(60),@sql&nbsp;nvarchar(3000)</P>
<P>set&nbsp;@db=db_name()</P>
<P>--请修改用户名和口令&nbsp;导出到Excel&nbsp;中</P>
<P>set&nbsp;@sql='exec&nbsp;master.dbo.xp_cmdshell&nbsp;''bcp&nbsp;..dbo.##tx&nbsp;out&nbsp;c:\'+@db+'_exp.xls&nbsp;-w&nbsp;-C936&nbsp;-Usa&nbsp;-Psa&nbsp;'''</P>
<P>print&nbsp;@sql</P>
<P>exec(@sql)</P>
<P>GO</P>
<P>DROP&nbsp;TABLE&nbsp;##tx</P>
<P>GO</P>
<P></P>
<P></P>
<P></P>
<P>--&nbsp;======================================================</P>
<P>--根据表中数据生成insert语句的存储过程</P>
<P>--建立存储过程，执行&nbsp;spGenInsertSQL&nbsp;表名</P>
<P>--感谢playyuer</P>
<P>--&nbsp;======================================================</P>
<P>CREATE&nbsp;&nbsp;&nbsp;proc&nbsp;spGenInsertSQL&nbsp;(@tablename&nbsp;varchar(256))</P>
<P></P>
<P>as</P>
<P>begin</P>
<P>&nbsp;declare&nbsp;@sql&nbsp;varchar(8000)</P>
<P>&nbsp;declare&nbsp;@sqlvalues&nbsp;varchar(8000)</P>
<P>&nbsp;set&nbsp;@sql&nbsp;='&nbsp;('</P>
<P>&nbsp;set&nbsp;@sqlvalues&nbsp;=&nbsp;'values&nbsp;(''+'</P>
<P>&nbsp;select&nbsp;@sqlvalues&nbsp;=&nbsp;@sqlvalues&nbsp;+&nbsp;cols&nbsp;+&nbsp;'&nbsp;+&nbsp;'',''&nbsp;+&nbsp;'&nbsp;,@sql&nbsp;=&nbsp;@sql&nbsp;+&nbsp;'['&nbsp;+&nbsp;name&nbsp;+&nbsp;'],'&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;from&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select&nbsp;case&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;xtype&nbsp;in&nbsp;(48,52,56,59,60,62,104,106,108,122,127)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+&nbsp;name&nbsp;+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'&nbsp;+&nbsp;'cast('+&nbsp;name&nbsp;+&nbsp;'&nbsp;as&nbsp;varchar)'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;xtype&nbsp;in&nbsp;(58,61)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+&nbsp;name&nbsp;+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''&nbsp;+&nbsp;'&nbsp;+&nbsp;'cast('+&nbsp;name&nbsp;+'&nbsp;as&nbsp;varchar)'+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;xtype&nbsp;in&nbsp;(167)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+&nbsp;name&nbsp;+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''&nbsp;+&nbsp;'&nbsp;+&nbsp;'replace('+&nbsp;name+','''''''','''''''''''')'&nbsp;+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;xtype&nbsp;in&nbsp;(231)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+&nbsp;name&nbsp;+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''N''''''&nbsp;+&nbsp;'&nbsp;+&nbsp;'replace('+&nbsp;name+','''''''','''''''''''')'&nbsp;+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;xtype&nbsp;in&nbsp;(175)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+&nbsp;name&nbsp;+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''&nbsp;+&nbsp;'&nbsp;+&nbsp;'cast(replace('+&nbsp;name+','''''''','''''''''''')&nbsp;as&nbsp;Char('&nbsp;+&nbsp;cast(length&nbsp;as&nbsp;varchar)&nbsp;&nbsp;+&nbsp;'))+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;xtype&nbsp;in&nbsp;(239)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+&nbsp;name&nbsp;+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''N''''''&nbsp;+&nbsp;'&nbsp;+&nbsp;'cast(replace('+&nbsp;name+','''''''','''''''''''')&nbsp;as&nbsp;Char('&nbsp;+&nbsp;cast(length&nbsp;as&nbsp;varchar)&nbsp;&nbsp;+&nbsp;'))+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;'''NULL'''</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;as&nbsp;Cols,name</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;syscolumns&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;id&nbsp;=&nbsp;object_id(@tablename)&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;T&nbsp;</P>
<P>&nbsp;set&nbsp;@sql&nbsp;='select&nbsp;''INSERT&nbsp;INTO&nbsp;['+&nbsp;@tablename&nbsp;+&nbsp;']'&nbsp;+&nbsp;left(@sql,len(@sql)-1)+')&nbsp;'&nbsp;+&nbsp;left(@sqlvalues,len(@sqlvalues)-4)&nbsp;+&nbsp;')''&nbsp;from&nbsp;'+@tablename</P>
<P>&nbsp;--print&nbsp;@sql</P>
<P>&nbsp;exec&nbsp;(@sql)</P>
<P>end</P>
<P></P>
<P>GO</P>
<P></P>
<P></P>
<P></P>
<P>--&nbsp;======================================================</P>
<P>--根据表中数据生成insert语句的存储过程</P>
<P>--建立存储过程，执行&nbsp;proc_insert&nbsp;表名</P>
<P>--感谢Sky_blue</P>
<P>--&nbsp;======================================================</P>
<P></P>
<P>CREATE&nbsp;proc&nbsp;proc_insert&nbsp;(@tablename&nbsp;varchar(256))</P>
<P>as</P>
<P>begin</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;nocount&nbsp;on</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;declare&nbsp;@sqlstr&nbsp;varchar(4000)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;declare&nbsp;@sqlstr1&nbsp;varchar(4000)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;declare&nbsp;@sqlstr2&nbsp;varchar(4000)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@sqlstr='select&nbsp;''insert&nbsp;'+@tablename</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@sqlstr1=''</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@sqlstr2='&nbsp;('</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@sqlstr1=&nbsp;'&nbsp;values&nbsp;(&nbsp;''+'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@sqlstr1=@sqlstr1+col+'+'',''+'&nbsp;,@sqlstr2=@sqlstr2+name&nbsp;+','&nbsp;from&nbsp;(select&nbsp;case&nbsp;</P>
<P>--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=173&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar('+convert(varchar(4),a.length*2+2)+'),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=104&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(1),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=175&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''+'+'replace('+a.name+','''''''','''''''''''')'&nbsp;+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=61&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''+'+'convert(varchar(23),'+a.name&nbsp;+',121)'+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=106&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar('+convert(varchar(4),a.xprec+2)+'),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=62&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(23),'+a.name&nbsp;+',2)'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=56&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(11),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=60&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(22),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=239&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''+'+'replace('+a.name+','''''''','''''''''''')'&nbsp;+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=108&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar('+convert(varchar(4),a.xprec+2)+'),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=231&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''+'+'replace('+a.name+','''''''','''''''''''')'&nbsp;+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=59&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(23),'+a.name&nbsp;+',2)'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=58&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''+'+'convert(varchar(23),'+a.name&nbsp;+',121)'+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=52&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(12),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=122&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(22),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=48&nbsp;&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar(6),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=165&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'convert(varchar('+convert(varchar(4),a.length*2+2)+'),'+a.name&nbsp;+')'+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;a.xtype&nbsp;=167&nbsp;then&nbsp;'case&nbsp;when&nbsp;'+a.name+'&nbsp;is&nbsp;null&nbsp;then&nbsp;''NULL''&nbsp;else&nbsp;'+'''''''''+'+'replace('+a.name+','''''''','''''''''''')'&nbsp;+&nbsp;'+'''''''''+'&nbsp;end'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;'''NULL'''</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;as&nbsp;col,a.colid,a.name</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;syscolumns&nbsp;a&nbsp;where&nbsp;a.id&nbsp;=&nbsp;object_id(@tablename)&nbsp;and&nbsp;a.xtype&nbsp;&lt;&gt;189&nbsp;and&nbsp;a.xtype&nbsp;&lt;&gt;34&nbsp;and&nbsp;a.xtype&nbsp;&lt;&gt;35&nbsp;and&nbsp;&nbsp;a.xtype&nbsp;&lt;&gt;36</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)t&nbsp;order&nbsp;by&nbsp;colid</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@sqlstr=@sqlstr+left(@sqlstr2,len(@sqlstr2)-1)+')&nbsp;'+left(@sqlstr1,len(@sqlstr1)-3)+')''&nbsp;from&nbsp;'+@tablename</P>
<P>--&nbsp;&nbsp;print&nbsp;@sqlstr</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec(&nbsp;@sqlstr)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;nocount&nbsp;off</P>
<P>end</P>
<P>GO&nbsp;<BR></P></FONT>