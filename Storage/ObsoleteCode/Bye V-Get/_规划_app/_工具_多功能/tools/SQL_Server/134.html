<meta http-equiv="content-type" content="text/html; charset=gb2312">&nbsp;<FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>选择随机的记录</B><BR>A&nbsp;number&nbsp;of&nbsp;other&nbsp;writers&nbsp;have&nbsp;suggested&nbsp;using&nbsp;a&nbsp;client-side&nbsp;cursor,&nbsp;loading&nbsp;the&nbsp;table&nbsp;and&nbsp;then&nbsp;using&nbsp;move&nbsp;by&nbsp;Rand()*recordcount&nbsp;to&nbsp;get&nbsp;a&nbsp;random&nbsp;record.&nbsp;This&nbsp;works&nbsp;well&nbsp;for&nbsp;small&nbsp;datasets&nbsp;or&nbsp;choosing&nbsp;just&nbsp;a&nbsp;few&nbsp;records,&nbsp;but&nbsp;when&nbsp;20&nbsp;or&nbsp;more&nbsp;records&nbsp;need&nbsp;to&nbsp;be&nbsp;selected&nbsp;from&nbsp;a&nbsp;large&nbsp;database,&nbsp;there&nbsp;can&nbsp;be&nbsp;a&nbsp;large&nbsp;performance&nbsp;hit.&nbsp;
<P></P>
<P>The&nbsp;Rand()&nbsp;function&nbsp;in&nbsp;SQL&nbsp;seems&nbsp;ideal&nbsp;for&nbsp;the&nbsp;task,&nbsp;but&nbsp;the&nbsp;problem&nbsp;is&nbsp;that&nbsp;if&nbsp;used&nbsp;thus:&nbsp;</P>
<P>SELECT&nbsp;TOP&nbsp;5&nbsp;Questions.*,&nbsp;Rand()&nbsp;as&nbsp;ID&nbsp;<BR>FROM&nbsp;Questions&nbsp;</P>
<P>the&nbsp;ID&nbsp;field&nbsp;always&nbsp;has&nbsp;the&nbsp;same&nbsp;number&nbsp;in&nbsp;it&nbsp;(ie:&nbsp;the&nbsp;Rand()&nbsp;was&nbsp;only&nbsp;evaluated&nbsp;once).&nbsp;</P>
<P>I&nbsp;have&nbsp;found&nbsp;an&nbsp;alternative&nbsp;method&nbsp;that&nbsp;seems&nbsp;to&nbsp;''trick''&nbsp;the&nbsp;backend&nbsp;into&nbsp;evaluating&nbsp;the&nbsp;expression&nbsp;each&nbsp;time.&nbsp;It&nbsp;involves&nbsp;changing&nbsp;the&nbsp;seed&nbsp;for&nbsp;each&nbsp;record&nbsp;and&nbsp;is&nbsp;easiest&nbsp;to&nbsp;use&nbsp;if&nbsp;there&nbsp;is&nbsp;an&nbsp;AutoInc&nbsp;field&nbsp;in&nbsp;the&nbsp;table:&nbsp;</P>
<P>SELECT&nbsp;TOP&nbsp;20&nbsp;Questions.*&nbsp;<BR>FROM&nbsp;Questions&nbsp;<BR>ORDER&nbsp;BY&nbsp;(Rand(Questions.QID))&nbsp;</P>
<P>where&nbsp;QID&nbsp;is&nbsp;an&nbsp;AutoInc&nbsp;field.&nbsp;This&nbsp;does&nbsp;produce&nbsp;a&nbsp;random&nbsp;list&nbsp;quite&nbsp;easily&nbsp;and&nbsp;on&nbsp;my&nbsp;testing&nbsp;the&nbsp;list&nbsp;does&nbsp;seem&nbsp;to&nbsp;be&nbsp;reasonably&nbsp;random.&nbsp;</P>
<P>Note:&nbsp;Using&nbsp;MS&nbsp;Access&nbsp;-&nbsp;Rnd()&nbsp;is&nbsp;the&nbsp;function,&nbsp;not&nbsp;Rand()</P></FONT>