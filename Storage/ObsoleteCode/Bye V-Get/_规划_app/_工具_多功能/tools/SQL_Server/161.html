<meta http-equiv="content-type" content="text/html; charset=gb2312">&nbsp;<FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>子查询</B><BR>1。select&nbsp;...&nbsp;where&nbsp;列或运算式&nbsp;比较运算运算【any|all](子查询）<BR>&nbsp;&nbsp;&nbsp;只要主查询中列或运算式与子查询所得结果中任一（any）或全部（all）数据符合比较条件的话则主查询的结果为我们要的数据
<P></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;选出不同的人金额最高的订单<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*&nbsp;&nbsp;from&nbsp;&nbsp;sales&nbsp;a<BR>&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;tomat=(select&nbsp;max(totmat)&nbsp;from&nbsp;sales&nbsp;&nbsp;where&nbsp;name=a.name)<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;sale_id,tot_amt<BR>&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sales&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;tot_amt&gt;any(select&nbsp;tot_amt&nbsp;from&nbsp;sales&nbsp;where&nbsp;sale_id='e0013'and&nbsp;'order_date='1996/11/10')<BR>&nbsp;&nbsp;&nbsp;<BR>2。select&nbsp;...where&nbsp;列或运算式[not]&nbsp;in&nbsp;(子查询)<BR>&nbsp;&nbsp;&nbsp;&nbsp;只要主查询中列或运算式是在（不在）子查询所得结果列表中的话，则主查询的结果为我们要的数据<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;sales_id,tot_amt<BR>&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sales&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;sale&nbsp;_id&nbsp;&nbsp;in(select&nbsp;sale_id&nbsp;from&nbsp;employee&nbsp;where&nbsp;sex='F')<BR>3.select&nbsp;...where&nbsp;[not]&nbsp;exists&nbsp;(&nbsp;&nbsp;子查询）<BR>&nbsp;&nbsp;子查询的结果至少存在一条数据时，则主查询的结果为我们要的数据。（exists）或自查询的结果找不到数据时，则主查询的结果为我们要的数据(not&nbsp;exists)<BR>&nbsp;我们经常查询的两个表有多少重复的记录就用这个<BR>&nbsp;以下范例让你找出滞销的产品，也就是尚未有任何销售记录的库存产品。此范例主要是查询以库文件中的每一条产品代码到销售明细表中去查询，如果查询不到任何一条，表示该产品未曾卖出任何一件。<BR>&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;stock&nbsp;a<BR>&nbsp;&nbsp;where&nbsp;not&nbsp;exists(select&nbsp;*&nbsp;from&nbsp;sale_item&nbsp;b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a.prod_id=b.prod_id&nbsp;and&nbsp;a.stup_id=b.stup_id)</P>
<P>&nbsp;select&nbsp;emp_no,emp_name&nbsp;from&nbsp;employee<BR>&nbsp;from&nbsp;employee&nbsp;a<BR>&nbsp;where&nbsp;(select&nbsp;sum(tot_amt)&nbsp;from&nbsp;sales&nbsp;b&nbsp;where&nbsp;a.sale_id=b.emp_no)&lt;200000</P></FONT>