<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>GetObjNameList</B><BR>Version:&nbsp;SQL&nbsp;Server&nbsp;7.0/2000<BR>Created&nbsp;by:&nbsp;Alexander&nbsp;Chigrik
<P></P>
<P>This&nbsp;stored&nbsp;procedure&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;return&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;tables,<BR>constraints,&nbsp;stored&nbsp;procedures,&nbsp;views,&nbsp;rules&nbsp;and&nbsp;triggers,&nbsp;which<BR>contain&nbsp;the&nbsp;particular&nbsp;value.&nbsp;You&nbsp;should&nbsp;pass&nbsp;the&nbsp;database&nbsp;name<BR>and&nbsp;the&nbsp;value&nbsp;to&nbsp;search,&nbsp;as&nbsp;in&nbsp;the&nbsp;example&nbsp;below<BR>(if&nbsp;the&nbsp;database&nbsp;name&nbsp;was&nbsp;not&nbsp;specified,&nbsp;the&nbsp;current&nbsp;database&nbsp;will<BR>be&nbsp;used):</P>
<P>EXEC&nbsp;GetObjNameList&nbsp;@dbname&nbsp;=&nbsp;'pubs',&nbsp;@text&nbsp;=&nbsp;'author'</P>
<P>/*<BR>Version:&nbsp;SQL&nbsp;Server&nbsp;7.0/2000<BR>Created&nbsp;by:&nbsp;Alexander&nbsp;Chigrik</P>
<P>This&nbsp;stored&nbsp;procedure&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;return&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;tables,<BR>constraints,&nbsp;stored&nbsp;procedures,&nbsp;views,&nbsp;rules&nbsp;and&nbsp;triggers,&nbsp;which&nbsp;(names)<BR>contain&nbsp;the&nbsp;particular&nbsp;value.&nbsp;You&nbsp;should&nbsp;pass&nbsp;the&nbsp;database&nbsp;name&nbsp;and&nbsp;the<BR>value&nbsp;to&nbsp;search,&nbsp;as&nbsp;in&nbsp;the&nbsp;example&nbsp;below<BR>(if&nbsp;the&nbsp;database&nbsp;name&nbsp;was&nbsp;not&nbsp;specified,&nbsp;the&nbsp;current&nbsp;database&nbsp;will&nbsp;be&nbsp;used):</P>
<P>EXEC&nbsp;GetObjNameList&nbsp;@dbname&nbsp;=&nbsp;'pubs',&nbsp;@text&nbsp;=&nbsp;'author'<BR>*/</P>
<P>IF&nbsp;OBJECT_ID('GetObjNameList')&nbsp;IS&nbsp;NOT&nbsp;NULL&nbsp;DROP&nbsp;PROC&nbsp;GetObjNameList<BR>GO</P>
<P>CREATE&nbsp;PROC&nbsp;GetObjNameList&nbsp;(<BR>&nbsp;&nbsp;@dbname&nbsp;sysname&nbsp;=&nbsp;null,<BR>&nbsp;&nbsp;@text&nbsp;sysname<BR>)<BR>AS<BR>&nbsp;&nbsp;SET&nbsp;NOCOUNT&nbsp;ON<BR>&nbsp;&nbsp;IF&nbsp;@dbname&nbsp;IS&nbsp;NULL&nbsp;SELECT&nbsp;@dbname&nbsp;=&nbsp;DB_NAME()<BR>&nbsp;&nbsp;EXEC('USE&nbsp;'&nbsp;+&nbsp;@dbname&nbsp;+&nbsp;'&nbsp;&nbsp;SELECT&nbsp;name&nbsp;as&nbsp;object_name,&nbsp;object_type&nbsp;=&nbsp;CASE&nbsp;type&nbsp;WHEN&nbsp;''C''&nbsp;THEN&nbsp;''CHECK&nbsp;constraint''&nbsp;WHEN&nbsp;''D''&nbsp;THEN&nbsp;''Default&nbsp;or&nbsp;DEFAULT&nbsp;constraint''&nbsp;WHEN&nbsp;''F''&nbsp;THEN&nbsp;''FOREIGN&nbsp;KEY&nbsp;constraint''&nbsp;WHEN&nbsp;''K''&nbsp;THEN&nbsp;''PRIMARY&nbsp;KEY&nbsp;or&nbsp;UNIQUE&nbsp;constraint''&nbsp;WHEN&nbsp;''L''&nbsp;THEN&nbsp;''Log''&nbsp;WHEN&nbsp;''P''&nbsp;THEN&nbsp;''Stored&nbsp;procedure''&nbsp;WHEN&nbsp;''R''&nbsp;THEN&nbsp;''Rule''&nbsp;WHEN&nbsp;''RF''&nbsp;THEN&nbsp;''Replication&nbsp;filter&nbsp;stored&nbsp;procedure''&nbsp;WHEN&nbsp;''S''&nbsp;THEN&nbsp;''System&nbsp;table''&nbsp;WHEN&nbsp;''TR''&nbsp;THEN&nbsp;''Trigger''&nbsp;WHEN&nbsp;''U''&nbsp;THEN&nbsp;''User&nbsp;table''&nbsp;WHEN&nbsp;''V''&nbsp;THEN&nbsp;''View''&nbsp;ELSE&nbsp;''Extended&nbsp;stored&nbsp;procedure''&nbsp;END&nbsp;FROM&nbsp;sysobjects&nbsp;WHERE&nbsp;name&nbsp;like&nbsp;''%'&nbsp;+&nbsp;@text&nbsp;+&nbsp;'%''')<BR>GO<BR></P></FONT>