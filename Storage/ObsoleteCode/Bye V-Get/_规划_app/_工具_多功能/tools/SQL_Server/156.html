<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>union&nbsp;(all)</B><BR>利用union&nbsp;将多个select&nbsp;的结果结合起来.union命令将来自不同select命令所生成的数据混合在一起，并将重复的数据删除仅留下一条，也就是数学上的并集关系。<BR>如果你想让重复的数据也留下时，可以使用union&nbsp;all取代原来的union命令
<P></P>
<P>1.select&nbsp;prod_id&nbsp;,sup_id&nbsp;<BR>&nbsp;&nbsp;from&nbsp;sale_item<BR>&nbsp;&nbsp;where&nbsp;order_no=10001<BR>&nbsp;&nbsp;union<BR>&nbsp;&nbsp;select&nbsp;prod_id,sup_id<BR>&nbsp;&nbsp;from&nbsp;purchase&nbsp;<BR>&nbsp;&nbsp;where&nbsp;pur_no=50001<BR>&nbsp;&nbsp;&nbsp;order&nbsp;by&nbsp;1,2<BR>2.在sqlserver方面可以用case实现的，但在access里，只能用iif或union<BR>&nbsp;&nbsp;select&nbsp;a.rmpwr,a.buypwr,yd-case&nbsp;when&nbsp;b.dl&gt;0&nbsp;then&nbsp;a.yd+b.rmpwr-b.bdl&nbsp;<BR>&nbsp;&nbsp;else&nbsp;a.yd-b.yd&nbsp;end<BR>&nbsp;from&nbsp;(select&nbsp;mid,rmpwr,buypwr,(buypwr-rmpwr)as&nbsp;yd&nbsp;from&nbsp;main&nbsp;where&nbsp;month(dt)=2)a,(select&nbsp;mid,rmpwr,buypwr,(buypwr-rmpwr)as&nbsp;yd,bdl&nbsp;from&nbsp;main&nbsp;where&nbsp;month(dt)=1&nbsp;b&nbsp;where&nbsp;a.mid=b.mid<BR>&nbsp;在本机数据库中a,b同上<BR>&nbsp;select&nbsp;a.ydl+b.rmpwr-b.ydl&nbsp;as&nbsp;yd&nbsp;&nbsp;from&nbsp;a,b&nbsp;where&nbsp;a.mid=b.mid&nbsp;and&nbsp;b.bdl&gt;0<BR>&nbsp;union&nbsp;all<BR>select&nbsp;a.yd-b.yd&nbsp;from&nbsp;a,b&nbsp;where&nbsp;a.mid=b.mid&nbsp;and&nbsp;isnull(b.bdl,-1)&lt;=0&nbsp;<BR></P></FONT>