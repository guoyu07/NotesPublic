<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>经典排序案例</B><BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://www.delphibbs.com/delphibbs/dispq.asp?lid=1016377" 
target=_blank>http://www.delphibbs.com/delphibbs/dispq.asp?lid=1016377</A><BR>1。我有一张数据表，结构如下：&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;create&nbsp;Table&nbsp;List&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;CHAR(20),&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;CHAR(20),&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;age&nbsp;&nbsp;&nbsp;CHAR(20)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我想要返回的结果集格式为：<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;按地区排序，但是地区按枚举输出，<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;每个地区显示一条记录，按地区循环显示，下面只列出了3个地方作例子。<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;（各地区人数不定也不等，如果该地方没有人可以填充了，就跳过去不显示）&nbsp;<BR>如：&nbsp;<BR>name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;age&nbsp;<BR>张三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;河北&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;<BR>李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;河南&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;<BR>王五&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;山东&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;
<P></P>
<P>马六&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;河北&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;<BR>刘七&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;河南&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;<BR>赵八&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;山东&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25&nbsp;<BR>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;<BR>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;<BR>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;<BR>Select&nbsp;Name,Local,Age,<BR>&nbsp;&nbsp;XH=(Select&nbsp;Count(*)&nbsp;from&nbsp;List&nbsp;A&nbsp;where&nbsp;A.Local=B.Local&nbsp;and&nbsp;A.Name&lt;B.Name)<BR>&nbsp;from&nbsp;List&nbsp;B&nbsp;order&nbsp;by&nbsp;XH,Local</P>
<P>2。人T名Q&nbsp;&nbsp;外出rg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;外出趟次<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;10:01:01&nbsp;&nbsp;&nbsp;<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;13:01:01&nbsp;&nbsp;<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;12:01:01&nbsp;&nbsp;<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-02&nbsp;09:01:01&nbsp;&nbsp;&nbsp;<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-02&nbsp;15:01:01&nbsp;&nbsp;<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-02&nbsp;16:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;10:01:01&nbsp;&nbsp;&nbsp;<BR>李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;11:01:01&nbsp;&nbsp;</P>
<P>目艘求:<BR>人T名Q&nbsp;&nbsp;外出rg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;外出趟次&nbsp;&nbsp;//某人在某天的第状瓮獬<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;10:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;13:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;12:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-02&nbsp;09:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-02&nbsp;15:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-02&nbsp;16:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<BR>李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;10:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000-01-01&nbsp;11:01:01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</P>
<P>select&nbsp;a.name,a.dt,(select&nbsp;count(name)&nbsp;from&nbsp;tablename<BR>&nbsp;&nbsp;where&nbsp;name=a.name&nbsp;and&nbsp;year(dt)=year(a.dt)&nbsp;and&nbsp;month(a.dt)&nbsp;and&nbsp;day(dt)=day(a.dt)&nbsp;and&nbsp;dt&lt;=a.dt)&nbsp;as&nbsp;ncount<BR>from&nbsp;tablename&nbsp;a<BR>order&nbsp;by&nbsp;a.dt</P>
<P>3.ID&nbsp;名称<BR>1&nbsp;&nbsp;&nbsp;B<BR>2&nbsp;&nbsp;&nbsp;A<BR>3&nbsp;&nbsp;&nbsp;C<BR>4&nbsp;&nbsp;&nbsp;B<BR>5&nbsp;&nbsp;&nbsp;A<BR>6&nbsp;&nbsp;&nbsp;B<BR>其中ID是主键,现在希望通过SQL查询得到以下结果<BR>ID&nbsp;名称&nbsp;次数<BR>1&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>2&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>3&nbsp;&nbsp;&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>4&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>5&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>6&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<BR>其中"次数"是指以ID为顺序,名称是第几次出现。<BR>望高手相助，200分相赠！<BR>Select&nbsp;id,名称,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select&nbsp;count(id)&nbsp;from&nbsp;table1&nbsp;where&nbsp;名称=AAA.名称&nbsp;and&nbsp;id&lt;=AAA.id)&nbsp;as&nbsp;次数&nbsp;<BR>From&nbsp;table1&nbsp;AAA</P></FONT>