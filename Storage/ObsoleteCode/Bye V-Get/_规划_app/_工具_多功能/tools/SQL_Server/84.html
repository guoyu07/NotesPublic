<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>OPENROWSET</B><BR>OPENROWSET<BR>包含访问&nbsp;OLE&nbsp;DB&nbsp;数据源中的远程数据所需的全部连接信息。当访问链接服务器中的表时，这种方法是一种替代方法，并且是一种使用&nbsp;OLE&nbsp;DB&nbsp;连接并访问远程数据的一次性的、特殊的方法。可以在查询的&nbsp;FROM&nbsp;子句中像引用表名那样引用&nbsp;OPENROWSET&nbsp;函数。依据&nbsp;OLE&nbsp;DB&nbsp;提供程序的能力，还可以将&nbsp;OPENROWSET&nbsp;函数引用为&nbsp;INSERT、UPDATE&nbsp;或&nbsp;DELETE&nbsp;语句的目标表。尽管查询可能返回多个结果集，然而&nbsp;OPENROWSET&nbsp;只返回第一个。
<P></P>
<P>语法<BR>OPENROWSET&nbsp;(&nbsp;'provider_name'<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;'datasource'&nbsp;;&nbsp;'user_id'&nbsp;;&nbsp;'password'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;'provider_string'&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;{&nbsp;[&nbsp;catalog.]&nbsp;[&nbsp;schema.]&nbsp;object<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;'query'&nbsp;}&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;</P>
<P>参数<BR>'provider_name'</P>
<P>字符串，它代表在注册表中指定的&nbsp;OLE&nbsp;DB&nbsp;提供程序的友好名。provider_name&nbsp;没有默认值。</P>
<P>'datasource'</P>
<P>字符串常量，它对应着某个特定的&nbsp;OLE&nbsp;DB&nbsp;数据源。datasource&nbsp;是将被传递到提供程序&nbsp;IDBProperties&nbsp;接口以初始化提供程序的&nbsp;DBPROP_INIT_DATASOURCE&nbsp;属性。通常，这个字符串包含数据库文件的名称、数据库服务器的名称，或者提供程序能理解的用于查找数据库的名称。&nbsp;</P>
<P>'user_id'</P>
<P>字符串常量，它是传递到指定&nbsp;OLE&nbsp;DB&nbsp;提供程序的用户名。user_id&nbsp;为连接指定安全上下文，并将它作为&nbsp;DBPROP_AUTH_USERID&nbsp;属性传递进来以初始化提供程序。</P>
<P>'password'</P>
<P>字符串常量，它是将被传递到&nbsp;OLE&nbsp;DB&nbsp;提供程序的用户密码。当初始化提供程序时，将&nbsp;password&nbsp;作为&nbsp;DBPROP_AUTH_PASSWORD&nbsp;属性传递进来。</P>
<P>'provider_string'</P>
<P>提供程序特定的连接字符串，将它作为&nbsp;DBPROP_INIT_PROVIDERSTRING&nbsp;属性传递进来以初始化&nbsp;OLE&nbsp;DB&nbsp;提供程序。通常&nbsp;provider_string&nbsp;封装初始化提供程序所需的所有连接信息。</P>
<P>catalog</P>
<P>目录或数据库的名称，其中驻留着指定的对象。</P>
<P>schema</P>
<P>架构的名称或指定对象的对象所有者名称。</P>
<P>object</P>
<P>对象名称，它唯一地标识出将要操作的对象。</P>
<P>'query'</P>
<P>是字符串常量，发送到提供程序并由提供程序执行。Microsoft?&nbsp;SQL&nbsp;Server?&nbsp;不处理该查询，但处理由提供程序返回的查询结果（直接传递查询）。对于有些提供程序，它们并没有通过表名而是通过命令语言表现自己的表格格式数据，那么将直接传递查询用于这些提供程序是非常有用的。只要查询提供程序支持&nbsp;OLE&nbsp;DB&nbsp;Command&nbsp;对象及其强制接口，那么在远程服务器上就支持直接传递查询。有关更多信息，请参见&nbsp;SQL&nbsp;Server&nbsp;OLE&nbsp;DB&nbsp;程序员参考。&nbsp;</P>
<P>注释<BR>如果&nbsp;OLE&nbsp;DB&nbsp;提供程序在指定的数据源中支持多个目录和架构，那么就需要目录及架构名称。如果&nbsp;OLE&nbsp;DB&nbsp;提供程序并不支持目录和架构，那么可以省略&nbsp;catalog&nbsp;及&nbsp;schema&nbsp;的值。&nbsp;</P>
<P>如果提供程序只支持架构名，那么必须指定一个两部分名称，形式为&nbsp;schema.object。如果提供程序只支持目录名，那么必须指定一个三部分名称，形式为&nbsp;catalog.schema.object。</P>
<P>OPENROWSET&nbsp;不接受参数变量。</P>
<P>权限<BR>OPENROWSET&nbsp;权限由传递到&nbsp;OLE&nbsp;DB&nbsp;提供程序的用户名的权限确定。&nbsp;</P>
<P>示例<BR>A.&nbsp;将&nbsp;OPENROWSET&nbsp;与&nbsp;SELECT&nbsp;语句及用于&nbsp;SQL&nbsp;Server&nbsp;的&nbsp;Microsoft&nbsp;OLE&nbsp;DB&nbsp;提供程序一起使用<BR>下面的示例使用用于&nbsp;SQL&nbsp;Server&nbsp;的&nbsp;Microsoft&nbsp;OLE&nbsp;DB&nbsp;提供程序访问&nbsp;pubs&nbsp;数据库中的&nbsp;authors&nbsp;表，该数据库在一个名为&nbsp;seattle1&nbsp;的远程服务器上。从&nbsp;datasource、user_id&nbsp;及&nbsp;password&nbsp;中初始化提供程序，并且使用&nbsp;SELECT&nbsp;语句定义返回的行集。</P>
<P>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;a.*<BR>FROM&nbsp;OPENROWSET('SQLOLEDB','seattle1';'sa';'MyPass',<BR>&nbsp;&nbsp;&nbsp;'SELECT&nbsp;*&nbsp;FROM&nbsp;pubs.dbo.authors&nbsp;ORDER&nbsp;BY&nbsp;au_lname,&nbsp;au_fname')&nbsp;AS&nbsp;a<BR>GO</P>
<P>B.&nbsp;将&nbsp;OPENROWSET&nbsp;与对象及用于&nbsp;ODBC&nbsp;的&nbsp;OLE&nbsp;DB&nbsp;提供程序一起使用<BR>下面的示例使用用于&nbsp;ODBC&nbsp;的&nbsp;OLE&nbsp;DB&nbsp;提供程序以及&nbsp;SQL&nbsp;Server&nbsp;ODBC&nbsp;驱动程序访问&nbsp;pubs&nbsp;数据库中的&nbsp;authors&nbsp;表，该数据库在一个名为&nbsp;seattle1&nbsp;的远程服务器中。提供程序用在&nbsp;ODBC&nbsp;提供程序所用的&nbsp;ODBC&nbsp;语法中指定的&nbsp;provider_string&nbsp;进行初始化，定义返回的行集时使用&nbsp;catalog.schema.object&nbsp;语法。</P>
<P>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;a.*<BR>FROM&nbsp;OPENROWSET('MSDASQL',<BR>&nbsp;&nbsp;&nbsp;'DRIVER={SQL&nbsp;Server};SERVER=seattle1;UID=sa;PWD=MyPass',<BR>&nbsp;&nbsp;&nbsp;pubs.dbo.authors)&nbsp;AS&nbsp;a<BR>ORDER&nbsp;BY&nbsp;a.au_lname,&nbsp;a.au_fname<BR>GO</P>
<P>C.&nbsp;使用用于&nbsp;Jet&nbsp;的&nbsp;Microsoft&nbsp;OLE&nbsp;DB&nbsp;提供程序<BR>下面的示例通过用于&nbsp;Jet&nbsp;的&nbsp;Microsoft&nbsp;OLE&nbsp;DB&nbsp;提供程序访问&nbsp;Microsoft&nbsp;Access&nbsp;Northwind&nbsp;数据库中的&nbsp;orders&nbsp;表。</P>
<P></P>
<P>说明&nbsp;&nbsp;下面的示例假定已经安装了&nbsp;Access。</P>
<P><BR>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;a.*<BR>FROM&nbsp;OPENROWSET('Microsoft.Jet.OLEDB.4.0',&nbsp;<BR>&nbsp;&nbsp;&nbsp;'c:\MSOffice\Access\Samples\northwind.mdb';'admin';'mypwd',&nbsp;Orders)&nbsp;<BR>&nbsp;&nbsp;&nbsp;AS&nbsp;a<BR>GO</P>
<P>D.&nbsp;使用&nbsp;OPENROWSET&nbsp;和&nbsp;INNER&nbsp;JOIN&nbsp;中的另一个表<BR>下面的示例从本地&nbsp;SQL&nbsp;Server&nbsp;Northwind&nbsp;数据库的&nbsp;customers&nbsp;表中，以及存储在相同计算机上&nbsp;Access&nbsp;Northwind&nbsp;数据库的&nbsp;orders&nbsp;表中选择所有数据</P>
<P></P>
<P>说明&nbsp;&nbsp;下面的示例假定已经安装了&nbsp;Access。</P>
<P><BR>USE&nbsp;pubs<BR>GO<BR>SELECT&nbsp;c.*,&nbsp;o.*<BR>FROM&nbsp;Northwind.dbo.Customers&nbsp;AS&nbsp;c&nbsp;INNER&nbsp;JOIN&nbsp;<BR>&nbsp;&nbsp;&nbsp;OPENROWSET('Microsoft.Jet.OLEDB.4.0',&nbsp;<BR>&nbsp;&nbsp;&nbsp;'c:\MSOffice\Access\Samples\northwind.mdb';'admin';'mypwd',&nbsp;Orders)&nbsp;<BR>&nbsp;&nbsp;&nbsp;AS&nbsp;o<BR>&nbsp;&nbsp;&nbsp;ON&nbsp;c.CustomerID&nbsp;=&nbsp;o.CustomerID&nbsp;<BR>GO</P></FONT>