<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Renaming&nbsp;the&nbsp;Logical&nbsp;Filename</B><BR>Renaming&nbsp;the&nbsp;Logical&nbsp;Filename
<P></P>
<P></P>
<P><BR>This&nbsp;stored&nbsp;procedure&nbsp;was&nbsp;created&nbsp;to&nbsp;allow&nbsp;one&nbsp;to&nbsp;change&nbsp;logical&nbsp;file&nbsp;names&nbsp;of&nbsp;datbase&nbsp;files&nbsp;in&nbsp;a&nbsp;7.0&nbsp;database.&nbsp;After&nbsp;doing&nbsp;a&nbsp;restore&nbsp;with&nbsp;the&nbsp;move&nbsp;option,&nbsp;one&nbsp;can&nbsp;change&nbsp;the&nbsp;physical&nbsp;file&nbsp;path&nbsp;and&nbsp;physcal&nbsp;file&nbsp;name,&nbsp;but&nbsp;not&nbsp;the&nbsp;logical&nbsp;name.&nbsp;This&nbsp;posed&nbsp;a&nbsp;problem&nbsp;because&nbsp;some&nbsp;have&nbsp;internal&nbsp;standards&nbsp;for&nbsp;database&nbsp;names&nbsp;and&nbsp;for&nbsp;logical&nbsp;and&nbsp;physical&nbsp;file&nbsp;names.&nbsp;</P>
<P>Author:&nbsp;Joe&nbsp;Toscano&nbsp;</P>
<P>/************************************************************************************************************************<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sp_rename_logical_filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;This&nbsp;stored&nbsp;procedure&nbsp;was&nbsp;created&nbsp;to&nbsp;allow&nbsp;one&nbsp;to&nbsp;change&nbsp;logical&nbsp;file&nbsp;names&nbsp;of&nbsp;datbase&nbsp;files&nbsp;in&nbsp;a&nbsp;&nbsp;7.0&nbsp;database.&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;After&nbsp;doing&nbsp;a&nbsp;restore&nbsp;with&nbsp;the&nbsp;move&nbsp;option,&nbsp;one&nbsp;can&nbsp;change&nbsp;the&nbsp;physical&nbsp;file&nbsp;path&nbsp;and&nbsp;physcal&nbsp;file&nbsp;name,&nbsp;but&nbsp;not&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;the&nbsp;logical&nbsp;name.&nbsp;&nbsp;This&nbsp;posed&nbsp;a&nbsp;problem&nbsp;because&nbsp;we&nbsp;(GMAC)&nbsp;have&nbsp;internal&nbsp;standards&nbsp;for&nbsp;database&nbsp;names&nbsp;and&nbsp;for&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;logical&nbsp;and&nbsp;physical&nbsp;file&nbsp;names.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;This&nbsp;stored&nbsp;procedure&nbsp;does&nbsp;change&nbsp;the&nbsp;configuration&nbsp;paramater&nbsp;'allow&nbsp;updates'&nbsp;so&nbsp;it&nbsp;can&nbsp;directly&nbsp;update&nbsp;the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;sysfiles1&nbsp;table&nbsp;in&nbsp;the&nbsp;database&nbsp;in&nbsp;question.&nbsp;&nbsp;I&nbsp;thought&nbsp;it&nbsp;was&nbsp;very&nbsp;interesting&nbsp;that&nbsp;I&nbsp;was&nbsp;actually&nbsp;able&nbsp;to&nbsp;make&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;this&nbsp;change&nbsp;from&nbsp;within&nbsp;a&nbsp;storeded&nbsp;procedure.&nbsp;&nbsp;&nbsp;By&nbsp;the&nbsp;way,&nbsp;&nbsp;I've&nbsp;never&nbsp;run&nbsp;this&nbsp;on&nbsp;a&nbsp;production&nbsp;server&nbsp;...&nbsp;yet.&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;Usage:&nbsp;&nbsp;&nbsp;use&nbsp;database&nbsp;in&nbsp;question&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;sp_rename_logical_filename&nbsp;current_logical_name,&nbsp;new_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;You&nbsp;will&nbsp;have&nbsp;to&nbsp;execute&nbsp;this&nbsp;stored&nbsp;procedure&nbsp;for&nbsp;every&nbsp;logical&nbsp;name&nbsp;you&nbsp;wish&nbsp;to&nbsp;change&nbsp;in&nbsp;the&nbsp;database.&nbsp;&nbsp;It&nbsp;was&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;interesting&nbsp;that&nbsp;even&nbsp;with&nbsp;'allow&nbsp;updates'&nbsp;set,&nbsp;&nbsp;I&nbsp;could&nbsp;not&nbsp;update&nbsp;the&nbsp;sysfiles&nbsp;table&nbsp;...&nbsp;so&nbsp;I&nbsp;settled&nbsp;for&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;updating&nbsp;sysfiles1&nbsp;instead.&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;within&nbsp;the&nbsp;database,&nbsp;&nbsp;I&nbsp;used&nbsp;sp_helpfile&nbsp;and&nbsp;sp_helpdb&nbsp;to&nbsp;verify&nbsp;the&nbsp;changes.&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;I'm&nbsp;looking&nbsp;for&nbsp;ideas&nbsp;to&nbsp;improve&nbsp;this&nbsp;stored&nbsp;procedure&nbsp;...&nbsp;this&nbsp;is&nbsp;just&nbsp;a&nbsp;first&nbsp;run.&nbsp;&nbsp;&nbsp;Please&nbsp;feel&nbsp;free&nbsp;to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;contact&nbsp;me&nbsp;with&nbsp;any&nbsp;ideas&nbsp;or&nbsp;constructive&nbsp;criticism.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;could&nbsp;go&nbsp;nuts&nbsp;and&nbsp;add&nbsp;checks&nbsp;for&nbsp;all&nbsp;of&nbsp;the&nbsp;db&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;options&nbsp;and&nbsp;maybe&nbsp;only&nbsp;allow&nbsp;this&nbsp;if&nbsp;the&nbsp;db&nbsp;is&nbsp;in&nbsp;single&nbsp;user&nbsp;mode&nbsp;?&nbsp;&nbsp;What&nbsp;if&nbsp;the&nbsp;db&nbsp;is&nbsp;marked&nbsp;suspect&nbsp;?&nbsp;&nbsp;To&nbsp;be&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;more&nbsp;official,&nbsp;we&nbsp;could&nbsp;have&nbsp;more&nbsp;raiserrors&nbsp;and&nbsp;less&nbsp;prints.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;Original&nbsp;Author:&nbsp;&nbsp;&nbsp;Joe&nbsp;Toscano&nbsp;&nbsp;&nbsp;6/1/2000&nbsp;&nbsp;&nbsp;(jtoscano@ix.netcom.com)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;Revision&nbsp;History:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;************************************************************************************************************************/</P>
<P>if&nbsp;exists&nbsp;(select&nbsp;1&nbsp;from&nbsp;sysobjects&nbsp;where&nbsp;name&nbsp;=&nbsp;'sp_rename_logical_filename'&nbsp;and&nbsp;type&nbsp;=&nbsp;'P')<BR>&nbsp;&nbsp;&nbsp;drop&nbsp;proc&nbsp;sp_rename_logical_filename<BR>go</P>
<P>create&nbsp;proc&nbsp;sp_rename_logical_filename<BR>@current_name&nbsp;varchar(64)=&nbsp;null,<BR>@new_name&nbsp;varchar(64)=&nbsp;null<BR>as</P>
<P>&nbsp;&nbsp;declare&nbsp;@msg&nbsp;varchar(200),<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@cmd&nbsp;varchar(240),<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@err&nbsp;int</P>
<P>&nbsp;&nbsp;set&nbsp;nocount&nbsp;on</P>
<P>&nbsp;&nbsp;if&nbsp;@current_name&nbsp;is&nbsp;null&nbsp;or&nbsp;@new_name&nbsp;is&nbsp;null&nbsp;<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@msg&nbsp;=&nbsp;'Usage:&nbsp;&nbsp;exec&nbsp;sp_rename_logical_filename&nbsp;'&nbsp;+&nbsp;char(39)&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;'current_name'&nbsp;+&nbsp;char(39)&nbsp;+&nbsp;','&nbsp;+&nbsp;char(39)&nbsp;+&nbsp;'new_name'&nbsp;+&nbsp;char(39)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;@msg<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'(While&nbsp;in&nbsp;the&nbsp;database&nbsp;in&nbsp;question)'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(1)<BR>&nbsp;&nbsp;end</P>
<P>&nbsp;&nbsp;if&nbsp;db_name()&nbsp;='master'<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'You&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;database&nbsp;that&nbsp;contains&nbsp;the&nbsp;logical&nbsp;filenames&nbsp;you&nbsp;wish&nbsp;to&nbsp;modify&nbsp;...&nbsp;not&nbsp;in&nbsp;master'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(1)<BR>&nbsp;&nbsp;end</P>
<P>/*<BR>**&nbsp;&nbsp;Only&nbsp;the&nbsp;SA&nbsp;can&nbsp;execute&nbsp;sp_configure&nbsp;to&nbsp;change&nbsp;config&nbsp;parameters<BR>*/<BR>if&nbsp;(not&nbsp;is_srvrolemember('serveradmin')&nbsp;=&nbsp;1)<BR>&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'In&nbsp;order&nbsp;to&nbsp;execute&nbsp;this&nbsp;stored&nbsp;procedure,&nbsp;you&nbsp;must&nbsp;be&nbsp;permitted&nbsp;to&nbsp;directly&nbsp;update&nbsp;system&nbsp;tables'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raiserror(15125,-1,-1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(1)<BR>&nbsp;&nbsp;&nbsp;end<BR>/*<BR>&nbsp;*&nbsp;We&nbsp;are&nbsp;not&nbsp;going&nbsp;to&nbsp;let&nbsp;you&nbsp;&nbsp;be&nbsp;in&nbsp;a&nbsp;transaction&nbsp;...&nbsp;at&nbsp;least&nbsp;for&nbsp;now.<BR>&nbsp;*/</P>
<P>if&nbsp;@@trancount&nbsp;&gt;&nbsp;0<BR>begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raiserror(15002,-1,-1,&nbsp;'sp_rename_logical_filename')<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'Please&nbsp;perform&nbsp;a&nbsp;commit&nbsp;or&nbsp;rollback&nbsp;and&nbsp;then&nbsp;execute&nbsp;this&nbsp;stored&nbsp;procedure'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(1)<BR>end</P>
<P>/*<BR>&nbsp;*&nbsp;Let's&nbsp;make&nbsp;sure&nbsp;the&nbsp;logical&nbsp;file&nbsp;name&nbsp;you&nbsp;specify&nbsp;exists<BR>&nbsp;*/</P>
<P>if&nbsp;not&nbsp;exists&nbsp;(select&nbsp;1&nbsp;from&nbsp;sysfiles1&nbsp;where&nbsp;name&nbsp;=&nbsp;@current_name)<BR>begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@msg&nbsp;=&nbsp;'Logical&nbsp;File&nbsp;Name:&nbsp;&nbsp;'&nbsp;+&nbsp;@current_name&nbsp;+&nbsp;',&nbsp;&nbsp;not&nbsp;found&nbsp;in&nbsp;'&nbsp;+&nbsp;db_name()&nbsp;+&nbsp;'.&nbsp;&nbsp;Please&nbsp;check&nbsp;the&nbsp;name'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;@msg<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(1)<BR>end</P>
<P>/*<BR>&nbsp;*&nbsp;&nbsp;Change&nbsp;the&nbsp;option&nbsp;to&nbsp;allow&nbsp;updates&nbsp;to&nbsp;system&nbsp;tables&nbsp;...&nbsp;this&nbsp;is&nbsp;a&nbsp;server&nbsp;wide&nbsp;setting&nbsp;...&nbsp;that's&nbsp;a&nbsp;bit&nbsp;scarry!<BR>&nbsp;*/</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@cmd&nbsp;=&nbsp;'exec&nbsp;sp_configure&nbsp;'+&nbsp;&nbsp;char(39)&nbsp;+&nbsp;'allow&nbsp;updates'&nbsp;+&nbsp;char(39)&nbsp;+&nbsp;',&nbsp;1'&nbsp;+&nbsp;char(13)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;(@cmd)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@cmd&nbsp;=&nbsp;'reconfigure&nbsp;WITH&nbsp;override'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;(@cmd)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@err&nbsp;=&nbsp;0<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;sysfiles1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;name&nbsp;=&nbsp;@new_name<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;name&nbsp;=&nbsp;@current_name</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;@@error&nbsp;&lt;&gt;&nbsp;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;'sp_rename_logical_filename&nbsp;failed:&nbsp;&nbsp;Unable&nbsp;to&nbsp;update&nbsp;sysfiles1&nbsp;table&nbsp;with&nbsp;new&nbsp;logical&nbsp;name'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@err&nbsp;=&nbsp;1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;/*<BR>&nbsp;&nbsp;*&nbsp;&nbsp;Regardless&nbsp;of&nbsp;the&nbsp;status&nbsp;of&nbsp;our&nbsp;updates&nbsp;...&nbsp;&nbsp;change&nbsp;the&nbsp;option&nbsp;to&nbsp;allow&nbsp;updates&nbsp;to&nbsp;system&nbsp;tables&nbsp;back&nbsp;to&nbsp;0<BR>&nbsp;&nbsp;*/</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@cmd&nbsp;=&nbsp;'exec&nbsp;sp_configure&nbsp;'+&nbsp;&nbsp;char(39)&nbsp;+&nbsp;'allow&nbsp;updates'&nbsp;+&nbsp;char(39)&nbsp;+&nbsp;',&nbsp;0'&nbsp;+&nbsp;char(13)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;(@cmd)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@cmd&nbsp;=&nbsp;'reconfigure&nbsp;WITH&nbsp;override'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;(@cmd)</P>
<P><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@msg&nbsp;=&nbsp;&nbsp;'sp_rename_logical_filename:&nbsp;&nbsp;Changed&nbsp;filename:&nbsp;'&nbsp;+&nbsp;@current_name&nbsp;+&nbsp;'&nbsp;to&nbsp;:&nbsp;&nbsp;'&nbsp;+&nbsp;@new_name<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;@msg</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;nocount&nbsp;off</P>
<P>return&nbsp;@err</P>
<P>grant&nbsp;exec&nbsp;on&nbsp;sp_rename_logical_filename&nbsp;to&nbsp;public</P>
<P></P>
<P></P>
<P></P>
<P></P>
<P></P>
<P><BR></P></FONT>