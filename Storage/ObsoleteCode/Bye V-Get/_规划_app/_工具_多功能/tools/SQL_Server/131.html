<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Using&nbsp;Exotic&nbsp;Joins&nbsp;in&nbsp;SQL&nbsp;¨C&nbsp;Part&nbsp;2</B><BR>Chris&nbsp;Cubley,&nbsp;MCSD
<P></P>
<P><IMG src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A 
href="http://www.queryplan.com" target=_blank>www.queryplan.com</A></P>
<P>&nbsp;</P>
<P>In&nbsp;the&nbsp;previous&nbsp;article,&nbsp;you&nbsp;saw&nbsp;how&nbsp;the&nbsp;BETWEEN&nbsp;operator&nbsp;could&nbsp;be&nbsp;used&nbsp;in&nbsp;joins&nbsp;to&nbsp;solve&nbsp;problems&nbsp;dealing&nbsp;with&nbsp;range-based&nbsp;data.&nbsp;&nbsp;In&nbsp;this&nbsp;article,&nbsp;I&nbsp;will&nbsp;show&nbsp;you&nbsp;how&nbsp;to&nbsp;take&nbsp;joins&nbsp;even&nbsp;further&nbsp;by&nbsp;using&nbsp;multiple&nbsp;criteria&nbsp;in&nbsp;joins&nbsp;as&nbsp;well&nbsp;as&nbsp;using&nbsp;the&nbsp;greater&nbsp;than,&nbsp;less&nbsp;than,&nbsp;and&nbsp;not&nbsp;equals&nbsp;operators&nbsp;in&nbsp;joins.</P>
<P>&nbsp;</P>
<P>Compound&nbsp;Joins<BR>Compound&nbsp;joins&nbsp;are&nbsp;joins&nbsp;which&nbsp;use&nbsp;multiple&nbsp;criteria&nbsp;combined&nbsp;with&nbsp;a&nbsp;logical&nbsp;operator&nbsp;such&nbsp;as&nbsp;AND.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;relatively&nbsp;simple&nbsp;concept&nbsp;and&nbsp;is&nbsp;commonly&nbsp;used&nbsp;in&nbsp;database&nbsp;systems&nbsp;that&nbsp;employ&nbsp;compound&nbsp;primary&nbsp;keys.</P>
<P>&nbsp;</P>
<P>For&nbsp;a&nbsp;simple&nbsp;example&nbsp;of&nbsp;a&nbsp;database&nbsp;schema&nbsp;in&nbsp;which&nbsp;compound&nbsp;joins&nbsp;are&nbsp;necessary,&nbsp;consider&nbsp;a&nbsp;school&nbsp;management&nbsp;system&nbsp;where&nbsp;one&nbsp;of&nbsp;the&nbsp;features&nbsp;is&nbsp;tracking&nbsp;which&nbsp;classes&nbsp;are&nbsp;taught&nbsp;in&nbsp;which&nbsp;classrooms.&nbsp;&nbsp;The&nbsp;system&nbsp;must&nbsp;match&nbsp;up&nbsp;the&nbsp;features&nbsp;of&nbsp;the&nbsp;classrooms&nbsp;to&nbsp;the&nbsp;needs&nbsp;of&nbsp;the&nbsp;classes.&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;perform&nbsp;these&nbsp;functions,&nbsp;the&nbsp;following&nbsp;two&nbsp;tables&nbsp;are&nbsp;defined:</P>
<P>&nbsp;</P>
<P>CREATE&nbsp;TABLE&nbsp;tb_Classroom(</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BuildingName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(10)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RoomNumber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RoomCapacity&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HasLabEquip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONSTRAINT&nbsp;PK_Classroom&nbsp;PRIMARY&nbsp;KEY(BuildingName,&nbsp;RoomNumber)</P>
<P>)</P>
<P>&nbsp;</P>
<P>CREATE&nbsp;TABLE&nbsp;tb_ClassSection(</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CourseID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SectionNumber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>BuildingName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(10)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RoomNumber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InstructorID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ScheduleID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SectionCapacity&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RequiresLabEquip&nbsp;&nbsp;smallint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;NULL,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONSTRAINT&nbsp;PK_ClassSection&nbsp;PRIMARY&nbsp;KEY(CourseID,&nbsp;SectionNumber),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONSTRAINT&nbsp;FK_ClassSection_Classroom&nbsp;</P>
<P>FOREIGN&nbsp;KEY(BuildingName,&nbsp;RoomNumber)&nbsp;</P>
<P>REFERENCES&nbsp;tb_Classroom(BuildingName,&nbsp;RoomNumber)</P>
<P>)</P>
<P>&nbsp;</P>
<P>In&nbsp;this&nbsp;example,&nbsp;the&nbsp;tb_Classroom&nbsp;table&nbsp;defines&nbsp;a&nbsp;list&nbsp;of&nbsp;classrooms&nbsp;in&nbsp;which&nbsp;classes&nbsp;are&nbsp;taught.&nbsp;&nbsp;The&nbsp;tb_ClassSection&nbsp;table&nbsp;contains&nbsp;instances&nbsp;of&nbsp;various&nbsp;courses&nbsp;taught&nbsp;at&nbsp;the&nbsp;school.&nbsp;&nbsp;A&nbsp;class&nbsp;section&nbsp;is&nbsp;taught&nbsp;in&nbsp;a&nbsp;particular&nbsp;classroom&nbsp;by&nbsp;an&nbsp;instructor&nbsp;according&nbsp;to&nbsp;a&nbsp;standard&nbsp;class&nbsp;schedule.&nbsp;&nbsp;Both&nbsp;the&nbsp;tb_Classroom&nbsp;and&nbsp;tb_ClassSection&nbsp;tables&nbsp;use&nbsp;natural&nbsp;compound&nbsp;primary&nbsp;keys.</P>
<P>&nbsp;</P>
<P>One&nbsp;of&nbsp;the&nbsp;reports&nbsp;in&nbsp;the&nbsp;school&nbsp;management&nbsp;system&nbsp;lists&nbsp;the&nbsp;class&nbsp;sections&nbsp;being&nbsp;taught&nbsp;along&nbsp;with&nbsp;the&nbsp;capacity&nbsp;of&nbsp;their&nbsp;respective&nbsp;classrooms.&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;construct&nbsp;this&nbsp;report,&nbsp;the&nbsp;tb_ClassSection&nbsp;table&nbsp;must&nbsp;be&nbsp;joined&nbsp;the&nbsp;tb_Classroom&nbsp;table&nbsp;based&nbsp;upon&nbsp;the&nbsp;compound&nbsp;primary&nbsp;key&nbsp;of&nbsp;the&nbsp;tb_Classroom&nbsp;table.&nbsp;&nbsp;This&nbsp;can&nbsp;be&nbsp;accomplished&nbsp;by&nbsp;using&nbsp;a&nbsp;compound&nbsp;join&nbsp;to&nbsp;return&nbsp;rows&nbsp;where&nbsp;both&nbsp;the&nbsp;BuildingName&nbsp;AND&nbsp;RoomNumber&nbsp;columns&nbsp;match.</P>
<P>&nbsp;</P>
<P>SELECT</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.CourseID,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.SectionNumber,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.RoomCapacity</P>
<P>FROM</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb_ClassSection&nbsp;s</P>
<P>INNER&nbsp;JOIN</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb_Classroom&nbsp;c</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON(</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.BuildingName&nbsp;=&nbsp;c.BuildingName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.RoomNumber&nbsp;=&nbsp;s.RoomNumber</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;</P>
<P>This&nbsp;query&nbsp;is&nbsp;relatively&nbsp;straightforward.&nbsp;&nbsp;If&nbsp;you¡¯ve&nbsp;been&nbsp;using&nbsp;SQL&nbsp;for&nbsp;a&nbsp;while,&nbsp;chances&nbsp;are&nbsp;you¡¯ve&nbsp;seen&nbsp;queries&nbsp;like&nbsp;it.&nbsp;&nbsp;The&nbsp;query&nbsp;is&nbsp;a&nbsp;simple&nbsp;equijoin&nbsp;that&nbsp;uses&nbsp;the&nbsp;AND&nbsp;logical&nbsp;operator&nbsp;to&nbsp;include&nbsp;multiple&nbsp;criteria.&nbsp;&nbsp;Despite&nbsp;its&nbsp;simplicity,&nbsp;this&nbsp;example&nbsp;provides&nbsp;the&nbsp;basis&nbsp;for&nbsp;a&nbsp;much&nbsp;more&nbsp;powerful&nbsp;query&nbsp;construction&nbsp;tool.</P>
<P>&nbsp;</P>
<P>Joins&nbsp;Using&nbsp;Inequality&nbsp;Comparison&nbsp;Operators<BR>The&nbsp;school&nbsp;management&nbsp;system&nbsp;from&nbsp;the&nbsp;first&nbsp;example&nbsp;also&nbsp;contains&nbsp;a&nbsp;report&nbsp;listing&nbsp;all&nbsp;class&nbsp;sections&nbsp;in&nbsp;which&nbsp;the&nbsp;classroom&nbsp;is&nbsp;not&nbsp;large&nbsp;enough&nbsp;to&nbsp;accommodate&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;students&nbsp;for&nbsp;the&nbsp;class&nbsp;section.&nbsp;&nbsp;To&nbsp;determine&nbsp;which&nbsp;class&nbsp;sections&nbsp;meet&nbsp;these&nbsp;criteria,&nbsp;the&nbsp;system&nbsp;must&nbsp;compare&nbsp;the&nbsp;class&nbsp;section¡¯s&nbsp;capacity&nbsp;to&nbsp;the&nbsp;capacity&nbsp;of&nbsp;the&nbsp;classroom&nbsp;in&nbsp;which&nbsp;it&nbsp;is&nbsp;being&nbsp;taught.&nbsp;&nbsp;If&nbsp;the&nbsp;classroom¡¯s&nbsp;capacity&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;class&nbsp;section¡¯s&nbsp;capacity,&nbsp;then&nbsp;the&nbsp;class&nbsp;section&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;result&nbsp;set.</P>
<P>&nbsp;</P>
<P>With&nbsp;this&nbsp;query,&nbsp;the&nbsp;trick&nbsp;is&nbsp;to&nbsp;first&nbsp;join&nbsp;each&nbsp;class&nbsp;section&nbsp;to&nbsp;the&nbsp;classroom&nbsp;in&nbsp;which&nbsp;is&nbsp;being&nbsp;taught&nbsp;and&nbsp;then&nbsp;add&nbsp;the&nbsp;additional&nbsp;criterion&nbsp;that&nbsp;the&nbsp;classroom¡¯s&nbsp;capacity&nbsp;is&nbsp;less&nbsp;than&nbsp;that&nbsp;of&nbsp;the&nbsp;class&nbsp;section.&nbsp;&nbsp;To&nbsp;do&nbsp;this,&nbsp;simply&nbsp;take&nbsp;the&nbsp;query&nbsp;from&nbsp;the&nbsp;last&nbsp;example&nbsp;and&nbsp;add&nbsp;the&nbsp;additional&nbsp;criterion.</P>
<P>&nbsp;</P>
<P>SELECT</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.CourseID,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.SectionNumber,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.RoomCapacity,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.SectionCapacity</P>
<P>FROM</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb_ClassSection&nbsp;s</P>
<P>INNER&nbsp;JOIN</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb_Classroom&nbsp;c</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON(</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.BuildingName&nbsp;=&nbsp;c.BuildingName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.RoomNumber&nbsp;=&nbsp;s.RoomNumber</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.RoomCapacity&nbsp;&lt;&nbsp;s.SectionCapacity</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</P>
<P>&nbsp;</P>
<P>A&nbsp;common&nbsp;mistake&nbsp;when&nbsp;constructing&nbsp;queries&nbsp;such&nbsp;as&nbsp;this&nbsp;is&nbsp;not&nbsp;including&nbsp;the&nbsp;equijoin&nbsp;criteria&nbsp;necessary&nbsp;to&nbsp;match&nbsp;up&nbsp;the&nbsp;rows&nbsp;to&nbsp;be&nbsp;compared&nbsp;by&nbsp;the&nbsp;inequality&nbsp;operator.&nbsp;&nbsp;If&nbsp;only&nbsp;the&nbsp;inequality&nbsp;comparison&nbsp;is&nbsp;included&nbsp;in&nbsp;the&nbsp;criteria,&nbsp;the&nbsp;query&nbsp;returns&nbsp;all&nbsp;the&nbsp;rows&nbsp;where&nbsp;a&nbsp;classroom¡¯s&nbsp;capacity&nbsp;is&nbsp;less&nbsp;than&nbsp;that&nbsp;of&nbsp;any&nbsp;class&nbsp;section,&nbsp;regardless&nbsp;of&nbsp;whether&nbsp;or&nbsp;not&nbsp;the&nbsp;class&nbsp;section&nbsp;was&nbsp;taught&nbsp;in&nbsp;that&nbsp;classroom.</P>
<P>&nbsp;</P>
<P>Not&nbsp;Equals&nbsp;Joins<BR>You&nbsp;may&nbsp;be&nbsp;wondering&nbsp;how&nbsp;in&nbsp;the&nbsp;world&nbsp;it&nbsp;could&nbsp;be&nbsp;useful&nbsp;to&nbsp;use&nbsp;the&nbsp;not&nbsp;equals&nbsp;operator&nbsp;in&nbsp;a&nbsp;join.&nbsp;&nbsp;For&nbsp;an&nbsp;example,&nbsp;consider&nbsp;another&nbsp;report&nbsp;in&nbsp;the&nbsp;school&nbsp;management&nbsp;system&nbsp;in&nbsp;which&nbsp;you&nbsp;must&nbsp;the&nbsp;misallocation&nbsp;of&nbsp;laboratory-equipped&nbsp;classrooms.&nbsp;&nbsp;This&nbsp;report&nbsp;must&nbsp;list&nbsp;all&nbsp;of&nbsp;the&nbsp;class&nbsp;sections&nbsp;that&nbsp;require&nbsp;laboratory&nbsp;equipment,&nbsp;but&nbsp;are&nbsp;scheduled&nbsp;to&nbsp;be&nbsp;taught&nbsp;in&nbsp;classrooms&nbsp;that&nbsp;do&nbsp;not&nbsp;have&nbsp;it.&nbsp;&nbsp;The&nbsp;report&nbsp;should&nbsp;also&nbsp;include&nbsp;all&nbsp;non-lab&nbsp;class&nbsp;sections&nbsp;being&nbsp;taught&nbsp;in&nbsp;laboratory&nbsp;classrooms.&nbsp;&nbsp;In&nbsp;the&nbsp;tables,&nbsp;the&nbsp;class&nbsp;sections&nbsp;that&nbsp;require&nbsp;laboratory&nbsp;equipment&nbsp;are&nbsp;indicated&nbsp;with&nbsp;a&nbsp;RequiresLabEquip&nbsp;value&nbsp;of&nbsp;1,&nbsp;and&nbsp;the&nbsp;classrooms&nbsp;equipped&nbsp;with&nbsp;laboratory&nbsp;equipment&nbsp;are&nbsp;indicated&nbsp;with&nbsp;a&nbsp;HasLabEquip&nbsp;value&nbsp;of&nbsp;1.</P>
<P>&nbsp;</P>
<P>This&nbsp;problem&nbsp;follows&nbsp;a&nbsp;similar&nbsp;pattern&nbsp;to&nbsp;that&nbsp;of&nbsp;the&nbsp;capacity&nbsp;problem.&nbsp;&nbsp;The&nbsp;only&nbsp;difference&nbsp;is&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;not&nbsp;equals&nbsp;operator&nbsp;in&nbsp;place&nbsp;of&nbsp;the&nbsp;less&nbsp;than&nbsp;operator.&nbsp;&nbsp;After&nbsp;matching&nbsp;the&nbsp;class&nbsp;section&nbsp;with&nbsp;the&nbsp;classroom&nbsp;in&nbsp;which&nbsp;it&nbsp;is&nbsp;being&nbsp;taught,&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;RequiresLabEquip&nbsp;column&nbsp;must&nbsp;be&nbsp;compared&nbsp;with&nbsp;the&nbsp;HasLabEquip&nbsp;column.&nbsp;&nbsp;If&nbsp;these&nbsp;values&nbsp;are&nbsp;not&nbsp;equal,&nbsp;there&nbsp;is&nbsp;a&nbsp;laboratory&nbsp;equipment&nbsp;allocation&nbsp;problem&nbsp;and&nbsp;the&nbsp;class&nbsp;section&nbsp;should&nbsp;be&nbsp;included&nbsp;on&nbsp;the&nbsp;report.&nbsp;&nbsp;Applying&nbsp;these&nbsp;criteria&nbsp;result&nbsp;in&nbsp;the&nbsp;following&nbsp;query:</P>
<P>&nbsp;</P>
<P>SELECT</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.CourseID,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.SectionNumber,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.HasLabEquip,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.RequiresLabEquip</P>
<P>FROM</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb_ClassSection&nbsp;s</P>
<P>INNER&nbsp;JOIN</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb_Classroom&nbsp;c</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON(</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.BuildingName&nbsp;=&nbsp;c.BuildingName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.RoomNumber&nbsp;=&nbsp;s.RoomNumber</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.HasLabEquip&nbsp;&lt;&gt;&nbsp;s.RequiresLabEquip</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</P>
<P>&nbsp;</P>
<P>When&nbsp;using&nbsp;the&nbsp;not&nbsp;equals&nbsp;operator&nbsp;in&nbsp;joins,&nbsp;it&nbsp;is&nbsp;even&nbsp;more&nbsp;vital&nbsp;to&nbsp;remember&nbsp;to&nbsp;use&nbsp;additional&nbsp;join&nbsp;criteria&nbsp;than&nbsp;it&nbsp;is&nbsp;when&nbsp;using&nbsp;the&nbsp;greater&nbsp;than&nbsp;and&nbsp;less&nbsp;than&nbsp;operators.&nbsp;&nbsp;In&nbsp;this&nbsp;case,&nbsp;if&nbsp;only&nbsp;the&nbsp;not&nbsp;equals&nbsp;criterion&nbsp;was&nbsp;specified,&nbsp;the&nbsp;query&nbsp;would&nbsp;perform&nbsp;a&nbsp;cross&nbsp;join&nbsp;and&nbsp;then&nbsp;exclude&nbsp;only&nbsp;the&nbsp;class&nbsp;section-classroom&nbsp;pairs&nbsp;where&nbsp;the&nbsp;laboratory&nbsp;indicator&nbsp;was&nbsp;not&nbsp;equal.&nbsp;&nbsp;If&nbsp;there&nbsp;were&nbsp;100&nbsp;classrooms&nbsp;and&nbsp;500&nbsp;class&nbsp;sections,&nbsp;this&nbsp;could&nbsp;possibly&nbsp;return&nbsp;a&nbsp;result&nbsp;set&nbsp;of&nbsp;25,000&nbsp;-&nbsp;50,000&nbsp;rows&nbsp;¨C&nbsp;definitely&nbsp;not&nbsp;what&nbsp;was&nbsp;intended.</P>
<P>&nbsp;</P>
<P>Beyond&nbsp;the&nbsp;Basics<BR>Compound&nbsp;joins,&nbsp;especially&nbsp;those&nbsp;employing&nbsp;the&nbsp;inequality&nbsp;and&nbsp;not&nbsp;equals&nbsp;operators,&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;other&nbsp;advanced&nbsp;SQL&nbsp;techniques&nbsp;to&nbsp;construct&nbsp;queries&nbsp;that&nbsp;are&nbsp;even&nbsp;more&nbsp;powerful.&nbsp;&nbsp;The&nbsp;key&nbsp;to&nbsp;leveraging&nbsp;these&nbsp;advanced&nbsp;joins&nbsp;is&nbsp;to&nbsp;spell&nbsp;out&nbsp;the&nbsp;requirements&nbsp;of&nbsp;the&nbsp;problem&nbsp;clearly&nbsp;in&nbsp;terms&nbsp;of&nbsp;relating&nbsp;the&nbsp;available&nbsp;sets&nbsp;of&nbsp;data.&nbsp;&nbsp;Once&nbsp;the&nbsp;relationships&nbsp;between&nbsp;the&nbsp;sets&nbsp;of&nbsp;data&nbsp;are&nbsp;understood,&nbsp;these&nbsp;relationships&nbsp;can&nbsp;be&nbsp;encoded&nbsp;into&nbsp;join&nbsp;criteria.&nbsp;&nbsp;This&nbsp;technique,&nbsp;along&nbsp;with&nbsp;testing&nbsp;and&nbsp;validation&nbsp;of&nbsp;the&nbsp;output,&nbsp;will&nbsp;enable&nbsp;you&nbsp;to&nbsp;solve&nbsp;complicated&nbsp;problems&nbsp;effectively</P></FONT>