<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>FormatDate</B><BR>FormatDate.sql
<P></P>
<P></P>
<P><BR>This&nbsp;script&nbsp;will&nbsp;create&nbsp;a&nbsp;UDF&nbsp;called&nbsp;FormatDate&nbsp;that&nbsp;allows&nbsp;you&nbsp;to&nbsp;format&nbsp;a&nbsp;date&nbsp;by&nbsp;simply&nbsp;supplying&nbsp;a&nbsp;format&nbsp;such&nbsp;as&nbsp;'mm/dd/yyyy',&nbsp;'yyyymmdd',&nbsp;'dddd,&nbsp;mmmm&nbsp;d1,&nbsp;yyyy',&nbsp;etc.&nbsp;The&nbsp;comment&nbsp;header&nbsp;provides&nbsp;additional&nbsp;examples&nbsp;of&nbsp;how&nbsp;to&nbsp;use&nbsp;the&nbsp;function.&nbsp;The&nbsp;script&nbsp;has&nbsp;been&nbsp;tested&nbsp;on&nbsp;SQL&nbsp;Server&nbsp;2000.&nbsp;</P>
<P>Author:&nbsp;Rusty&nbsp;Hansen</P>
<P>Author:&nbsp;Rusty&nbsp;Hansen&nbsp;8-21-2001<BR>Description:&nbsp;Formats&nbsp;a&nbsp;date&nbsp;to&nbsp;a&nbsp;specific&nbsp;format.<BR>Parameters:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@dDate&nbsp;=&nbsp;A&nbsp;value&nbsp;or&nbsp;field&nbsp;of&nbsp;datatype&nbsp;datetime&nbsp;or&nbsp;a&nbsp;value&nbsp;or&nbsp;field&nbsp;that&nbsp;can&nbsp;be&nbsp;explicitly&nbsp;converted&nbsp;to&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;datetime&nbsp;datatype.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sFormat&nbsp;varchar(40)&nbsp;=&nbsp;Format&nbsp;codes&nbsp;using&nbsp;the&nbsp;characters&nbsp;described&nbsp;below<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMMM&nbsp;or&nbsp;DDDD&nbsp;=&nbsp;the&nbsp;full&nbsp;name&nbsp;for&nbsp;the&nbsp;day&nbsp;or&nbsp;month<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMM&nbsp;or&nbsp;DDD&nbsp;=&nbsp;the&nbsp;first&nbsp;3&nbsp;letters&nbsp;of&nbsp;the&nbsp;month&nbsp;or&nbsp;day<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MM&nbsp;or&nbsp;DD&nbsp;=&nbsp;the&nbsp;two&nbsp;digit&nbsp;code&nbsp;signifying&nbsp;the&nbsp;month&nbsp;or&nbsp;day<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M1&nbsp;or&nbsp;D1&nbsp;=&nbsp;the&nbsp;month&nbsp;or&nbsp;day&nbsp;value&nbsp;without&nbsp;a&nbsp;preceding&nbsp;zero<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YYYY&nbsp;=&nbsp;a&nbsp;four&nbsp;digit&nbsp;year<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YY&nbsp;=&nbsp;a&nbsp;two&nbsp;digit&nbsp;year<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All&nbsp;other&nbsp;characters&nbsp;will&nbsp;not&nbsp;be&nbsp;replaced&nbsp;such&nbsp;as&nbsp;/&nbsp;-&nbsp;.&nbsp;*&nbsp;#&nbsp;a&nbsp;b&nbsp;z&nbsp;x&nbsp;%&nbsp;and&nbsp;will&nbsp;show<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;up&nbsp;in&nbsp;the&nbsp;date&nbsp;in&nbsp;the&nbsp;same&nbsp;relative&nbsp;position&nbsp;that&nbsp;they&nbsp;appear&nbsp;in&nbsp;the&nbsp;format<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Examples<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;dbo.FormatDate('9/21/2001','dddd,&nbsp;mmmm&nbsp;d1,&nbsp;yyyy')&nbsp;--&gt;&nbsp;Friday,&nbsp;September&nbsp;21,&nbsp;2001<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;dbo.FormatDate('9/21/2001','mm/dd/yyyy')&nbsp;--&gt;&nbsp;09/21/2001<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;dbo.FormatDate('9/21/2001','mm-dd-yyyy')&nbsp;--&gt;&nbsp;09/21/2001<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;dbo.FormatDate('9/21/2001','yyyymmdd')&nbsp;--&gt;&nbsp;20010921<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;dbo.FormatDate('9/5/2001','m1/d1/yy')&nbsp;--&gt;&nbsp;9/5/01<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;dbo.FormatDate('9/21/2001','mmm-yyyy')&nbsp;--&gt;&nbsp;Sep-2001</P>
<P>//////////////////////////////////////////////////////////////////////////////////<BR>*/</P>
<P>create&nbsp;function&nbsp;[dbo].[FormatDate]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@dDate&nbsp;datetime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--Date&nbsp;value&nbsp;to&nbsp;be&nbsp;formatted<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@sFormat&nbsp;varchar(40)&nbsp;&nbsp;&nbsp;&nbsp;--Format&nbsp;for&nbsp;date&nbsp;value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<BR>returns&nbsp;varchar(40)<BR>as<BR>begin</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Insert&nbsp;the&nbsp;Month<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;~~~~~~~~~~~~~~~~<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'MMMM',datename(month,@dDate))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'MMM',convert(char(3),datename(month,@dDate)))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'MM',right(convert(char(4),@dDate,12),2))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'M1',convert(varchar(2),convert(int,right(convert(char(4),@dDate,12),2))))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Insert&nbsp;the&nbsp;Day<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;~~~~~~~~~~~~~~<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'DDDD',datename(weekday,@dDate))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'DDD',convert(char(3),datename(weekday,@dDate)))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'DD',right(convert(char(6),@dDate,12),2))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'D1',convert(varchar(2),convert(int,right(convert(char(6),@dDate,12),2))))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Insert&nbsp;the&nbsp;Year<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;~~~~~~~~~~~~~~~<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'YYYY',convert(char(4),@dDate,112))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@sFormat&nbsp;=&nbsp;replace(@sFormat,'YY',convert(char(2),@dDate,12))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Return&nbsp;the&nbsp;function's&nbsp;value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;~~~~~~~~~~~~~~~~~~~~~~~~~~~&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;@sFormat<BR>end<BR></P></FONT>