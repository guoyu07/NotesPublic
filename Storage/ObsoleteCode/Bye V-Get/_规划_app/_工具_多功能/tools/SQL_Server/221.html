<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Case&nbsp;Sensitive&nbsp;Char&nbsp;Index&nbsp;Function</B><BR>Case&nbsp;Sensitive&nbsp;Char&nbsp;Index&nbsp;Function
<P></P>
<P>&gt;&gt;Script&nbsp;Language&nbsp;and&nbsp;Platform:&nbsp;SQL&nbsp;Server<BR>This&nbsp;function&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;a&nbsp;character&nbsp;in&nbsp;a&nbsp;given&nbsp;string.&nbsp;</P>
<P>Author:&nbsp;STLSegwayAdmin&nbsp;</P>
<P>select&nbsp;dbo.udf_CharIndex('A',&nbsp;'The&nbsp;Segway&nbsp;HT&nbsp;is&nbsp;Awesome!')<BR>Script&nbsp;Code:&nbsp;SET&nbsp;QUOTED_IDENTIFIER&nbsp;ON&nbsp;<BR>GO<BR>SET&nbsp;ANSI_NULLS&nbsp;ON&nbsp;<BR>GO<BR>CREATE&nbsp;FUNCTION&nbsp;udf_CharIndex(@sChar&nbsp;CHAR(1),&nbsp;@strKey&nbsp;VARCHAR(94))&nbsp;<BR>RETURNS&nbsp;INT<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;/***<BR>&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;Date:&nbsp;&nbsp;&nbsp;01/22/2002<BR>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;Auth:&nbsp;&nbsp;&nbsp;Mike&nbsp;McWilliams<BR>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;Desc:&nbsp;&nbsp;&nbsp;Returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;with&nbsp;case-sensitivity<BR>&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;@strKey&nbsp;is&nbsp;set&nbsp;at&nbsp;a&nbsp;length&nbsp;of&nbsp;94&nbsp;(the&nbsp;length&nbsp;of&nbsp;all&nbsp;typeable&nbsp;keys);&nbsp;but<BR>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;you&nbsp;can&nbsp;set&nbsp;this&nbsp;to&nbsp;any&nbsp;value.&nbsp;&nbsp;This&nbsp;only&nbsp;will&nbsp;return&nbsp;the&nbsp;first&nbsp;occurance<BR>&nbsp;&nbsp;&nbsp;&nbsp;***/</P>
<P>&nbsp;&nbsp;&nbsp;DECLARE&nbsp;@nPOS&nbsp;INT<BR>&nbsp;&nbsp;&nbsp;DECLARE&nbsp;@nRet&nbsp;INT</P>
<P>&nbsp;&nbsp;&nbsp;SET&nbsp;@nRet&nbsp;=&nbsp;-1<BR>&nbsp;&nbsp;&nbsp;SET&nbsp;@nPOS&nbsp;=&nbsp;1</P>
<P>&nbsp;&nbsp;&nbsp;WHILE&nbsp;@nPOS&nbsp;&lt;&nbsp;LEN(@strKey)&nbsp;+&nbsp;1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ASCII(@sChar)&nbsp;=&nbsp;ASCII(SUBSTRING(@strKey,&nbsp;@nPos,1))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@nRet&nbsp;=&nbsp;@nPos<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BREAK<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@nPos&nbsp;=&nbsp;@nPos&nbsp;+&nbsp;1</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END</P>
<P>&nbsp;&nbsp;RETURN(@nRet)<BR>END<BR>GO<BR>SET&nbsp;QUOTED_IDENTIFIER&nbsp;OFF&nbsp;<BR>GO<BR>SET&nbsp;ANSI_NULLS&nbsp;ON&nbsp;<BR>GO</P></FONT>