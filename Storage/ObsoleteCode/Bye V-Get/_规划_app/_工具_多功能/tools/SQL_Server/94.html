<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>º¯Êý-A&nbsp;Few&nbsp;Mathematical&nbsp;UDFs</B><BR>Introduction<BR>I&nbsp;would&nbsp;like&nbsp;to&nbsp;write&nbsp;the&nbsp;series&nbsp;of&nbsp;articles&nbsp;about&nbsp;useful&nbsp;User-Defined<BR>Functions&nbsp;grouped&nbsp;by&nbsp;the&nbsp;following&nbsp;categories:
<P></P>
<P>Date&nbsp;and&nbsp;Time&nbsp;User-Defined&nbsp;Functions<BR>Mathematical&nbsp;User-Defined&nbsp;Functions<BR>Metadata&nbsp;User-Defined&nbsp;Functions<BR>Security&nbsp;User-Defined&nbsp;Functions<BR>String&nbsp;User-Defined&nbsp;Functions<BR>System&nbsp;User-Defined&nbsp;Functions<BR>Text&nbsp;and&nbsp;Image&nbsp;User-Defined&nbsp;Functions</P>
<P>In&nbsp;this&nbsp;article,&nbsp;I&nbsp;wrote&nbsp;some&nbsp;useful&nbsp;Mathematical&nbsp;User-Defined<BR>Functions.</P>
<P>Mathematical&nbsp;UDFs<BR>These&nbsp;scalar&nbsp;User-Defined&nbsp;Functions&nbsp;perform&nbsp;a&nbsp;calculation,&nbsp;usually<BR>based&nbsp;on&nbsp;input&nbsp;values&nbsp;provided&nbsp;as&nbsp;arguments,&nbsp;and&nbsp;return&nbsp;a&nbsp;numeric<BR>value.</P>
<P>To&nbsp;download&nbsp;Mathematical&nbsp;User-Defined&nbsp;Functions&nbsp;click&nbsp;this&nbsp;link:<BR>Download&nbsp;Mathematical&nbsp;UDFs</P>
<P>Factorial<BR>Returns&nbsp;the&nbsp;factorial&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;number.</P>
<P>Syntax<BR>Factorial&nbsp;(&nbsp;number&nbsp;)</P>
<P>Arguments<BR>number</P>
<P>Is&nbsp;the&nbsp;integer&nbsp;value.</P>
<P>Return&nbsp;Types<BR>bigint</P>
<P>The&nbsp;function''s&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;Factorial<BR>&nbsp;&nbsp;(&nbsp;@number&nbsp;int&nbsp;)<BR>RETURNS&nbsp;bigint<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;DECLARE&nbsp;@i&nbsp;int,&nbsp;@factorial&nbsp;bigint<BR>&nbsp;&nbsp;IF&nbsp;@number&nbsp;&gt;&nbsp;20&nbsp;RETURN&nbsp;0<BR>&nbsp;&nbsp;SET&nbsp;@i&nbsp;=&nbsp;1<BR>&nbsp;&nbsp;SET&nbsp;@factorial&nbsp;=&nbsp;1<BR>&nbsp;&nbsp;WHILE&nbsp;@i&nbsp;&lt;=&nbsp;@number<BR>&nbsp;&nbsp;&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@factorial&nbsp;=&nbsp;@factorial&nbsp;*&nbsp;@i<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@i&nbsp;=&nbsp;@i&nbsp;+&nbsp;1<BR>&nbsp;&nbsp;&nbsp;&nbsp;END<BR>&nbsp;&nbsp;RETURN&nbsp;@factorial<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>This&nbsp;example&nbsp;returns&nbsp;the&nbsp;factorial&nbsp;value&nbsp;of&nbsp;the&nbsp;number&nbsp;5:</P>
<P>SELECT&nbsp;dbo.Factorial(5)<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>--------------------<BR>120</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>PercentFrom<BR>Returns&nbsp;the&nbsp;percent&nbsp;of&nbsp;the&nbsp;expression1&nbsp;in&nbsp;the&nbsp;expression2.</P>
<P>Syntax<BR>PercentFrom&nbsp;(&nbsp;expression1,&nbsp;expression2&nbsp;)</P>
<P>Arguments<BR>expression1</P>
<P>Is&nbsp;an&nbsp;expression&nbsp;of&nbsp;the&nbsp;exact&nbsp;numeric&nbsp;or&nbsp;approximate&nbsp;numeric<BR>data&nbsp;type&nbsp;category.</P>
<P>expression2</P>
<P>Is&nbsp;an&nbsp;expression&nbsp;of&nbsp;the&nbsp;exact&nbsp;numeric&nbsp;or&nbsp;approximate&nbsp;numeric<BR>data&nbsp;type&nbsp;category.</P>
<P>Return&nbsp;Types<BR>float</P>
<P>The&nbsp;function''s&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;PercentFrom<BR>&nbsp;&nbsp;(&nbsp;@expression1&nbsp;SQL_VARIANT,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@expression2&nbsp;SQL_VARIANT&nbsp;)<BR>RETURNS&nbsp;float<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;RETURN&nbsp;(CAST(@expression1&nbsp;AS&nbsp;FLOAT)/CAST(@expression2&nbsp;AS&nbsp;FLOAT)*100)<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>This&nbsp;example&nbsp;returns&nbsp;the&nbsp;percent&nbsp;of&nbsp;the&nbsp;137&nbsp;in&nbsp;the&nbsp;273:</P>
<P>SELECT&nbsp;dbo.PercentFrom(137,&nbsp;273)<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------------------------------------------------<BR>50.183150183150182</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>Percentvalue<BR>Returns&nbsp;the&nbsp;percent''s&nbsp;value&nbsp;from&nbsp;the&nbsp;given&nbsp;expression&nbsp;for&nbsp;the<BR>given&nbsp;percent.</P>
<P>Syntax<BR>Percentvalue&nbsp;(&nbsp;expression,&nbsp;percent&nbsp;)</P>
<P>Arguments<BR>expression</P>
<P>Is&nbsp;an&nbsp;expression&nbsp;of&nbsp;the&nbsp;exact&nbsp;numeric&nbsp;or&nbsp;approximate&nbsp;numeric<BR>data&nbsp;type&nbsp;category.</P>
<P>percent</P>
<P>Is&nbsp;the&nbsp;integer&nbsp;value.</P>
<P>Return&nbsp;Types<BR>float</P>
<P>The&nbsp;function''s&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;Percentvalue<BR>&nbsp;&nbsp;(&nbsp;@expression&nbsp;SQL_VARIANT,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@percent&nbsp;int&nbsp;)<BR>RETURNS&nbsp;float<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;RETURN&nbsp;(&nbsp;CAST(@expression&nbsp;AS&nbsp;FLOAT)&nbsp;/&nbsp;100&nbsp;*&nbsp;@percent&nbsp;)<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>Returns&nbsp;the&nbsp;percent''s&nbsp;value&nbsp;from&nbsp;the&nbsp;number&nbsp;137&nbsp;for&nbsp;the&nbsp;percent&nbsp;11:</P>
<P>SELECT&nbsp;dbo.Percentvalue&nbsp;(137,&nbsp;11)<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------------------------------------------------<BR>15.07</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>Degree<BR>Returns&nbsp;the&nbsp;degree&nbsp;for&nbsp;the&nbsp;given&nbsp;number&nbsp;and&nbsp;degree&nbsp;value.</P>
<P>Syntax<BR>Degree&nbsp;(&nbsp;number,&nbsp;degree&nbsp;)</P>
<P>Arguments<BR>number</P>
<P>Is&nbsp;an&nbsp;expression&nbsp;of&nbsp;the&nbsp;exact&nbsp;numeric&nbsp;or&nbsp;approximate&nbsp;numeric<BR>data&nbsp;type&nbsp;category.</P>
<P>degree</P>
<P>Is&nbsp;the&nbsp;integer&nbsp;value.</P>
<P>Return&nbsp;Types<BR>float</P>
<P>The&nbsp;function''s&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;Degree<BR>&nbsp;&nbsp;(&nbsp;@number&nbsp;SQL_VARIANT,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@degree&nbsp;int&nbsp;)<BR>RETURNS&nbsp;float<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;DECLARE&nbsp;@i&nbsp;int,&nbsp;@res&nbsp;float<BR>&nbsp;&nbsp;SET&nbsp;@i&nbsp;=&nbsp;1<BR>&nbsp;&nbsp;SET&nbsp;@res&nbsp;=&nbsp;1<BR>&nbsp;&nbsp;WHILE&nbsp;@i&nbsp;&lt;=&nbsp;@degree<BR>&nbsp;&nbsp;&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@res&nbsp;=&nbsp;CAST(@number&nbsp;AS&nbsp;FLOAT)&nbsp;*&nbsp;@res<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@i&nbsp;=&nbsp;@i&nbsp;+&nbsp;1<BR>&nbsp;&nbsp;&nbsp;&nbsp;END<BR>&nbsp;&nbsp;RETURN&nbsp;@res<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>Returns&nbsp;the&nbsp;degree&nbsp;4&nbsp;for&nbsp;the&nbsp;number&nbsp;3:</P>
<P>SELECT&nbsp;dbo.Degree(3,&nbsp;4)<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------------------------------------------------<BR>81.0</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>Allocation<BR>Returns&nbsp;the&nbsp;allocation&nbsp;from&nbsp;the&nbsp;m&nbsp;by&nbsp;n.</P>
<P>Syntax<BR>Allocation&nbsp;(&nbsp;m,&nbsp;n&nbsp;)</P>
<P>Arguments<BR>m</P>
<P>Is&nbsp;the&nbsp;integer&nbsp;value.</P>
<P>n</P>
<P>Is&nbsp;the&nbsp;integer&nbsp;value.</P>
<P>Return&nbsp;Types<BR>int</P>
<P>The&nbsp;function''s&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;Allocation<BR>&nbsp;&nbsp;(&nbsp;@m&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@n&nbsp;int&nbsp;)<BR>RETURNS&nbsp;int<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;RETURN&nbsp;(dbo.Factorial(@m)/dbo.Factorial(@m-@n))<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>Returns&nbsp;the&nbsp;allocation&nbsp;from&nbsp;the&nbsp;5&nbsp;by&nbsp;3:</P>
<P>SELECT&nbsp;dbo.Allocation(5,3)<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------<BR>60</P>
<P>(1&nbsp;row(s)&nbsp;affected)</P>
<P><BR>Combination<BR>Returns&nbsp;the&nbsp;combination&nbsp;from&nbsp;the&nbsp;m&nbsp;by&nbsp;n.</P>
<P>Syntax<BR>Combination&nbsp;(&nbsp;m,&nbsp;n&nbsp;)</P>
<P>Arguments<BR>m</P>
<P>Is&nbsp;the&nbsp;integer&nbsp;value.</P>
<P>n</P>
<P>Is&nbsp;the&nbsp;integer&nbsp;value.</P>
<P>Return&nbsp;Types<BR>int</P>
<P>The&nbsp;function''s&nbsp;text:</P>
<P>CREATE&nbsp;FUNCTION&nbsp;Combination<BR>&nbsp;&nbsp;(&nbsp;@m&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@n&nbsp;int&nbsp;)<BR>RETURNS&nbsp;int<BR>AS<BR>BEGIN<BR>&nbsp;&nbsp;RETURN&nbsp;(dbo.Factorial(@m)/(dbo.Factorial(@m-@n)*dbo.Factorial(@n)))<BR>END<BR>GO<BR>&nbsp;</P>
<P>Examples<BR>Returns&nbsp;the&nbsp;combination&nbsp;from&nbsp;the&nbsp;5&nbsp;by&nbsp;3:</P>
<P>SELECT&nbsp;dbo.Combination(5,3)<BR>GO<BR>&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;result&nbsp;set:</P>
<P>-----------<BR>10</P>
<P>(1&nbsp;row(s)&nbsp;affected</P></FONT>