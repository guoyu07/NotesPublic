<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>×Ö·û´®-&nbsp;Using&nbsp;CHARINDEX</B><BR>Introduction&nbsp;<BR>It''s&nbsp;time&nbsp;to&nbsp;talk&nbsp;about&nbsp;string&nbsp;manipulation.&nbsp;What&nbsp;is&nbsp;it?&nbsp;Why&nbsp;do&nbsp;it?&nbsp;When&nbsp;should&nbsp;we&nbsp;do&nbsp;it?&nbsp;All&nbsp;good&nbsp;questions&nbsp;and&nbsp;some&nbsp;of&nbsp;the&nbsp;answers&nbsp;are&nbsp;in&nbsp;Part&nbsp;1.&nbsp;This&nbsp;article&nbsp;will&nbsp;work&nbsp;on&nbsp;some&nbsp;advanced&nbsp;string&nbsp;manipulation&nbsp;techniques&nbsp;that&nbsp;I&nbsp;used&nbsp;to&nbsp;solve&nbsp;another&nbsp;problem.&nbsp;If&nbsp;you&nbsp;are&nbsp;new,&nbsp;I&nbsp;write&nbsp;about&nbsp;specific&nbsp;problems,&nbsp;not&nbsp;general&nbsp;ones,&nbsp;in&nbsp;general&nbsp;:),&nbsp;so&nbsp;I&nbsp;hope&nbsp;you&nbsp;enjoy&nbsp;this&nbsp;and&nbsp;learn&nbsp;something.&nbsp;
<P></P>
<P>My&nbsp;Problem&nbsp;<BR>I&nbsp;hope&nbsp;that&nbsp;few&nbsp;of&nbsp;you&nbsp;have&nbsp;run&nbsp;into&nbsp;this,&nbsp;but&nbsp;given&nbsp;the&nbsp;experiences&nbsp;I&nbsp;have&nbsp;had,&nbsp;it''s&nbsp;quite&nbsp;likely&nbsp;more&nbsp;than&nbsp;a&nbsp;few&nbsp;of&nbsp;you&nbsp;have&nbsp;had&nbsp;this&nbsp;problem.&nbsp;In&nbsp;one&nbsp;table,&nbsp;the&nbsp;developers&nbsp;had&nbsp;decided&nbsp;that&nbsp;they&nbsp;needed&nbsp;to&nbsp;store&nbsp;answers&nbsp;to&nbsp;questions&nbsp;asked&nbsp;on&nbsp;the&nbsp;website.&nbsp;Some&nbsp;of&nbsp;the&nbsp;questions&nbsp;that&nbsp;were&nbsp;asked&nbsp;contained&nbsp;multiple&nbsp;possible&nbsp;answers.&nbsp;An&nbsp;example&nbsp;of&nbsp;this&nbsp;type&nbsp;of&nbsp;questions&nbsp;is&nbsp;shown&nbsp;below:&nbsp;</P>
<P>&nbsp;&nbsp;1.&nbsp;What&nbsp;types&nbsp;of&nbsp;computers&nbsp;do&nbsp;you&nbsp;have&nbsp;in&nbsp;your&nbsp;company?<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.&nbsp;Servers<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.&nbsp;Workstations<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.&nbsp;Laptops<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D.&nbsp;Mainframes</P>
<P>From&nbsp;this&nbsp;you&nbsp;can&nbsp;see&nbsp;that&nbsp;the&nbsp;user&nbsp;may&nbsp;choose&nbsp;to&nbsp;select&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;or&nbsp;all&nbsp;4&nbsp;of&nbsp;the&nbsp;answers.&nbsp;Not&nbsp;a&nbsp;problem,&nbsp;but&nbsp;the&nbsp;developers&nbsp;decided&nbsp;that&nbsp;the&nbsp;easiest&nbsp;way&nbsp;to&nbsp;store&nbsp;this&nbsp;information&nbsp;was&nbsp;in&nbsp;a&nbsp;table&nbsp;like&nbsp;this:</P>
<P><BR>&nbsp;&nbsp;&nbsp;UserID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Answer<BR>&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------<BR>&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,B,C<BR>&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B,C<BR>&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,C,D<BR>&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D</P>
<P>So&nbsp;why&nbsp;is&nbsp;this&nbsp;a&nbsp;problem?&nbsp;Well,&nbsp;how&nbsp;would&nbsp;you&nbsp;find&nbsp;all&nbsp;the&nbsp;people&nbsp;that&nbsp;answered&nbsp;"A"?&nbsp;This&nbsp;one&nbsp;is&nbsp;easy,&nbsp;you&nbsp;would&nbsp;select&nbsp;all&nbsp;users&nbsp;like&nbsp;this:</P>
<P><BR>&nbsp;&nbsp;select&nbsp;UserID,&nbsp;answer&nbsp;from&nbsp;Answer&nbsp;where&nbsp;Answer&nbsp;like&nbsp;''%A%''</P>
<P>No&nbsp;problem.&nbsp;Well,&nbsp;what&nbsp;about&nbsp;all&nbsp;people&nbsp;that&nbsp;answered&nbsp;"B"&nbsp;and&nbsp;"C"?&nbsp;This&nbsp;one&nbsp;is&nbsp;tougher;&nbsp;you&nbsp;could&nbsp;try</P>
<P><BR>&nbsp;&nbsp;&nbsp;select&nbsp;UserID,&nbsp;answer&nbsp;from&nbsp;Answer&nbsp;where&nbsp;Answer&nbsp;like&nbsp;''%B%''&nbsp;and&nbsp;''%C%''</P>
<P>It&nbsp;does&nbsp;not&nbsp;work.&nbsp;I&nbsp;want&nbsp;to&nbsp;get&nbsp;this&nbsp;result&nbsp;set:</P>
<P><BR>&nbsp;&nbsp;&nbsp;UserID&nbsp;&nbsp;&nbsp;&nbsp;Answer<BR>&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;&nbsp;-------<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,B,C<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B,C<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,C,D</P>
<P>What&nbsp;you&nbsp;end&nbsp;up&nbsp;with&nbsp;is&nbsp;a&nbsp;result&nbsp;that&nbsp;looks&nbsp;like&nbsp;this:</P>
<P>&nbsp;&nbsp;&nbsp;UserID&nbsp;&nbsp;&nbsp;&nbsp;Answer<BR>&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;&nbsp;-------<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,B,C</P>
<P><BR>In&nbsp;order&nbsp;to&nbsp;get&nbsp;the&nbsp;result&nbsp;set&nbsp;I&nbsp;want,&nbsp;what&nbsp;I&nbsp;would&nbsp;have&nbsp;to&nbsp;do&nbsp;is&nbsp;union&nbsp;multiple&nbsp;queries.&nbsp;This&nbsp;really&nbsp;does&nbsp;not&nbsp;scale&nbsp;and&nbsp;as&nbsp;the&nbsp;number&nbsp;of&nbsp;answers&nbsp;grows&nbsp;(&nbsp;our&nbsp;biggest&nbsp;had&nbsp;12&nbsp;answers)&nbsp;the&nbsp;queries&nbsp;become&nbsp;increasingly&nbsp;complex.&nbsp;</P>
<P>The&nbsp;Solution<BR>The&nbsp;solution&nbsp;in&nbsp;this&nbsp;case&nbsp;was&nbsp;to&nbsp;"bend"&nbsp;that&nbsp;data&nbsp;so&nbsp;that&nbsp;it&nbsp;is&nbsp;in&nbsp;a&nbsp;more&nbsp;normal&nbsp;form.&nbsp;What&nbsp;I&nbsp;mean&nbsp;by&nbsp;this&nbsp;is&nbsp;to&nbsp;take&nbsp;the&nbsp;table&nbsp;above&nbsp;and&nbsp;change&nbsp;it&nbsp;to&nbsp;look&nbsp;like&nbsp;this:&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;UserID&nbsp;&nbsp;&nbsp;&nbsp;Answer<BR>&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;&nbsp;------<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D</P>
<P>With&nbsp;the&nbsp;data&nbsp;in&nbsp;this&nbsp;form,&nbsp;we&nbsp;can&nbsp;more&nbsp;easily&nbsp;build&nbsp;a&nbsp;scalable&nbsp;and&nbsp;self-maintaining&nbsp;solution&nbsp;that&nbsp;will&nbsp;grow&nbsp;and&nbsp;handle&nbsp;new&nbsp;questions&nbsp;and&nbsp;answers&nbsp;with&nbsp;minimal&nbsp;work&nbsp;from&nbsp;the&nbsp;development&nbsp;staff&nbsp;and&nbsp;(more&nbsp;importantly)&nbsp;the&nbsp;DBA.&nbsp;</P>
<P>The&nbsp;Code<BR>The&nbsp;objects&nbsp;involved&nbsp;are&nbsp;given&nbsp;below.&nbsp;Since&nbsp;this&nbsp;was&nbsp;corporate&nbsp;code,&nbsp;I&nbsp;have&nbsp;altered&nbsp;names&nbsp;and&nbsp;schemas&nbsp;slightly&nbsp;to&nbsp;protect&nbsp;my&nbsp;company.&nbsp;Other&nbsp;than&nbsp;name&nbsp;changes&nbsp;and&nbsp;some&nbsp;missing&nbsp;fields&nbsp;for&nbsp;other&nbsp;data,&nbsp;this&nbsp;is&nbsp;the&nbsp;same&nbsp;code&nbsp;in&nbsp;our&nbsp;database.&nbsp;</P>
<P>Answer&nbsp;-&nbsp;Table&nbsp;that&nbsp;holds&nbsp;the&nbsp;original&nbsp;data&nbsp;<BR>NewAnswer&nbsp;-&nbsp;Table&nbsp;that&nbsp;holds&nbsp;the&nbsp;new&nbsp;data&nbsp;<BR>dbspBendAnswers&nbsp;-&nbsp;stored&nbsp;procedure&nbsp;that&nbsp;"bends"&nbsp;the&nbsp;data&nbsp;in&nbsp;the&nbsp;Answer&nbsp;table.&nbsp;</P>
<P>In&nbsp;order&nbsp;to&nbsp;extract&nbsp;each&nbsp;answer&nbsp;out&nbsp;and&nbsp;place&nbsp;it&nbsp;in&nbsp;a&nbsp;separate&nbsp;row,&nbsp;I&nbsp;decided&nbsp;to&nbsp;row&nbsp;process&nbsp;this&nbsp;data&nbsp;one&nbsp;row&nbsp;at&nbsp;a&nbsp;time&nbsp;rather&nbsp;than&nbsp;develop&nbsp;a&nbsp;set&nbsp;oriented&nbsp;solution.&nbsp;I&nbsp;normally&nbsp;frown&nbsp;upon&nbsp;this&nbsp;type&nbsp;of&nbsp;code,&nbsp;but&nbsp;this&nbsp;needed&nbsp;to&nbsp;be&nbsp;done&nbsp;quickly&nbsp;and&nbsp;was&nbsp;a&nbsp;one-time&nbsp;maintenance&nbsp;operation&nbsp;with&nbsp;a&nbsp;piece&nbsp;of&nbsp;code&nbsp;that&nbsp;I&nbsp;would&nbsp;have&nbsp;thrown&nbsp;away&nbsp;(if&nbsp;I&nbsp;was&nbsp;not&nbsp;writing&nbsp;this&nbsp;article).&nbsp;</P>
<P>To&nbsp;process&nbsp;this&nbsp;data,&nbsp;I&nbsp;built&nbsp;a&nbsp;cursor&nbsp;of&nbsp;the&nbsp;primary&nbsp;key&nbsp;from&nbsp;this&nbsp;table&nbsp;which&nbsp;was&nbsp;the&nbsp;userID&nbsp;field&nbsp;and&nbsp;the&nbsp;questionID&nbsp;field.&nbsp;I&nbsp;then&nbsp;looped&nbsp;through&nbsp;this&nbsp;cursor&nbsp;and&nbsp;processed&nbsp;each&nbsp;row''s&nbsp;answer&nbsp;data.&nbsp;The&nbsp;processing&nbsp;of&nbsp;each&nbsp;row&nbsp;was&nbsp;where&nbsp;the&nbsp;string&nbsp;manipulation&nbsp;came&nbsp;in.&nbsp;</P>
<P>Each&nbsp;row&nbsp;can&nbsp;be&nbsp;formatted&nbsp;as&nbsp;a&nbsp;pattern&nbsp;that&nbsp;looks&nbsp;like&nbsp;this:</P>
<P><BR>&nbsp;&nbsp;&nbsp;"x,y,z,...,n"</P>
<P>where&nbsp;x&nbsp;is&nbsp;a&nbsp;single&nbsp;answer&nbsp;and&nbsp;the&nbsp;number&nbsp;of&nbsp;answers&nbsp;in&nbsp;this&nbsp;field&nbsp;is&nbsp;unknown.&nbsp;However,&nbsp;each&nbsp;field&nbsp;can&nbsp;also&nbsp;be&nbsp;written&nbsp;in&nbsp;the&nbsp;following&nbsp;manner.</P>
<P>&nbsp;&nbsp;"x"&nbsp;+&nbsp;",y"&nbsp;+&nbsp;",z"&nbsp;+&nbsp;",..."&nbsp;+&nbsp;",n"</P>
<P>In&nbsp;this&nbsp;format,&nbsp;an&nbsp;algorithm&nbsp;starts&nbsp;to&nbsp;become&nbsp;apparent.&nbsp;If&nbsp;I&nbsp;can&nbsp;delimit&nbsp;each&nbsp;answer&nbsp;by&nbsp;looking&nbsp;at&nbsp;the&nbsp;commas,&nbsp;then&nbsp;what&nbsp;I&nbsp;need&nbsp;to&nbsp;do&nbsp;is&nbsp;parse&nbsp;this&nbsp;string&nbsp;by&nbsp;finding&nbsp;the&nbsp;location&nbsp;of&nbsp;the&nbsp;commas.&nbsp;Once&nbsp;I&nbsp;do&nbsp;this,&nbsp;then&nbsp;the&nbsp;SUBSTRING&nbsp;function&nbsp;can&nbsp;easily&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;the&nbsp;answers&nbsp;that&nbsp;are&nbsp;between&nbsp;the&nbsp;commas.&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;comma&nbsp;in&nbsp;the&nbsp;string,&nbsp;then&nbsp;the&nbsp;assumption&nbsp;is&nbsp;that&nbsp;this&nbsp;is&nbsp;a&nbsp;single&nbsp;answer,&nbsp;so&nbsp;we&nbsp;insert&nbsp;the&nbsp;entire&nbsp;string&nbsp;as&nbsp;a&nbsp;new&nbsp;answer&nbsp;and&nbsp;loop&nbsp;to&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data.&nbsp;</P>
<P>In&nbsp;my&nbsp;haste&nbsp;to&nbsp;build&nbsp;this,&nbsp;I&nbsp;decided&nbsp;that&nbsp;I&nbsp;would&nbsp;use&nbsp;the&nbsp;charindex&nbsp;function&nbsp;to&nbsp;find&nbsp;commas&nbsp;and&nbsp;then&nbsp;process&nbsp;the&nbsp;string&nbsp;based&nbsp;on&nbsp;the&nbsp;commas.&nbsp;charindex&nbsp;allows&nbsp;you&nbsp;to&nbsp;find&nbsp;the&nbsp;numeric&nbsp;location&nbsp;in&nbsp;a&nbsp;string&nbsp;of&nbsp;another&nbsp;string.&nbsp;In&nbsp;other&nbsp;words,&nbsp;it&nbsp;returns&nbsp;the&nbsp;position&nbsp;in&nbsp;any&nbsp;string&nbsp;of&nbsp;some&nbsp;character&nbsp;that&nbsp;you&nbsp;are&nbsp;looking&nbsp;for&nbsp;(in&nbsp;my&nbsp;case,&nbsp;commas).&nbsp;So&nbsp;if&nbsp;I&nbsp;had&nbsp;the&nbsp;following&nbsp;string:</P>
<P><BR>&nbsp;&nbsp;&nbsp;''A,B,C''</P>
<P>I&nbsp;could&nbsp;run&nbsp;the&nbsp;following&nbsp;code:</P>
<P>&nbsp;&nbsp;&nbsp;select&nbsp;charindex(&nbsp;'','',&nbsp;''A,B,C'')</P>
<P>and&nbsp;get&nbsp;these&nbsp;results:</P>
<P>&nbsp;&nbsp;&nbsp;------<BR>&nbsp;&nbsp;&nbsp;2</P>
<P>Where&nbsp;2&nbsp;is&nbsp;the&nbsp;position&nbsp;(2nd&nbsp;character)&nbsp;in&nbsp;the&nbsp;string&nbsp;of&nbsp;the&nbsp;comma.&nbsp;One&nbsp;thing&nbsp;to&nbsp;be&nbsp;aware&nbsp;of&nbsp;is&nbsp;that&nbsp;only&nbsp;the&nbsp;first&nbsp;occurance&nbsp;of&nbsp;the&nbsp;string&nbsp;is&nbsp;found.&nbsp;So&nbsp;now&nbsp;I&nbsp;have&nbsp;the&nbsp;location&nbsp;of&nbsp;the&nbsp;first&nbsp;comma.&nbsp;If&nbsp;I&nbsp;include&nbsp;this&nbsp;in&nbsp;a&nbsp;SUBSTRING&nbsp;statement&nbsp;that&nbsp;starts&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;string,&nbsp;I&nbsp;can&nbsp;extract&nbsp;the&nbsp;first&nbsp;answer.</P>
<P>&nbsp;&nbsp;&nbsp;answer<BR>&nbsp;&nbsp;&nbsp;------<BR>&nbsp;&nbsp;&nbsp;A,B,C<BR>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@c&nbsp;=&nbsp;charindex('','',&nbsp;answer)<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@a&nbsp;=&nbsp;substring(&nbsp;answer,&nbsp;1,&nbsp;@comma&nbsp;-&nbsp;1)<BR>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@a<BR>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;-------<BR>&nbsp;&nbsp;&nbsp;A<BR>&nbsp;&nbsp;&nbsp;</P>
<P>Now&nbsp;I&nbsp;have&nbsp;a&nbsp;single&nbsp;answer,&nbsp;how&nbsp;does&nbsp;this&nbsp;help&nbsp;me&nbsp;get&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;answers?&nbsp;In&nbsp;my&nbsp;algorithm&nbsp;I&nbsp;have&nbsp;stord&nbsp;the&nbsp;location&nbsp;of&nbsp;the&nbsp;first&nbsp;comma&nbsp;off.&nbsp;What&nbsp;I&nbsp;now&nbsp;do&nbsp;is&nbsp;remove&nbsp;both&nbsp;the&nbsp;first&nbsp;answer&nbsp;and&nbsp;the&nbsp;first&nbsp;comma&nbsp;from&nbsp;the&nbsp;string.&nbsp;This&nbsp;would&nbsp;result&nbsp;in&nbsp;this&nbsp;code&nbsp;and&nbsp;result:</P>
<P>&nbsp;&nbsp;&nbsp;select&nbsp;@str&nbsp;=&nbsp;substring(&nbsp;@str,&nbsp;@comma&nbsp;+&nbsp;1,&nbsp;len(&nbsp;@str))<BR>&nbsp;&nbsp;&nbsp;select&nbsp;@str<BR>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;------<BR>&nbsp;&nbsp;&nbsp;B,C</P>
<P>Now&nbsp;I&nbsp;repeat&nbsp;the&nbsp;process&nbsp;and&nbsp;find&nbsp;the&nbsp;next&nbsp;comma.&nbsp;Again,&nbsp;if&nbsp;I&nbsp;get&nbsp;a&nbsp;zero&nbsp;(0)&nbsp;back&nbsp;for&nbsp;the&nbsp;location&nbsp;of&nbsp;the&nbsp;comma,&nbsp;I&nbsp;know&nbsp;I&nbsp;have&nbsp;a&nbsp;single&nbsp;answer&nbsp;left,&nbsp;insert&nbsp;it&nbsp;and&nbsp;end&nbsp;the&nbsp;loop.&nbsp;I&nbsp;check&nbsp;with&nbsp;an&nbsp;IF&nbsp;statement&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;comma&nbsp;since&nbsp;passing&nbsp;a&nbsp;-1&nbsp;to&nbsp;the&nbsp;SUBSTRING&nbsp;function&nbsp;returns&nbsp;an&nbsp;error.</P>
<P>Conclusion&nbsp;<BR>This&nbsp;is&nbsp;probably&nbsp;not&nbsp;the&nbsp;most&nbsp;elegant&nbsp;or&nbsp;efficient&nbsp;solution,&nbsp;but&nbsp;it&nbsp;does&nbsp;work.&nbsp;And&nbsp;it&nbsp;was&nbsp;very&nbsp;quick&nbsp;to&nbsp;develop.&nbsp;In&nbsp;fact,&nbsp;it&nbsp;took&nbsp;three&nbsp;or&nbsp;four&nbsp;times&nbsp;as&nbsp;long&nbsp;to&nbsp;write&nbsp;this&nbsp;article&nbsp;as&nbsp;it&nbsp;did&nbsp;to&nbsp;develop&nbsp;the&nbsp;algorithm,&nbsp;test&nbsp;it,&nbsp;and&nbsp;execute&nbsp;it&nbsp;on&nbsp;my&nbsp;data.&nbsp;I&nbsp;do&nbsp;think,&nbsp;however,&nbsp;that&nbsp;this&nbsp;technique&nbsp;will&nbsp;be&nbsp;useful&nbsp;in&nbsp;some&nbsp;situations&nbsp;and&nbsp;is&nbsp;a&nbsp;worthwhile&nbsp;addition&nbsp;to&nbsp;the&nbsp;DBA&nbsp;toolbox.&nbsp;I&nbsp;find&nbsp;many&nbsp;times&nbsp;when&nbsp;I&nbsp;need&nbsp;string&nbsp;manipulation,&nbsp;especially&nbsp;in&nbsp;adhoc&nbsp;queries&nbsp;I&nbsp;write.&nbsp;Like&nbsp;any&nbsp;other&nbsp;tool&nbsp;in&nbsp;SQL&nbsp;Server,&nbsp;it&nbsp;has&nbsp;a&nbsp;time&nbsp;and&nbsp;a&nbsp;place&nbsp;where&nbsp;it&nbsp;is&nbsp;helpful&nbsp;and&nbsp;effective&nbsp;in&nbsp;its&nbsp;application.&nbsp;Spend&nbsp;some&nbsp;time&nbsp;experimenting&nbsp;and&nbsp;learning&nbsp;about&nbsp;the&nbsp;CHARINDEX()&nbsp;function.&nbsp;It&nbsp;will&nbsp;probably&nbsp;come&nbsp;in&nbsp;handy&nbsp;at&nbsp;some&nbsp;point.&nbsp;</P>
<P>Here&nbsp;is&nbsp;the&nbsp;online&nbsp;reference&nbsp;for&nbsp;CHARINDEX&nbsp;for&nbsp;those&nbsp;of&nbsp;you&nbsp;interested.&nbsp;</P>
<P>As&nbsp;always,&nbsp;I&nbsp;welcome&nbsp;feedback&nbsp;and&nbsp;comments&nbsp;and&nbsp;hope&nbsp;that&nbsp;you&nbsp;learned&nbsp;something&nbsp;from&nbsp;this&nbsp;article.&nbsp;</P>
<P>Steve&nbsp;Jones<BR>?000&nbsp;dkranch&nbsp;</P>
<P></P>
<P><BR></P></FONT>