<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Converting&nbsp;Multiple&nbsp;Rows&nbsp;into&nbsp;a&nbsp;CSV&nbsp;String</B><BR>Based&nbsp;the&nbsp;problem&nbsp;outlined&nbsp;in&nbsp;RocketScientist's&nbsp;article&nbsp;(entitled&nbsp;Converting&nbsp;Multiple&nbsp;Rows&nbsp;into&nbsp;a&nbsp;CSV&nbsp;String),&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;present&nbsp;an&nbsp;alternative&nbsp;method&nbsp;for&nbsp;accomplishing&nbsp;a&nbsp;similar&nbsp;task.&nbsp;This&nbsp;article&nbsp;will&nbsp;show&nbsp;a&nbsp;faster&nbsp;method&nbsp;to&nbsp;convert&nbsp;multiple&nbsp;rows&nbsp;into&nbsp;multiple&nbsp;CSV&nbsp;strings.&nbsp;
<P></P>
<P>--------------------------------------------------------------------------------<BR>Say&nbsp;you&nbsp;had&nbsp;a&nbsp;table&nbsp;with&nbsp;a&nbsp;composite&nbsp;key,&nbsp;and&nbsp;you&nbsp;wanted&nbsp;to&nbsp;return&nbsp;each&nbsp;distinct&nbsp;first&nbsp;member&nbsp;and&nbsp;a&nbsp;CSV&nbsp;list&nbsp;of&nbsp;all&nbsp;the&nbsp;applicable&nbsp;second&nbsp;members.&nbsp;Using&nbsp;the&nbsp;approach&nbsp;outlined&nbsp;by&nbsp;RocketScientist,&nbsp;you&nbsp;would&nbsp;have&nbsp;to&nbsp;iterate&nbsp;through&nbsp;each&nbsp;distinct&nbsp;first&nbsp;member&nbsp;and&nbsp;run&nbsp;the&nbsp;sp_MakeCharList&nbsp;proc&nbsp;N&nbsp;times.&nbsp;I&nbsp;think&nbsp;there&nbsp;is&nbsp;a&nbsp;better&nbsp;way.&nbsp;<BR>First,&nbsp;the&nbsp;DDL&nbsp;and&nbsp;sample&nbsp;data:&nbsp;</P>
<P>create&nbsp;table&nbsp;Page47&nbsp;(<BR>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;int&nbsp;not&nbsp;null,<BR>&nbsp;&nbsp;&nbsp;&nbsp;vc&nbsp;varchar(5)&nbsp;not&nbsp;null,<BR>&nbsp;&nbsp;&nbsp;&nbsp;constraint&nbsp;pk_Page47&nbsp;primary&nbsp;key&nbsp;(i,vc)&nbsp;)<BR>go</P>
<P><BR>set&nbsp;nocount&nbsp;on<BR>declare&nbsp;@i&nbsp;int<BR>select&nbsp;&nbsp;@i&nbsp;=&nbsp;0<BR>while&nbsp;@i&nbsp;&lt;5000<BR>begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;into&nbsp;Page47&nbsp;(i,vc)<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;round((rand()&nbsp;*&nbsp;100),&nbsp;0),<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(round((rand()&nbsp;*&nbsp;25),&nbsp;0)&nbsp;+&nbsp;97)&nbsp;+<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(round((rand()&nbsp;*&nbsp;25),&nbsp;0)&nbsp;+&nbsp;97)&nbsp;+<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(round((rand()&nbsp;*&nbsp;25),&nbsp;0)&nbsp;+&nbsp;97)&nbsp;+<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(round((rand()&nbsp;*&nbsp;25),&nbsp;0)&nbsp;+&nbsp;97)&nbsp;+<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char(round((rand()&nbsp;*&nbsp;25),&nbsp;0)&nbsp;+&nbsp;97)<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@i&nbsp;=&nbsp;@i&nbsp;+&nbsp;1<BR>end<BR>go<BR>The&nbsp;sample&nbsp;data&nbsp;should&nbsp;look&nbsp;something&nbsp;like&nbsp;this:&nbsp;</P>
<P>select&nbsp;top&nbsp;10<BR>&nbsp;&nbsp;&nbsp;&nbsp;i,<BR>&nbsp;&nbsp;&nbsp;&nbsp;vc<BR>from<BR>&nbsp;&nbsp;&nbsp;&nbsp;Page47<BR>order&nbsp;by<BR>&nbsp;&nbsp;&nbsp;&nbsp;newid()</P>
<P>i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vc&nbsp;&nbsp;&nbsp;&nbsp;<BR>-----------&nbsp;-----&nbsp;<BR>743&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nndsn<BR>267&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;krtub<BR>582&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgrrg<BR>185&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qmcku<BR>907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rrpqe<BR>635&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpbcp<BR>237&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uovqh<BR>85&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bpixy<BR>554&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mfsqh<BR>49&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geabv</P>
<P>(10&nbsp;row(s)&nbsp;affected)<BR>First,&nbsp;lets&nbsp;look&nbsp;at&nbsp;adapting&nbsp;RocketScientists&nbsp;solution&nbsp;to&nbsp;this&nbsp;problem.&nbsp;Here&nbsp;is&nbsp;how&nbsp;you&nbsp;might&nbsp;iterate&nbsp;through&nbsp;the&nbsp;table&nbsp;to&nbsp;build&nbsp;all&nbsp;of&nbsp;the&nbsp;CSVs&nbsp;</P>
<P>--create&nbsp;a&nbsp;temp&nbsp;table<BR>select<BR>&nbsp;&nbsp;&nbsp;&nbsp;identity(int,1,1)&nbsp;as&nbsp;rowid,<BR>&nbsp;&nbsp;&nbsp;&nbsp;i<BR>into<BR>&nbsp;&nbsp;&nbsp;&nbsp;#workingtable<BR>from<BR>&nbsp;&nbsp;&nbsp;&nbsp;Page47<BR>group&nbsp;by<BR>&nbsp;&nbsp;&nbsp;&nbsp;i</P>
<P>--create&nbsp;a&nbsp;table&nbsp;to&nbsp;hold&nbsp;the&nbsp;lists<BR>create&nbsp;table&nbsp;#Rocket&nbsp;(<BR>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;int&nbsp;not&nbsp;null&nbsp;primary&nbsp;key,<BR>&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;varchar(8000)&nbsp;not&nbsp;null)</P>
<P>declare<BR>&nbsp;&nbsp;&nbsp;&nbsp;@i&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@maxrowid&nbsp;int,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@sql&nbsp;varchar(8000),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@list&nbsp;varchar(8000)</P>
<P>select<BR>&nbsp;&nbsp;&nbsp;&nbsp;@maxrowid&nbsp;=&nbsp;max(rowid),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@i&nbsp;=&nbsp;0<BR>from<BR>&nbsp;&nbsp;&nbsp;&nbsp;#workingtable</P>
<P>--loop&nbsp;through&nbsp;the&nbsp;all&nbsp;the&nbsp;i's<BR>while&nbsp;@i&nbsp;&lt;=&nbsp;@maxrowid<BR>begin</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;select<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sql&nbsp;=&nbsp;'select&nbsp;vc&nbsp;from&nbsp;Page47&nbsp;where&nbsp;i&nbsp;=&nbsp;'&nbsp;+&nbsp;convert(varchar,i)<BR>&nbsp;&nbsp;&nbsp;&nbsp;from<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#workingtable<BR>&nbsp;&nbsp;&nbsp;&nbsp;where<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rowid&nbsp;=&nbsp;@i</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;sp_MakeCharList<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@codelistselect=@sql,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@delimitedlist=@list&nbsp;output</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;into&nbsp;#rocket&nbsp;(i,list)<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;i,&nbsp;@list<BR>&nbsp;&nbsp;&nbsp;&nbsp;from<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#workingtable<BR>&nbsp;&nbsp;&nbsp;&nbsp;where<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rowid&nbsp;=&nbsp;@i&nbsp;and<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@list&nbsp;is&nbsp;not&nbsp;null<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@i&nbsp;=&nbsp;@i&nbsp;+&nbsp;1<BR>end</P>
<P>--return&nbsp;a&nbsp;sample&nbsp;from&nbsp;the&nbsp;final&nbsp;rowset<BR>select&nbsp;top&nbsp;10<BR>&nbsp;&nbsp;&nbsp;&nbsp;i,<BR>&nbsp;&nbsp;&nbsp;&nbsp;case<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;len(list)&nbsp;&gt;&nbsp;50&nbsp;then&nbsp;convert(varchar(50),&nbsp;left(list,47)&nbsp;+&nbsp;'...')<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;convert(varchar(50),list)<BR>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;as&nbsp;list<BR>from<BR>&nbsp;&nbsp;&nbsp;&nbsp;#rocket<BR>order&nbsp;by<BR>&nbsp;&nbsp;&nbsp;&nbsp;newid()<BR>go</P>
<P>i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>-----------&nbsp;--------------------------------------------------&nbsp;<BR>790&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpflf,&nbsp;hjutq,&nbsp;inahr,&nbsp;kgkox,&nbsp;kroox,&nbsp;nbkiy,&nbsp;rsscw...<BR>752&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imokv,&nbsp;jcrgz,&nbsp;khsui,&nbsp;lbmwm,&nbsp;pkjee,&nbsp;ujxoi,&nbsp;ulgsm...<BR>74&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aphdr,&nbsp;cdmoc,&nbsp;fogdm,&nbsp;gslsg,&nbsp;hushk,&nbsp;icchc,&nbsp;lybud...<BR>320&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bvevh,&nbsp;ohyqv,&nbsp;oivyc,&nbsp;yevjb,&nbsp;ypnrk,&nbsp;yxfji<BR>956&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aisgk,&nbsp;emeup,&nbsp;fhtad,&nbsp;hffnm,&nbsp;iidpn,&nbsp;ivqlk,&nbsp;jhklu...<BR>530&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bqcjr,&nbsp;dnfzr,&nbsp;dqwas,&nbsp;egqpm,&nbsp;fplip,&nbsp;ibrxp,&nbsp;jcbhk...<BR>137&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aorpw,&nbsp;bngki,&nbsp;cibny,&nbsp;hwsrp,&nbsp;jdown,&nbsp;qlepc,&nbsp;zekbo,&nbsp;z<BR>72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ghrxi,&nbsp;gmkzk,&nbsp;mufmc,&nbsp;uixpr,&nbsp;vjvbu,&nbsp;ymruj,&nbsp;zmucr,&nbsp;z<BR>911&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fibrs,&nbsp;fuhub,&nbsp;hgcwh,&nbsp;kuvcf,&nbsp;lcfux,&nbsp;nrqht,&nbsp;pfaae...<BR>62&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edxyj,&nbsp;grrmt,&nbsp;hmkfv,&nbsp;hprlt,&nbsp;ieqvg,&nbsp;mojsk,&nbsp;pdrmv...<BR>Now,&nbsp;here&nbsp;is&nbsp;a&nbsp;set&nbsp;based&nbsp;method&nbsp;for&nbsp;doing&nbsp;the&nbsp;same&nbsp;thing.&nbsp;</P>
<P>--create&nbsp;a&nbsp;table&nbsp;to&nbsp;work&nbsp;with<BR>create&nbsp;table&nbsp;#workingtable&nbsp;(<BR>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;int&nbsp;not&nbsp;null,<BR>&nbsp;&nbsp;&nbsp;&nbsp;vc&nbsp;varchar(5)&nbsp;not&nbsp;null,<BR>&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;varchar(8000),<BR>&nbsp;&nbsp;&nbsp;&nbsp;constraint&nbsp;pk_wt&nbsp;primary&nbsp;key&nbsp;(i,vc)&nbsp;)</P>
<P>insert&nbsp;into&nbsp;#workingtable&nbsp;(i,vc)<BR>select&nbsp;i,vc<BR>from&nbsp;Page47<BR>order&nbsp;by&nbsp;i,vc</P>
<P>declare<BR>&nbsp;&nbsp;&nbsp;&nbsp;@list&nbsp;varchar(8000),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@lasti&nbsp;int</P>
<P>select<BR>&nbsp;&nbsp;&nbsp;&nbsp;@list&nbsp;=&nbsp;'',<BR>&nbsp;&nbsp;&nbsp;&nbsp;@lasti&nbsp;=&nbsp;-1</P>
<P>--here&nbsp;is&nbsp;the&nbsp;meat&nbsp;of&nbsp;the&nbsp;work<BR>update<BR>&nbsp;&nbsp;&nbsp;&nbsp;#workingtable<BR>set<BR>&nbsp;&nbsp;&nbsp;&nbsp;@list&nbsp;=&nbsp;list&nbsp;=&nbsp;case<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;@lasti&nbsp;&lt;&gt;&nbsp;i&nbsp;then&nbsp;vc<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;@list&nbsp;+&nbsp;',&nbsp;'&nbsp;+&nbsp;vc<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@lasti&nbsp;=&nbsp;i</P>
<P>--return&nbsp;a&nbsp;sample&nbsp;from&nbsp;the&nbsp;final&nbsp;rowset<BR>select&nbsp;top&nbsp;10<BR>&nbsp;&nbsp;&nbsp;&nbsp;i,<BR>&nbsp;&nbsp;&nbsp;&nbsp;case<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;len(max(list))&nbsp;&gt;&nbsp;50&nbsp;then&nbsp;convert(varchar(50),&nbsp;left(max(list),47)&nbsp;+&nbsp;'...')<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;convert(varchar(50),max(list))<BR>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;as&nbsp;list<BR>from<BR>&nbsp;&nbsp;&nbsp;&nbsp;#workingtable<BR>group&nbsp;by<BR>&nbsp;&nbsp;&nbsp;&nbsp;i<BR>order&nbsp;by<BR>&nbsp;&nbsp;&nbsp;&nbsp;newid()<BR>go</P>
<P>i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>-----------&nbsp;--------------------------------------------------&nbsp;<BR>127&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itvgq,&nbsp;ljosw,&nbsp;nxmdj,&nbsp;oshrp,&nbsp;plxff,&nbsp;pubig,&nbsp;sthck...<BR>849&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gcifo,&nbsp;hbxkf,&nbsp;njkdl,&nbsp;sfesm,&nbsp;sjhky,&nbsp;uxhfq,&nbsp;vjeno...<BR>684&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fejly,&nbsp;fqyqf,&nbsp;gpfce,&nbsp;hutht,&nbsp;kwywo,&nbsp;mapco,&nbsp;momqn...<BR>461&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fsofv,&nbsp;fzked,&nbsp;murat,&nbsp;vzmek,&nbsp;yrqjo<BR>612&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nmmey,&nbsp;tfjhv,&nbsp;ulwuj,&nbsp;xxaaq<BR>374&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bbthd,&nbsp;jvjwz,&nbsp;klcsq,&nbsp;mrakf,&nbsp;peztf,&nbsp;pixww,&nbsp;rtwdd<BR>730&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dlynf,&nbsp;egqei,&nbsp;hhckx,&nbsp;nsvdn,&nbsp;obnhh,&nbsp;rfbwh,&nbsp;ytgfi<BR>458&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eijdr,&nbsp;gtxhu,&nbsp;lhtqh,&nbsp;phprf,&nbsp;qjhcr,&nbsp;vqnos<BR>655&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bijer,&nbsp;fwlgk,&nbsp;nrcbm,&nbsp;sohho,&nbsp;trjtw,&nbsp;usjdj,&nbsp;uvpie...<BR>837&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ayxcv,&nbsp;epurf,&nbsp;flvtj,&nbsp;ftxcj,&nbsp;imjap,&nbsp;pmygd,&nbsp;sqhcc...<BR>My&nbsp;tests&nbsp;show&nbsp;the&nbsp;iterative&nbsp;method&nbsp;taking&nbsp;2.813&nbsp;seconds&nbsp;and&nbsp;the&nbsp;set-based&nbsp;method&nbsp;taking&nbsp;0.670&nbsp;seconds,&nbsp;with&nbsp;this&nbsp;set&nbsp;of&nbsp;sample&nbsp;data.&nbsp;Increasing&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;shows&nbsp;the&nbsp;cursor&nbsp;solution&nbsp;creeping&nbsp;up&nbsp;on&nbsp;the&nbsp;set&nbsp;based&nbsp;solution;&nbsp;however,&nbsp;increasing&nbsp;the&nbsp;number&nbsp;of&nbsp;distinct&nbsp;i’s&nbsp;allowed&nbsp;show&nbsp;the&nbsp;performance&nbsp;of&nbsp;the&nbsp;cursor&nbsp;sharply&nbsp;declining.&nbsp;With&nbsp;1000&nbsp;distinct&nbsp;i’s,&nbsp;the&nbsp;cursor&nbsp;solution&nbsp;dropped&nbsp;to&nbsp;89.420&nbsp;seconds&nbsp;while&nbsp;the&nbsp;set&nbsp;based&nbsp;solution&nbsp;screamed&nbsp;at&nbsp;a&nbsp;1.513&nbsp;seconds.&nbsp;As&nbsp;you&nbsp;can&nbsp;see,&nbsp;the&nbsp;implementation&nbsp;choice&nbsp;will&nbsp;be&nbsp;dependent&nbsp;on&nbsp;your&nbsp;data&nbsp;set,&nbsp;so&nbsp;you&nbsp;should&nbsp;test&nbsp;both&nbsp;methods&nbsp;to&nbsp;find&nbsp;which&nbsp;is&nbsp;right&nbsp;for&nbsp;you.&nbsp;</P>
<P>&nbsp;<BR></P></FONT>