<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Stored&nbsp;Procedure&nbsp;NetSend</B><BR>Stored&nbsp;Procedure&nbsp;NetSend
<P></P>
<P></P>
<P><BR>&gt;&gt;Script&nbsp;Language&nbsp;and&nbsp;Platform:&nbsp;MS&nbsp;SQL&nbsp;7.0&nbsp;and&nbsp;MS&nbsp;SQL&nbsp;2000<BR>This&nbsp;stored&nbsp;procedure&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;database&nbsp;administrators&nbsp;to&nbsp;inform&nbsp;users&nbsp;before&nbsp;breaking&nbsp;the&nbsp;user's&nbsp;conenction&nbsp;to&nbsp;the&nbsp;database&nbsp;prior&nbsp;to&nbsp;doing&nbsp;a&nbsp;restore&nbsp;or&nbsp;upgrade.&nbsp;Previously,&nbsp;users&nbsp;were&nbsp;notified&nbsp;by&nbsp;individual&nbsp;email&nbsp;or&nbsp;a&nbsp;phone&nbsp;call.&nbsp;Now,&nbsp;using&nbsp;this&nbsp;single&nbsp;command,&nbsp;every&nbsp;user&nbsp;working&nbsp;on&nbsp;the&nbsp;database&nbsp;can&nbsp;receive&nbsp;important&nbsp;messages&nbsp;from&nbsp;the&nbsp;database&nbsp;administrator&nbsp;in&nbsp;one&nbsp;second.&nbsp;</P>
<P>Author:&nbsp;Claire&nbsp;Hsu&nbsp;<BR>Create&nbsp;procedure&nbsp;netsend&nbsp;@dbname&nbsp;varchar(50)&nbsp;<BR>As</P>
<P>--Script&nbsp;Language&nbsp;and&nbsp;Platform:&nbsp;MS&nbsp;SQL&nbsp;7.0&nbsp;and&nbsp;MS&nbsp;SQL&nbsp;2000<BR>--Objecttive:&nbsp;Before&nbsp;restoreing,upgrading&nbsp;database,database&nbsp;administrator&nbsp;is&nbsp;responsible&nbsp;to&nbsp;<BR>--inform&nbsp;all&nbsp;the&nbsp;users&nbsp;in&nbsp;that&nbsp;database&nbsp;that&nbsp;they&nbsp;are&nbsp;going&nbsp;to&nbsp;be&nbsp;disconnected&nbsp;and&nbsp;remind&nbsp;<BR>--them&nbsp;to&nbsp;save&nbsp;their&nbsp;works.<BR>--exec&nbsp;netsend&nbsp;'xyz'--xyz&nbsp;is&nbsp;the&nbsp;database&nbsp;name<BR>--Created&nbsp;by&nbsp;:Claire&nbsp;Hsu&nbsp;&nbsp;2003/4/19<BR>--Email:messageclaire@yahoo.com</P>
<P><BR>create&nbsp;table&nbsp;table1000(msg&nbsp;varchar(500))<BR>insert&nbsp;into&nbsp;table1000<BR>select&nbsp;"net&nbsp;send&nbsp;"+ltrim(rtrim(y.hostname))+&nbsp;'&nbsp;"we&nbsp;will&nbsp;log&nbsp;you&nbsp;out&nbsp;in&nbsp;2&nbsp;min&nbsp;,please&nbsp;save&nbsp;your&nbsp;work"'&nbsp;from&nbsp;master.dbo.sysprocesses&nbsp;y,master.dbo.sysdatabases&nbsp;x<BR>where&nbsp;x.dbid&nbsp;=&nbsp;y.dbid&nbsp;and&nbsp;x.name&nbsp;=&nbsp;@dbname</P>
<P>declare&nbsp;@msgs&nbsp;varchar(500)<BR>declare&nbsp;cur1&nbsp;cursor&nbsp;for&nbsp;select&nbsp;msg&nbsp;from&nbsp;table1000<BR>open&nbsp;cur1<BR>fetch&nbsp;next&nbsp;from&nbsp;cur1&nbsp;into&nbsp;@msgs<BR>while&nbsp;@@fetch_status&nbsp;=&nbsp;0<BR>begin<BR>exec&nbsp;master.dbo.xp_cmdshell&nbsp;@msgs<BR>fetch&nbsp;next&nbsp;from&nbsp;cur1&nbsp;into&nbsp;@msgs<BR>end<BR>close&nbsp;cur1<BR>deallocate&nbsp;cur1<BR>drop&nbsp;table&nbsp;table1000</P>
<P></P>
<P>--Usage<BR>--exec&nbsp;netsend&nbsp;'xyz'</P></FONT>