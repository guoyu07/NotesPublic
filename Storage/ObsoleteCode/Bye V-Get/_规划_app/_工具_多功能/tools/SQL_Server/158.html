<meta http-equiv="content-type" content="text/html; charset=gb2312">&nbsp;<FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>join&nbsp;方式</B><BR>（1)&nbsp;cross&nbsp;join&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;参与select语句所有表的的所有行的笛卡尔乘积<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;au_lname&nbsp;,title<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;authors&nbsp;cross&nbsp;join&nbsp;&nbsp;titiles
<P></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outer&nbsp;&nbsp;join&nbsp;对参与join的两个表有主从之分，处理方式以主表的每条数据去match&nbsp;从属表的列，合乎条件的数据是我们所要的答案，不合乎条件的也是我们要的答案，只不过哪些从属表选取的列将被添上null。<BR>(2)&nbsp;left&nbsp;join&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;左边的为主表，右边为从属表<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a.cust_id&nbsp;,b.order_date,b.tot_ant<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;customer&nbsp;a&nbsp;left&nbsp;join&nbsp;sales&nbsp;b<BR>&nbsp;&nbsp;&nbsp;&nbsp;<B>&nbsp;on&nbsp;(a.cust_id&nbsp;=b.cust_id&nbsp;and&nbsp;b.order_date&gt;''1996/10/15'')</B><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可以写为<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a.cust_id,b.order_date,b.tot_ant<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;custom&nbsp;a&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;join&nbsp;(select&nbsp;*&nbsp;from&nbsp;sales&nbsp;where&nbsp;order_date&gt;''1996/10/15'')&nbsp;b<BR>&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;a.cust_id&nbsp;=b.cust_id&nbsp;&nbsp;&nbsp;<BR>(3)&nbsp;right&nbsp;join<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;左边的表为从属表，右边的表为主表<BR>(4)&nbsp;self&nbsp;join&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self&nbsp;join&nbsp;常用在同一表内不同数据间对同一列的比较<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a.emp_no,a.emp_name,b.emp_no,b.emp_name,a.date_hired<BR>&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;employee&nbsp;a<BR>&nbsp;&nbsp;&nbsp;&nbsp;join&nbsp;employee&nbsp;b<BR>&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;(a.emp_no!=b.emp_no&nbsp;and&nbsp;a.date_hired=b.date_hired)<BR>&nbsp;&nbsp;&nbsp;&nbsp;order&nbsp;by&nbsp;a.date_hired<BR>&nbsp;&nbsp;&nbsp;这样会重复数据，只要加上一句&nbsp;and&nbsp;a.emp_name&gt;b.emp_name<BR>(5)&nbsp;full&nbsp;join&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;不仅列出符合条件的数据，两边未符合join条件的数据也会一并列出。哪些未符合join条件的数据如果在select列中无法得到对应的值则填上null<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a.cust_id,b.tot_amt<BR>&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;customer&nbsp;a&nbsp;full&nbsp;join&nbsp;sales&nbsp;b<BR>&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;a.cust_id=b.cust_id<BR>有表<BR>&nbsp;id&nbsp;&nbsp;&nbsp;ic&nbsp;&nbsp;name&nbsp;&nbsp;amount<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;要求结果为&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;ic&nbsp;&nbsp;name&nbsp;&nbsp;amount&nbsp;&nbsp;ic&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;amount<BR>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c<BR>&nbsp;&nbsp;&nbsp;&nbsp;i<BR>&nbsp;&nbsp;&nbsp;&nbsp;i<BR>&nbsp;&nbsp;select&nbsp;aaa.*,bbb.*<BR>&nbsp;&nbsp;from&nbsp;(&nbsp;select&nbsp;(select&nbsp;count(id)&nbsp;from&nbsp;&nbsp;aa&nbsp;as&nbsp;&nbsp;b&nbsp;where&nbsp;(b.id&lt;a.id)&nbsp;and&nbsp;(ic=''i''))&nbsp;as&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newid,&nbsp;*&nbsp;from&nbsp;aa&nbsp;a&nbsp;where&nbsp;ic=''i'')&nbsp;aaa<BR>&nbsp;&nbsp;full&nbsp;join&nbsp;<BR>&nbsp;&nbsp;&nbsp;(select&nbsp;(select&nbsp;count(id)&nbsp;from&nbsp;aa&nbsp;as&nbsp;b&nbsp;where&nbsp;b.id&lt;a.id&nbsp;and&nbsp;ic=''c'')&nbsp;as&nbsp;newid,*&nbsp;from<BR>&nbsp;aa&nbsp;a&nbsp;where&nbsp;ic=''c'')&nbsp;bbb<BR>on&nbsp;aaa.newid=bbb.newid<BR>order&nbsp;by&nbsp;aaa.name<BR>6.使用&nbsp;HASH&nbsp;和&nbsp;MERGE&nbsp;联接提示<BR>此示例在&nbsp;authors、titleauthors&nbsp;和&nbsp;titles&nbsp;表之间建立三表联接，以生成一个作者及其著作的列表。查询优化器使用&nbsp;MERGE&nbsp;联接将&nbsp;authors&nbsp;和&nbsp;titleauthors&nbsp;(A&nbsp;x&nbsp;TA)&nbsp;联接在一起。然后，将&nbsp;authors&nbsp;和&nbsp;titleauthors&nbsp;MERGE&nbsp;联接&nbsp;(A&nbsp;x&nbsp;TA)&nbsp;的结果与&nbsp;titles&nbsp;表进行&nbsp;HASH&nbsp;联结以生成&nbsp;(A&nbsp;x&nbsp;TA)&nbsp;x&nbsp;T。</P>
<P></P>
<P>重要&nbsp;&nbsp;指定联接提示后，要执行&nbsp;INNER&nbsp;JOIN&nbsp;时&nbsp;INNER&nbsp;关键字不再为可选，而必须显式说明。</P>
<P><BR>USE&nbsp;pubs<BR>SELECT&nbsp;SUBSTRING((RTRIM(a.au_fname)&nbsp;+&nbsp;''&nbsp;''&nbsp;+&nbsp;LTRIM(a.au_lname)),&nbsp;1,&nbsp;25)<BR>&nbsp;&nbsp;&nbsp;AS&nbsp;Name,&nbsp;SUBSTRING(t.title,&nbsp;1,&nbsp;20)&nbsp;AS&nbsp;Title<BR>FROM&nbsp;authors&nbsp;a&nbsp;INNER&nbsp;MERGE&nbsp;JOIN&nbsp;titleauthor&nbsp;ta&nbsp;<BR>&nbsp;&nbsp;&nbsp;ON&nbsp;a.au_id&nbsp;=&nbsp;ta.au_id&nbsp;INNER&nbsp;HASH&nbsp;JOIN&nbsp;titles&nbsp;t&nbsp;<BR>&nbsp;&nbsp;&nbsp;ON&nbsp;t.title_id&nbsp;=&nbsp;ta.title_id<BR>ORDER&nbsp;BY&nbsp;au_lname&nbsp;ASC,&nbsp;au_fname&nbsp;ASC</P>
<P>下面是结果集：</P>
<P>Warning:&nbsp;The&nbsp;join&nbsp;order&nbsp;has&nbsp;been&nbsp;enforced&nbsp;because&nbsp;a&nbsp;local&nbsp;join&nbsp;hint&nbsp;is&nbsp;used.<BR>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>-------------------------&nbsp;--------------------&nbsp;<BR>Abraham&nbsp;Bennet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;Busy&nbsp;Executive''s&nbsp;<BR>Reginald&nbsp;Blotchet-Halls&nbsp;&nbsp;&nbsp;Fifty&nbsp;Years&nbsp;in&nbsp;Bucki&nbsp;<BR>Cheryl&nbsp;Carson&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;But&nbsp;Is&nbsp;It&nbsp;User&nbsp;Frien&nbsp;<BR>Michel&nbsp;DeFrance&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;Gourmet&nbsp;Microwav&nbsp;<BR>Innes&nbsp;del&nbsp;Castillo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Silicon&nbsp;Valley&nbsp;Gastr&nbsp;<BR>...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<BR>Johnson&nbsp;White&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prolonged&nbsp;Data&nbsp;Depri&nbsp;<BR>Akiko&nbsp;Yokomoto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sushi,&nbsp;Anyone?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>(25&nbsp;row(s)&nbsp;affected)</P></FONT>