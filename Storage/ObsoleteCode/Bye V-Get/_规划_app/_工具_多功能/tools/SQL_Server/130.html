<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>How&nbsp;Dynamic&nbsp;SQL&nbsp;Can&nbsp;Be&nbsp;Static&nbsp;SQL&nbsp;Part&nbsp;2</B><BR>Introduction
<P></P>
<P>&nbsp;</P>
<P>This&nbsp;is&nbsp;a&nbsp;continuation&nbsp;of&nbsp;my&nbsp;previous&nbsp;article&nbsp;How&nbsp;Dynamic&nbsp;SQL&nbsp;Can&nbsp;Be&nbsp;Static&nbsp;SQL.&nbsp;&nbsp;You&nbsp;do&nbsp;not&nbsp;need&nbsp;to&nbsp;read&nbsp;my&nbsp;previous&nbsp;article&nbsp;to&nbsp;understand&nbsp;this&nbsp;one.&nbsp;&nbsp;In&nbsp;this&nbsp;article&nbsp;I&nbsp;will&nbsp;explain&nbsp;a&nbsp;few&nbsp;more&nbsp;techniques&nbsp;that&nbsp;will&nbsp;allow&nbsp;you&nbsp;to&nbsp;modify&nbsp;the&nbsp;results&nbsp;of&nbsp;a&nbsp;static&nbsp;SQL&nbsp;query&nbsp;using&nbsp;variables.&nbsp;&nbsp;They&nbsp;are&nbsp;extremely&nbsp;useful&nbsp;if&nbsp;you&nbsp;don¡¯t&nbsp;want&nbsp;to&nbsp;create&nbsp;multiple&nbsp;queries&nbsp;that&nbsp;have&nbsp;only&nbsp;a&nbsp;few&nbsp;minor&nbsp;differences.</P>
<P>&nbsp;</P>
<P>Throughout&nbsp;this&nbsp;article&nbsp;I&nbsp;will&nbsp;use&nbsp;the&nbsp;Northwind&nbsp;database&nbsp;for&nbsp;all&nbsp;sample&nbsp;code.</P>
<P>&nbsp;</P>
<P>Example&nbsp;1&nbsp;¨C&nbsp;Greater&nbsp;Than&nbsp;and&nbsp;Less&nbsp;Than<BR>&nbsp;</P>
<P>This&nbsp;example&nbsp;will&nbsp;show&nbsp;how&nbsp;to&nbsp;dynamically&nbsp;determine&nbsp;greater&nbsp;than&nbsp;and&nbsp;less&nbsp;than&nbsp;using&nbsp;only&nbsp;one&nbsp;condition&nbsp;statement&nbsp;in&nbsp;the&nbsp;where&nbsp;clause.&nbsp;&nbsp;To&nbsp;accomplish&nbsp;this&nbsp;I¡¯ll&nbsp;use&nbsp;the&nbsp;CASE&nbsp;function&nbsp;and&nbsp;a&nbsp;variable&nbsp;called&nbsp;@sign.&nbsp;&nbsp;We¡¯ll&nbsp;suppose&nbsp;we&nbsp;want&nbsp;to&nbsp;see&nbsp;all&nbsp;employees&nbsp;that&nbsp;have&nbsp;a&nbsp;birthday&nbsp;greater&nbsp;than&nbsp;or&nbsp;less&nbsp;than&nbsp;a&nbsp;date&nbsp;we&nbsp;specify.&nbsp;&nbsp;The&nbsp;following&nbsp;code&nbsp;will&nbsp;do&nbsp;this:</P>
<P>&nbsp;</P>
<P>DECLARE&nbsp;@Sign&nbsp;char(1),&nbsp;@date&nbsp;datetime</P>
<P>&nbsp;</P>
<P>SET&nbsp;@Sign&nbsp;=&nbsp;'&gt;'</P>
<P>SET&nbsp;@date&nbsp;=&nbsp;'7/3/1963'</P>
<P>&nbsp;</P>
<P>SELECT&nbsp;*</P>
<P>FROM&nbsp;employees</P>
<P>WHERE&nbsp;CASE&nbsp;@Sign&nbsp;WHEN&nbsp;'&gt;'&nbsp;THEN&nbsp;BirthDate&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;WHEN&nbsp;'&lt;'&nbsp;THEN&nbsp;@date&nbsp;END&nbsp;&gt;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;@Sign&nbsp;WHEN&nbsp;'&gt;'&nbsp;THEN&nbsp;@date&nbsp;</P>
<P>&nbsp;&nbsp;WHEN&nbsp;'&lt;'&nbsp;THEN&nbsp;BirthDate&nbsp;END</P>
<P>&nbsp;</P>
<P>You¡¯ll&nbsp;notice&nbsp;that&nbsp;when&nbsp;you&nbsp;use&nbsp;the&nbsp;greater&nbsp;than&nbsp;sign&nbsp;you&nbsp;get&nbsp;everyone&nbsp;with&nbsp;a&nbsp;birth&nbsp;date&nbsp;greater&nbsp;than&nbsp;the&nbsp;date&nbsp;assigned&nbsp;to&nbsp;@date&nbsp;and&nbsp;when&nbsp;you&nbsp;change&nbsp;the&nbsp;sign&nbsp;to&nbsp;less&nbsp;than&nbsp;you&nbsp;get&nbsp;everyone&nbsp;with&nbsp;a&nbsp;birth&nbsp;date&nbsp;less&nbsp;than&nbsp;the&nbsp;date&nbsp;in&nbsp;@date.</P>
<P>&nbsp;</P>
<P>Example&nbsp;2&nbsp;¨C&nbsp;Where&nbsp;Clause&nbsp;Condition&nbsp;Elimination<BR>&nbsp;</P>
<P>This&nbsp;example&nbsp;will&nbsp;show&nbsp;how&nbsp;you&nbsp;can&nbsp;use&nbsp;variables&nbsp;to&nbsp;eliminate&nbsp;or&nbsp;use&nbsp;various&nbsp;conditions&nbsp;in&nbsp;a&nbsp;where&nbsp;clause.&nbsp;&nbsp;In&nbsp;this&nbsp;example&nbsp;we¡¯ll&nbsp;look&nbsp;at&nbsp;having&nbsp;only&nbsp;two&nbsp;conditions&nbsp;in&nbsp;our&nbsp;where&nbsp;clause.&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;code&nbsp;you&nbsp;can&nbsp;use:</P>
<P>&nbsp;</P>
<P>DECLARE&nbsp;@LastName&nbsp;varchar(30),&nbsp;@FirstName&nbsp;varchar(30)</P>
<P>&nbsp;</P>
<P>SET&nbsp;@LastName&nbsp;=&nbsp;'d'</P>
<P>SET&nbsp;@FirstName&nbsp;=&nbsp;'a'</P>
<P>&nbsp;</P>
<P>SELECT&nbsp;*</P>
<P>FROM&nbsp;employees</P>
<P>WHERE&nbsp;CASE&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;LastName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END&nbsp;Like</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;@LastName&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END</P>
<P>AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@FirstName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;FirstName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END&nbsp;Like</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@FirstName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;@FirstName&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END</P>
<P>&nbsp;</P>
<P>You¡¯ll&nbsp;notice&nbsp;that&nbsp;running&nbsp;it&nbsp;as&nbsp;is&nbsp;in&nbsp;the&nbsp;Northwind&nbsp;data&nbsp;base&nbsp;you&nbsp;should&nbsp;get&nbsp;only&nbsp;one&nbsp;record.&nbsp;&nbsp;Now&nbsp;delete&nbsp;the&nbsp;a&nbsp;from&nbsp;the&nbsp;@FirstName&nbsp;variable&nbsp;and&nbsp;rerun&nbsp;the&nbsp;query.&nbsp;&nbsp;You&nbsp;should&nbsp;see&nbsp;another&nbsp;name&nbsp;appear.&nbsp;&nbsp;Now&nbsp;bring&nbsp;back&nbsp;the&nbsp;a&nbsp;and&nbsp;delete&nbsp;the&nbsp;d&nbsp;from&nbsp;@LastName&nbsp;and&nbsp;rerun&nbsp;the&nbsp;query.&nbsp;&nbsp;One&nbsp;of&nbsp;the&nbsp;names&nbsp;will&nbsp;change.&nbsp;&nbsp;Now&nbsp;delete&nbsp;the&nbsp;a&nbsp;again&nbsp;and&nbsp;run&nbsp;the&nbsp;query&nbsp;with&nbsp;both&nbsp;variables&nbsp;equal&nbsp;to&nbsp;¡®¡¯.&nbsp;&nbsp;You¡¯ll&nbsp;get&nbsp;all&nbsp;records.</P>
<P>&nbsp;</P>
<P>Example&nbsp;3&nbsp;¨C&nbsp;Cascading&nbsp;Where&nbsp;Clause&nbsp;Conditions<BR>&nbsp;</P>
<P>This&nbsp;next&nbsp;example&nbsp;I&nbsp;have&nbsp;called&nbsp;cascading&nbsp;where&nbsp;clause&nbsp;conditions&nbsp;because&nbsp;it&nbsp;uses&nbsp;only&nbsp;certain&nbsp;variables&nbsp;bases&nbsp;on&nbsp;a&nbsp;specific&nbsp;precedence&nbsp;and&nbsp;each&nbsp;CASE&nbsp;function&nbsp;takes&nbsp;the&nbsp;first&nbsp;qualifying&nbsp;condition&nbsp;and&nbsp;then&nbsp;moves&nbsp;on.&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;code&nbsp;you&nbsp;can&nbsp;run&nbsp;in&nbsp;Query&nbsp;Analyzer:</P>
<P>&nbsp;</P>
<P>DECLARE&nbsp;@LastName&nbsp;varchar(30),&nbsp;@FirstName&nbsp;varchar(30),&nbsp;@Country&nbsp;varchar(5),&nbsp;@City&nbsp;varchar(20),</P>
<P>@Title&nbsp;varchar(30)</P>
<P>&nbsp;</P>
<P>SET&nbsp;@Country&nbsp;=&nbsp;'usa'</P>
<P>SET&nbsp;@City&nbsp;=&nbsp;'k'</P>
<P>SET&nbsp;@LastName&nbsp;=&nbsp;''</P>
<P>SET&nbsp;@FirstName&nbsp;=&nbsp;''</P>
<P>SET&nbsp;@Title&nbsp;=&nbsp;'s'</P>
<P>&nbsp;</P>
<P>SELECT&nbsp;*</P>
<P>FROM&nbsp;employees</P>
<P>WHERE&nbsp;CASE&nbsp;WHEN&nbsp;@Title&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;Title</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@Country&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;Country</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@City&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;City</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;LastName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;FirstName&nbsp;END&nbsp;LIKE</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@Title&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;@Title&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@Country&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;@Country</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@City&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;'%'&nbsp;+&nbsp;@City&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;@LastName&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;@FirstName&nbsp;+&nbsp;'%'&nbsp;END</P>
<P>AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@Title&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@Country&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;Country&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@Country&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@City&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;City&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@City&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;LastName&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@FirstName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;FirstName&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END&nbsp;LIKE</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@Title&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@Country&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;@Country&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@Country&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@City&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;@City&nbsp;+&nbsp;'%'&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@City&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;'%'&nbsp;+&nbsp;@LastName&nbsp;+&nbsp;'%'&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;CASE&nbsp;WHEN&nbsp;@FirstName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;ELSE&nbsp;'%'&nbsp;+&nbsp;@FirstName&nbsp;+&nbsp;'%'&nbsp;END</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END</P>
<P>AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@Title&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;City</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@Country&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;LastName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@City&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;FirstName</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;'Eliminate'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END&nbsp;LIKE</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WHEN&nbsp;@Title&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;'%'&nbsp;+&nbsp;@City&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@Country&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;@LastName&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@City&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;'%'&nbsp;+&nbsp;@FirstName&nbsp;+&nbsp;'%'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;THEN&nbsp;'Eliminate'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@LastName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;'Eliminate'</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;@FirstName&nbsp;&lt;&gt;&nbsp;''&nbsp;THEN&nbsp;'Eliminate'&nbsp;END</P>
<P>&nbsp;</P>
<P>The&nbsp;first&nbsp;precedence&nbsp;is&nbsp;on&nbsp;the&nbsp;title.&nbsp;&nbsp;When&nbsp;there&nbsp;is&nbsp;a&nbsp;value&nbsp;for&nbsp;@Title&nbsp;the&nbsp;only&nbsp;variables&nbsp;used&nbsp;will&nbsp;be&nbsp;@Title,&nbsp;@Country,&nbsp;and&nbsp;@City.&nbsp;&nbsp;If&nbsp;you&nbsp;use&nbsp;SET&nbsp;@Title&nbsp;=&nbsp;¡®¡¯&nbsp;you¡¯ll&nbsp;find&nbsp;that&nbsp;the&nbsp;only&nbsp;variables&nbsp;used&nbsp;are&nbsp;@Country,&nbsp;@City,&nbsp;and&nbsp;@LastName.&nbsp;&nbsp;When&nbsp;you&nbsp;SET&nbsp;@Country&nbsp;=&nbsp;¡®¡¯&nbsp;the&nbsp;only&nbsp;variables&nbsp;used&nbsp;will&nbsp;be&nbsp;@City,&nbsp;@LastName,&nbsp;and&nbsp;@FirstName.&nbsp;&nbsp;Having&nbsp;@Title&nbsp;=&nbsp;¡®¡¯,&nbsp;@Country&nbsp;=&nbsp;¡®¡¯,&nbsp;and&nbsp;@City&nbsp;=&nbsp;¡®¡¯&nbsp;will&nbsp;make&nbsp;the&nbsp;WHERE&nbsp;clause&nbsp;only&nbsp;use&nbsp;@LastName&nbsp;and&nbsp;@FirstName.&nbsp;&nbsp;Finally,&nbsp;having&nbsp;all&nbsp;the&nbsp;variables&nbsp;set&nbsp;equal&nbsp;to&nbsp;¡®¡¯&nbsp;except&nbsp;@FirstName&nbsp;will&nbsp;make&nbsp;the&nbsp;WHERE&nbsp;clause&nbsp;only&nbsp;use&nbsp;@FirstName.&nbsp;&nbsp;Here&nbsp;are&nbsp;some&nbsp;sample&nbsp;SET&nbsp;combinations&nbsp;you&nbsp;can&nbsp;use&nbsp;with&nbsp;this&nbsp;query:</P>
<P>&nbsp;</P>
<P>SET&nbsp;@Country&nbsp;=&nbsp;'uk'&nbsp;SET&nbsp;@City&nbsp;=&nbsp;'l'&nbsp;SET&nbsp;@LastName&nbsp;=&nbsp;'b'&nbsp;SET&nbsp;@FirstName&nbsp;=&nbsp;''&nbsp;</P>
<P>SET&nbsp;@Title&nbsp;=&nbsp;''</P>
<P>&nbsp;</P>
<P>SET&nbsp;@Country&nbsp;=&nbsp;''&nbsp;SET&nbsp;@City&nbsp;=&nbsp;'l'&nbsp;SET&nbsp;@LastName&nbsp;=&nbsp;'a'&nbsp;SET&nbsp;@FirstName&nbsp;=&nbsp;'a'</P>
<P>SET&nbsp;@Title&nbsp;=&nbsp;''</P>
<P>&nbsp;</P>
<P>SET&nbsp;@Country&nbsp;=&nbsp;''&nbsp;SET&nbsp;@City&nbsp;=&nbsp;''&nbsp;SET&nbsp;@LastName&nbsp;=&nbsp;'d'&nbsp;SET&nbsp;@FirstName&nbsp;=&nbsp;'n'</P>
<P>SET&nbsp;@Title&nbsp;=&nbsp;''</P>
<P>&nbsp;</P>
<P>SET&nbsp;@Country&nbsp;=&nbsp;''&nbsp;SET&nbsp;@City&nbsp;=&nbsp;''&nbsp;SET&nbsp;@LastName&nbsp;=&nbsp;''&nbsp;SET&nbsp;@FirstName&nbsp;=&nbsp;'a'</P>
<P>SET&nbsp;@Title&nbsp;=&nbsp;''</P>
<P>&nbsp;</P>
<P>This&nbsp;query&nbsp;was&nbsp;intentionally&nbsp;designed&nbsp;to&nbsp;not&nbsp;return&nbsp;all&nbsp;rows&nbsp;if&nbsp;all&nbsp;variables&nbsp;are&nbsp;set&nbsp;equal&nbsp;to&nbsp;¡®¡¯.&nbsp;&nbsp;This&nbsp;shows&nbsp;you&nbsp;an&nbsp;example&nbsp;of&nbsp;only&nbsp;allowing&nbsp;certain&nbsp;combinations&nbsp;of&nbsp;result&nbsp;sets&nbsp;controlled&nbsp;by&nbsp;what&nbsp;variables&nbsp;have&nbsp;values&nbsp;and&nbsp;if&nbsp;more&nbsp;than&nbsp;three&nbsp;values&nbsp;are&nbsp;provided&nbsp;then&nbsp;there&nbsp;is&nbsp;a&nbsp;systematic&nbsp;way&nbsp;to&nbsp;select&nbsp;which&nbsp;three&nbsp;should&nbsp;be&nbsp;used.</P>
<P>&nbsp;</P>
<P>Conclusions<BR>&nbsp;</P>
<P>This&nbsp;article&nbsp;shows&nbsp;a&nbsp;few&nbsp;ways&nbsp;to&nbsp;design&nbsp;static&nbsp;SQL&nbsp;that&nbsp;can&nbsp;have&nbsp;different&nbsp;records&nbsp;returned&nbsp;depending&nbsp;on&nbsp;what&nbsp;values&nbsp;are&nbsp;sent&nbsp;into&nbsp;variables.&nbsp;&nbsp;Using&nbsp;these&nbsp;techniques&nbsp;you&nbsp;can&nbsp;develop&nbsp;compact&nbsp;code&nbsp;and&nbsp;have&nbsp;only&nbsp;one&nbsp;query&nbsp;do&nbsp;all&nbsp;the&nbsp;work.&nbsp;&nbsp;This&nbsp;is&nbsp;an&nbsp;alternative&nbsp;to&nbsp;using&nbsp;dynamic&nbsp;SQL</P></FONT>