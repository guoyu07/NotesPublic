<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>系统表的一些例子</B><BR>具体看sqlserver2000帮助&nbsp;，输入sys后列出相应的系统表<BR>1.自动生成sql的数据字典<BR>&nbsp;&nbsp;select&nbsp;name,sno='''',fieldname=''表名:''+name,type='''',length='''',xscale='''',ifnull=''''<BR>&nbsp;&nbsp;into&nbsp;#tmp<BR>&nbsp;&nbsp;from&nbsp;sysobjects&nbsp;where&nbsp;type=''U''<BR>&nbsp;&nbsp;union&nbsp;all<BR>&nbsp;&nbsp;select&nbsp;a.name,sno=b.colid,fieldname=b.name,<BR>&nbsp;&nbsp;type=case&nbsp;b.xtype&nbsp;when&nbsp;34&nbsp;then&nbsp;''image''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;35&nbsp;then&nbsp;''text''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;52&nbsp;then&nbsp;''smallint''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;56&nbsp;then&nbsp;&nbsp;‘int''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;61&nbsp;then&nbsp;&nbsp;''datetime''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;62&nbsp;then&nbsp;''float''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;108&nbsp;then&nbsp;''numeric''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;167&nbsp;then&nbsp;''varchar''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;175&nbsp;then&nbsp;''char''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;231&nbsp;then&nbsp;''nvarchar''&nbsp;end,<BR>&nbsp;length&nbsp;=case&nbsp;when&nbsp;b.xtype=61&nbsp;then&nbsp;0&nbsp;else&nbsp;b.xscale&nbsp;end,<BR>&nbsp;ifnull=case&nbsp;when&nbsp;b.isnullable=0&nbsp;then&nbsp;''no''&nbsp;else&nbsp;''yes''&nbsp;end<BR>&nbsp;from&nbsp;sysobject&nbsp;a&nbsp;left&nbsp;join&nbsp;syscolumns&nbsp;b<BR>&nbsp;on&nbsp;a.id=b.id&nbsp;where&nbsp;a.type=''u''<BR>2.怎样取得数据库中所有表的索引名称及索引类型和相关索引字段（参考sp_helpindex)<BR>&nbsp;&nbsp;&nbsp;select&nbsp;b.id,a.indid,a.groupid,a.name,(a.status&amp;16)&nbsp;as&nbsp;clusted,(a.status&amp;2)&nbsp;as&nbsp;unique,b.name&nbsp;as&nbsp;myname,d.name&nbsp;as&nbsp;colname<BR>from&nbsp;sysindexes&nbsp;a.,sysobjects&nbsp;b,sysindexkeys&nbsp;c,syscolumns&nbsp;d<BR>where&nbsp;a.indid&gt;0&nbsp;and&nbsp;a.inid&lt;255&nbsp;and(a.status&amp;64)=0&nbsp;and&nbsp;a.id=b.id<BR>&nbsp;and&nbsp;a.id=c.id&nbsp;and&nbsp;a.id=d.id&nbsp;and&nbsp;c.colid=d.colid<BR>&nbsp;and&nbsp;a.indid=c.indid&nbsp;and&nbsp;objectproperty(b.id,N''isusertable'')=1<BR>&nbsp;order&nbsp;by&nbsp;b.name&nbsp;,a.indid
<P></P>
<P>3.如何在数据库里查找含有相同字段的表<BR>&nbsp;&nbsp;select&nbsp;b.name&nbsp;as&nbsp;tablename,a.name&nbsp;as&nbsp;columnname&nbsp;<BR>&nbsp;&nbsp;from&nbsp;syscolumns&nbsp;a&nbsp;inner&nbsp;join&nbsp;sysobjects&nbsp;b<BR>&nbsp;&nbsp;on&nbsp;a.id=b.id&nbsp;and&nbsp;b.type=’U''<BR>&nbsp;&nbsp;and&nbsp;a.name&nbsp;=''你的字段名称''<BR>&nbsp;&nbsp;select&nbsp;o.name&nbsp;as&nbsp;tablename&nbsp;,s1.name&nbsp;as&nbsp;colulmnname<BR>&nbsp;&nbsp;from&nbsp;syscolumns&nbsp;s1,sysobjects&nbsp;o<BR>&nbsp;&nbsp;where&nbsp;s1.id=o.id&nbsp;and&nbsp;o.type=''U''<BR>&nbsp;&nbsp;and&nbsp;exists(select&nbsp;*&nbsp;from&nbsp;syscolumns&nbsp;s2<BR>&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;s1.name=s2.name&nbsp;and&nbsp;s1.id&lt;&gt;s2.id)<BR>4.利用系统视图可以更方便的查出一些想要的东西<BR>&nbsp;&nbsp;&nbsp;<B>在帮助里输入infomation_schema,然后就列出了所有的系统视图</B><BR>&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;infomation_schema.tables<BR>&nbsp;&nbsp;可以查出表和视图<BR>&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;infomation_schema.views<BR>&nbsp;&nbsp;可以列出系统视图和自定义视图<BR>&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;infomation_schema.key_column_usage<BR>&nbsp;&nbsp;列出表的名字，主键，外键所属表的列名<BR>&nbsp;&nbsp;.....<BR>&nbsp;&nbsp;因为包含太多，可以自己看帮助。<BR>5.得到字段的描述属性<BR>&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;::fn_listextendedproperty(null，‘user'',''dbo'',''table'',''cab'',''column'',default)<BR></P></FONT>