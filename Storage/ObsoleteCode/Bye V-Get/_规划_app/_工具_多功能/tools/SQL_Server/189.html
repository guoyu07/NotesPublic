<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>BCP之妙用(adam.zhu)</B><BR>BCP语句的作用：<BR>&nbsp;&nbsp;&nbsp;BCP是SQL提供的进行数据传输的实用程序，这种语句提供了非常快的数据导入的方法。（当然7。0也有BCP的替代方法就是DTS，但是我们还是要来讲讲BCP。因为个人觉得它导入导出的速度非常的快。而且系统开销小，因为BCP是基于命令行的）<BR>&nbsp;&nbsp;&nbsp;BCP支持的文件类型是ASCII文本文件，本地的SQL格式文件和UNICODE文件。所以大家不用考虑用BCP来导入EXCEL或者ACCESS。
<P></P>
<P>执行了BCP后的语法如下：<BR>Microsoft(R)&nbsp;Windows&nbsp;98<BR>&nbsp;&nbsp;&nbsp;(C)Copyright&nbsp;Microsoft&nbsp;Corp&nbsp;1981-1999.<BR>C:\&gt;bcp<BR>usage:&nbsp;C:\MSSQL7\BINN\BCP.EXE&nbsp;{database.owner.dbtable&nbsp;|&nbsp;query}&nbsp;{in&nbsp;|&nbsp;out&nbsp;|&nbsp;queryout&nbsp;|&nbsp;format}&nbsp;datafile<BR>&nbsp;&nbsp;[-m&nbsp;maxerrors]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-f&nbsp;formatfile]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-e&nbsp;errfile]<BR>&nbsp;&nbsp;[-F&nbsp;firstrow]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-L&nbsp;lastrow]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-b&nbsp;batchsize]<BR>&nbsp;&nbsp;[-n&nbsp;native&nbsp;type]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-c&nbsp;character&nbsp;type]&nbsp;&nbsp;&nbsp;[-w&nbsp;wide&nbsp;character&nbsp;type]<BR>&nbsp;&nbsp;[-N&nbsp;keep&nbsp;non-text&nbsp;native]&nbsp;[-6&nbsp;6x&nbsp;file&nbsp;format]&nbsp;&nbsp;&nbsp;[-q&nbsp;quoted&nbsp;identifier]<BR>&nbsp;&nbsp;[-C&nbsp;code&nbsp;page&nbsp;specifier]&nbsp;&nbsp;[-t&nbsp;field&nbsp;terminator]&nbsp;[-r&nbsp;row&nbsp;terminator]<BR>&nbsp;&nbsp;[-i&nbsp;inputfile]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-o&nbsp;outfile]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-a&nbsp;packetsize]<BR>&nbsp;&nbsp;[-S&nbsp;server&nbsp;name]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-U&nbsp;username]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-P&nbsp;password]<BR>&nbsp;&nbsp;[-T&nbsp;trusted&nbsp;connection]&nbsp;&nbsp;&nbsp;[-v&nbsp;version]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-R&nbsp;regional&nbsp;enable]<BR>&nbsp;&nbsp;[-k&nbsp;keep&nbsp;null&nbsp;values]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-E&nbsp;keep&nbsp;identity&nbsp;values]<BR>&nbsp;&nbsp;[-h&nbsp;"load&nbsp;hints"]<BR>语法说明如下：<BR>database&nbsp;&nbsp;需要访问的数据库名字<BR>owner&nbsp;&nbsp;&nbsp;&nbsp;所访问表或者视图的用户名字<BR>dbtable&nbsp;&nbsp;&nbsp;所访问的表或者视图<BR>query&nbsp;&nbsp;&nbsp;&nbsp;产生一个结果集的SQL语句，当然语句要用双引号引起来<BR>in&nbsp;out&nbsp;queryout&nbsp;format&nbsp;数据传输的方向。In表示导入，out表示导出。<BR>Datafile&nbsp;&nbsp;导入时的源数据文件名或者是导出生成的文件名字。<BR>上面是BCP的语法说明，下面讲讲一些经常使用到的参数<BR>[-f&nbsp;formatfile]&nbsp;&nbsp;&nbsp;用来输入输出格式的文件名字，可以包含有路径<BR>[-U&nbsp;username]&nbsp;&nbsp;登陆数据库的表示符<BR>[-P&nbsp;password]&nbsp;&nbsp;登陆数据库的口令<BR>[-S&nbsp;server&nbsp;name]&nbsp;&nbsp;数据库的名字，如果是两台服务器之间导入导出必须要填写<BR>[-c&nbsp;character&nbsp;type]&nbsp;&nbsp;字符数据模式，在使用了该模式以后就不需要使用-f这个参数<BR>其他的参数可以在SQL的帮助中找到，我就不详细介绍了。<BR>操作的模式：<BR>&nbsp;&nbsp;&nbsp;在使用BCP导入数据时，有两种模式：快速和慢速模式。快速模式绕过事务日志，慢速模式将所有数据都记录在事务日志中。<BR>&nbsp;&nbsp;&nbsp;在使用BCP之前为了能够运行在快速模式下，你首先需要把数据库的SELECT&nbsp;INTO/BULK&nbsp;COPY设置成TURE。<BR>&nbsp;&nbsp;&nbsp;通过BCP直接向数据库导入数据时，需要考虑你的导入的表中的触发器，规则，索引等。BCP对触发器和规则是不强制处理的。</P></FONT>