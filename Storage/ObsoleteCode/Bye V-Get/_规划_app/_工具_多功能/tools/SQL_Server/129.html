<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>When&nbsp;Is&nbsp;Your&nbsp;Anniversary?</B><BR>Introduction&nbsp;<BR>Do&nbsp;you&nbsp;remember&nbsp;when&nbsp;your&nbsp;wedding&nbsp;anniversary&nbsp;is?&nbsp;The&nbsp;birthdays&nbsp;of&nbsp;your&nbsp;in-laws?&nbsp;Other&nbsp;important&nbsp;dates?&nbsp;A&nbsp;reader&nbsp;posted&nbsp;a&nbsp;question&nbsp;about&nbsp;how&nbsp;you&nbsp;can&nbsp;query&nbsp;for&nbsp;important&nbsp;dates&nbsp;that&nbsp;occur&nbsp;within&nbsp;a&nbsp;time&nbsp;span.&nbsp;At&nbsp;first,&nbsp;this&nbsp;would&nbsp;seem&nbsp;to&nbsp;be&nbsp;a&nbsp;simple&nbsp;task,&nbsp;but&nbsp;as&nbsp;I&nbsp;conducted&nbsp;a&nbsp;few&nbsp;experiments,&nbsp;it&nbsp;turned&nbsp;out&nbsp;to&nbsp;not&nbsp;be&nbsp;as&nbsp;straightforward&nbsp;as&nbsp;I&nbsp;thought.&nbsp;
<P></P>
<P><BR>The&nbsp;Problem&nbsp;<BR>All&nbsp;important&nbsp;dates&nbsp;have&nbsp;some&nbsp;beginning&nbsp;date,&nbsp;a&nbsp;"birth&nbsp;date"&nbsp;of&nbsp;sorts.&nbsp;Of&nbsp;course,&nbsp;birthdays&nbsp;have&nbsp;a&nbsp;birth&nbsp;date&nbsp;as&nbsp;well.&nbsp;This&nbsp;is&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;the&nbsp;event.&nbsp;It&nbsp;also&nbsp;occurs&nbsp;every&nbsp;year&nbsp;on&nbsp;that&nbsp;some&nbsp;month&nbsp;and&nbsp;day&nbsp;as&nbsp;the&nbsp;first&nbsp;occurrence.&nbsp;So&nbsp;how&nbsp;do&nbsp;you&nbsp;query&nbsp;for&nbsp;all&nbsp;the&nbsp;events&nbsp;that&nbsp;are&nbsp;coming&nbsp;up&nbsp;in&nbsp;the&nbsp;next,&nbsp;say,&nbsp;one&nbsp;month?&nbsp;It's&nbsp;not&nbsp;as&nbsp;straightforward&nbsp;as&nbsp;one&nbsp;would&nbsp;expect.&nbsp;</P>
<P>Suppose&nbsp;I&nbsp;have&nbsp;a&nbsp;table&nbsp;that&nbsp;looks&nbsp;like&nbsp;the&nbsp;following:</P>
<P><BR>Person&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Birthday<BR>-----------&nbsp;&nbsp;&nbsp;-------------<BR>Steve&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;09/15/1967<BR>Tia&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;02/01/1969<BR>Kendall&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;05/15/2001<BR>Delaney&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11/18/1998<BR>Kyle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;06/01/1992</P>
<P>and&nbsp;I&nbsp;want&nbsp;to&nbsp;find&nbsp;out&nbsp;whose&nbsp;birthday&nbsp;will&nbsp;occur&nbsp;in&nbsp;this&nbsp;month&nbsp;or&nbsp;next&nbsp;month&nbsp;and&nbsp;send&nbsp;a&nbsp;reminder.&nbsp;I&nbsp;can&nbsp;easily&nbsp;find&nbsp;today's&nbsp;date&nbsp;and&nbsp;the&nbsp;end&nbsp;date&nbsp;for&nbsp;next&nbsp;month,&nbsp;but&nbsp;how&nbsp;do&nbsp;I&nbsp;find&nbsp;which&nbsp;dates&nbsp;occur&nbsp;within&nbsp;this&nbsp;timeframe?&nbsp;If&nbsp;I&nbsp;query&nbsp;for&nbsp;anything&nbsp;between&nbsp;the&nbsp;two&nbsp;dates,&nbsp;nothing&nbsp;will&nbsp;be&nbsp;returned&nbsp;because&nbsp;none&nbsp;of&nbsp;the&nbsp;events&nbsp;occur&nbsp;within&nbsp;this&nbsp;timeframe.&nbsp;Suppose&nbsp;today&nbsp;is&nbsp;May&nbsp;3,&nbsp;then&nbsp;I&nbsp;am&nbsp;looking&nbsp;for&nbsp;events&nbsp;between&nbsp;May&nbsp;3&nbsp;and&nbsp;June&nbsp;30.&nbsp;I&nbsp;can&nbsp;run&nbsp;the&nbsp;following:&nbsp;<BR>create&nbsp;table&nbsp;myTest<BR>(&nbsp;person&nbsp;varchar(&nbsp;80)<BR>&nbsp;,&nbsp;birthday&nbsp;datetime<BR>)<BR>go<BR>insert&nbsp;MyTest&nbsp;select&nbsp;'Steve',&nbsp;'09/15/1967'<BR>insert&nbsp;MyTest&nbsp;select&nbsp;'Tia',&nbsp;'02/01/1969'<BR>insert&nbsp;MyTest&nbsp;select&nbsp;'Kendall',&nbsp;'05/15/2001'<BR>insert&nbsp;MyTest&nbsp;select&nbsp;'Delaney',&nbsp;'11/18/1998'<BR>insert&nbsp;MyTest&nbsp;select&nbsp;'Kyle',&nbsp;'06/01/1992'</P>
<P>go<BR>declare&nbsp;@today&nbsp;datetime<BR>&nbsp;,&nbsp;@lastday&nbsp;datetime</P>
<P>select&nbsp;@today&nbsp;=&nbsp;'05/03/2001'<BR>select&nbsp;@lastday&nbsp;=<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;</P>
<P><BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P><BR>&nbsp;&nbsp;<BR>&nbsp;'06/30/2001'&nbsp;select&nbsp;*</P>
<P>from&nbsp;MyTest&nbsp;&nbsp;where<BR>birthday&nbsp;&gt;&nbsp;=&nbsp;</P>
<P>&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;@today&nbsp;&nbsp;and<BR>&nbsp;birthday&nbsp;&lt;&nbsp;=&nbsp;@lastday</P>
<P>This&nbsp;returns&nbsp;the&nbsp;following:</P>
<P>Person&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Birthday<BR>-----------&nbsp;&nbsp;&nbsp;-------------<BR>Kendall&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;05/15/2001</P>
<P>which&nbsp;is&nbsp;not&nbsp;the&nbsp;correct&nbsp;result&nbsp;set.&nbsp;What&nbsp;we&nbsp;really&nbsp;should&nbsp;be&nbsp;returning&nbsp;is&nbsp;both&nbsp;Kendall&nbsp;and&nbsp;Kyle&nbsp;since&nbsp;they&nbsp;both&nbsp;have&nbsp;birthdays&nbsp;in&nbsp;this&nbsp;range.&nbsp;OK,&nbsp;so&nbsp;we&nbsp;need&nbsp;to&nbsp;change&nbsp;the&nbsp;query&nbsp;to&nbsp;not&nbsp;use&nbsp;the&nbsp;date&nbsp;compares&nbsp;and&nbsp;instead&nbsp;examine&nbsp;the&nbsp;month&nbsp;and&nbsp;date.&nbsp;Let's&nbsp;try:</P>
<P>declare&nbsp;@today&nbsp;datetime<BR>&nbsp;,&nbsp;@lastday&nbsp;datetime</P>
<P>select&nbsp;@today&nbsp;=&nbsp;'05/03/2001'<BR>select&nbsp;@lastday&nbsp;=&nbsp;'06/30/2001'</P>
<P>select&nbsp;*<BR>&nbsp;from&nbsp;MyTest<BR>&nbsp;where&nbsp;month(&nbsp;birthday)&nbsp;&gt;=<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;</P>
<P>month(@today)&nbsp;and&nbsp;&nbsp;month(<BR>birthday)&nbsp;&lt;&nbsp;=&nbsp;</P>
<P>&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;month(&nbsp;@lastday)&nbsp;&nbsp;and<BR>&nbsp;day(&nbsp;birthday)&nbsp;&gt;&nbsp;=&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;day(@today)&nbsp;&nbsp;and<BR>&nbsp;day(&nbsp;birthday)&nbsp;&lt;&nbsp;=&nbsp;day(&nbsp;@lastday)</P>
<P>This&nbsp;returns&nbsp;the&nbsp;following:</P>
<P>Person&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Birthday<BR>-----------&nbsp;&nbsp;&nbsp;-------------<BR>Kendall&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;05/15/2001</P>
<P>We&nbsp;are&nbsp;still&nbsp;not&nbsp;getting&nbsp;what&nbsp;we&nbsp;want.&nbsp;Why&nbsp;not?&nbsp;Because&nbsp;we&nbsp;are&nbsp;comparing&nbsp;months&nbsp;and&nbsp;dates&nbsp;together,&nbsp;rather&nbsp;than&nbsp;month&nbsp;and&nbsp;then&nbsp;date.&nbsp;Now&nbsp;I&nbsp;can&nbsp;implement&nbsp;some&nbsp;subqueries&nbsp;to&nbsp;find&nbsp;items&nbsp;within&nbsp;the&nbsp;month&nbsp;range&nbsp;and&nbsp;then&nbsp;find&nbsp;those&nbsp;within&nbsp;the&nbsp;date&nbsp;range,&nbsp;but&nbsp;I&nbsp;have&nbsp;a&nbsp;better&nbsp;solution&nbsp;(I&nbsp;think).&nbsp;</P>
<P>The&nbsp;Solution&nbsp;<BR>The&nbsp;first&nbsp;thing&nbsp;that&nbsp;I&nbsp;want&nbsp;to&nbsp;do&nbsp;is&nbsp;make&nbsp;my&nbsp;script&nbsp;a&nbsp;bit&nbsp;more&nbsp;general&nbsp;so&nbsp;I&nbsp;can&nbsp;test&nbsp;a&nbsp;range&nbsp;of&nbsp;dates.&nbsp;My&nbsp;first&nbsp;change&nbsp;it&nbsp;to&nbsp;calculate&nbsp;the&nbsp;end&nbsp;date&nbsp;of&nbsp;the&nbsp;next&nbsp;month.&nbsp;The&nbsp;first&nbsp;few&nbsp;line&nbsp;of&nbsp;the&nbsp;script&nbsp;change&nbsp;to:&nbsp;</P>
<P>declare&nbsp;@today&nbsp;datetime<BR>&nbsp;,&nbsp;@lastday&nbsp;datetime<BR>&nbsp;,&nbsp;@months&nbsp;int<BR>&nbsp;<BR>select&nbsp;@months&nbsp;=&nbsp;2</P>
<P>select&nbsp;@today&nbsp;=&nbsp;'05/03/2001'<BR>select&nbsp;@lastday&nbsp;=&nbsp;dateadd(&nbsp;day,&nbsp;-1&nbsp;*&nbsp;(day(@today)),&nbsp;dateadd(&nbsp;month,&nbsp;@months,&nbsp;@today))</P>
<P>This&nbsp;uses&nbsp;a&nbsp;great&nbsp;technique&nbsp;submitted&nbsp;by&nbsp;jasoningram&nbsp;in&nbsp;our&nbsp;forum.&nbsp;</P>
<P>Now,&nbsp;instead&nbsp;of&nbsp;looking&nbsp;at&nbsp;days&nbsp;and&nbsp;months,&nbsp;I&nbsp;decided&nbsp;that&nbsp;the&nbsp;thing&nbsp;I&nbsp;really&nbsp;wanted&nbsp;to&nbsp;do&nbsp;was&nbsp;use&nbsp;the&nbsp;date&nbsp;functions&nbsp;to&nbsp;compare&nbsp;the&nbsp;date&nbsp;on&nbsp;which&nbsp;an&nbsp;event&nbsp;occurs&nbsp;with&nbsp;the&nbsp;date&nbsp;range.&nbsp;To&nbsp;do&nbsp;that&nbsp;I&nbsp;needed&nbsp;to&nbsp;"move"&nbsp;the&nbsp;dates&nbsp;from&nbsp;the&nbsp;table&nbsp;to&nbsp;the&nbsp;current&nbsp;year.&nbsp;I&nbsp;did&nbsp;not,&nbsp;however,&nbsp;want&nbsp;to&nbsp;change&nbsp;the&nbsp;table&nbsp;data.&nbsp;Instead,&nbsp;I&nbsp;took&nbsp;a&nbsp;cue&nbsp;from&nbsp;Mr.&nbsp;Ingram&nbsp;and&nbsp;wrote&nbsp;this&nbsp;query:</P>
<P><BR>declare&nbsp;@today&nbsp;datetime<BR>&nbsp;,&nbsp;@lastday&nbsp;datetime<BR>&nbsp;,&nbsp;@months&nbsp;int</P>
<P>select&nbsp;@months&nbsp;=&nbsp;2<BR>select&nbsp;@today&nbsp;=&nbsp;'05/03/2001'<BR>select&nbsp;@lastday&nbsp;=&nbsp;dateadd(&nbsp;day,&nbsp;-1&nbsp;*&nbsp;(day(@today)),&nbsp;<BR>dateadd(&nbsp;month,&nbsp;@months,<BR>&nbsp;@today))&nbsp;select&nbsp;*<BR>&nbsp;from&nbsp;MyTest&nbsp;where</P>
<P>dateadd(&nbsp;year,&nbsp;&nbsp;datediff(<BR>year,&nbsp;birthday,&nbsp;&nbsp;@today),<BR>birthday)&nbsp;&gt;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@today&nbsp;&nbsp;and<BR>&nbsp;dateadd(&nbsp;year,&nbsp;datediff(&nbsp;year,&nbsp;birthday,&nbsp;@today),&nbsp;birthday)&nbsp;&lt;&nbsp;=&nbsp;@lastday</P>
<P>This&nbsp;now&nbsp;returns&nbsp;both&nbsp;expected&nbsp;dates.&nbsp;<BR>Person&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Birthday<BR>-----------&nbsp;&nbsp;&nbsp;-------------<BR>Kendall&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;05/15/2001<BR>Kyle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;06/01/1992</P>
<P>By&nbsp;using&nbsp;the&nbsp;built&nbsp;in&nbsp;date&nbsp;functions&nbsp;to&nbsp;calculate&nbsp;the&nbsp;years&nbsp;between&nbsp;the&nbsp;current&nbsp;date&nbsp;and&nbsp;each&nbsp;date&nbsp;allows&nbsp;me&nbsp;to&nbsp;"move"&nbsp;each&nbsp;date&nbsp;to&nbsp;the&nbsp;present&nbsp;year&nbsp;using&nbsp;the&nbsp;dateadd&nbsp;function.&nbsp;However,&nbsp;we&nbsp;are&nbsp;not&nbsp;done&nbsp;yet.&nbsp;The&nbsp;advanced&nbsp;SQL&nbsp;guys&nbsp;out&nbsp;there&nbsp;probably&nbsp;caught&nbsp;the&nbsp;one&nbsp;bug&nbsp;right&nbsp;away.&nbsp;What&nbsp;about&nbsp;year&nbsp;ends?&nbsp;</P>
<P>Suppose&nbsp;today&nbsp;is&nbsp;11/01/2001&nbsp;and&nbsp;I&nbsp;am&nbsp;looking&nbsp;for&nbsp;all&nbsp;events&nbsp;in&nbsp;the&nbsp;next&nbsp;4&nbsp;months.&nbsp;This&nbsp;would&nbsp;mean&nbsp;that&nbsp;I&nbsp;want&nbsp;to&nbsp;return&nbsp;both&nbsp;Delaney&nbsp;(11/18)&nbsp;and&nbsp;Tia&nbsp;(2/1).&nbsp;If&nbsp;I&nbsp;change&nbsp;my&nbsp;date&nbsp;and&nbsp;timeframe,&nbsp;I&nbsp;get:</P>
<P><BR>declare&nbsp;@today&nbsp;datetime<BR>&nbsp;,&nbsp;@lastday&nbsp;datetime<BR>&nbsp;,&nbsp;@months&nbsp;int</P>
<P>select&nbsp;@months&nbsp;=&nbsp;4</P>
<P>select&nbsp;@today&nbsp;=&nbsp;'11/01/2001'<BR>select&nbsp;@lastday&nbsp;=&nbsp;dateadd(&nbsp;day,&nbsp;-1&nbsp;*&nbsp;(day(@today)),&nbsp;<BR>dateadd(&nbsp;month,&nbsp;@months,<BR>&nbsp;@today))&nbsp;select&nbsp;*<BR>&nbsp;from&nbsp;MyTest&nbsp;where</P>
<P>dateadd(&nbsp;year,&nbsp;&nbsp;datediff(</P>
<P>year,&nbsp;birthday,&nbsp;&nbsp;@today),<BR>birthday)&nbsp;&gt;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@today&nbsp;&nbsp;and<BR>&nbsp;dateadd(&nbsp;year,&nbsp;datediff(&nbsp;year,&nbsp;birthday,&nbsp;@today),&nbsp;birthday)&nbsp;&lt;&nbsp;=&nbsp;@lastday</P>
<P>This&nbsp;only&nbsp;returns&nbsp;one&nbsp;date,&nbsp;however.&nbsp;<BR>Person&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Birthday<BR>-----------&nbsp;&nbsp;&nbsp;-------------<BR>Delaney&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11/18/1998</P>
<P>Why?&nbsp;</P>
<P>Let's&nbsp;examine&nbsp;what&nbsp;happens&nbsp;when&nbsp;we&nbsp;"move"&nbsp;all&nbsp;the&nbsp;dates.&nbsp;If&nbsp;we&nbsp;print&nbsp;out&nbsp;the&nbsp;dates&nbsp;after&nbsp;the&nbsp;calculation&nbsp;we&nbsp;can&nbsp;see&nbsp;ths&nbsp;following:&nbsp;</P>
<P>declare&nbsp;@today&nbsp;datetime<BR>&nbsp;,&nbsp;@lastday&nbsp;datetime<BR>&nbsp;,&nbsp;@months&nbsp;int</P>
<P>select&nbsp;@months&nbsp;=&nbsp;4</P>
<P>select&nbsp;@today&nbsp;=&nbsp;'11/01/2001'<BR>select&nbsp;@lastday&nbsp;=&nbsp;dateadd(&nbsp;day,&nbsp;-1&nbsp;*&nbsp;(day(@today)),&nbsp;dateadd(&nbsp;month,&nbsp;@months,&nbsp;@today))</P>
<P>select&nbsp;birthday<BR>&nbsp;,&nbsp;dateadd(&nbsp;year,&nbsp;datediff(&nbsp;year,&nbsp;birthday,&nbsp;@today),&nbsp;birthday)<BR>&nbsp;from&nbsp;MyTest</P>
<P>this&nbsp;returns:</P>
<P>1967-09-15&nbsp;00:00:00.000&nbsp;2001-09-15&nbsp;00:00:00.000&nbsp;<BR>1969-02-01&nbsp;00:00:00.000&nbsp;2001-02-01&nbsp;00:00:00.000&nbsp;<BR>2001-05-15&nbsp;00:00:00.000&nbsp;2001-05-15&nbsp;00:00:00.000&nbsp;<BR>1998-11-18&nbsp;00:00:00.000&nbsp;2001-11-18&nbsp;00:00:00.000&nbsp;<BR>1992-06-01&nbsp;00:00:00.000&nbsp;2001-06-01&nbsp;00:00:00.000&nbsp;</P>
<P>I&nbsp;left&nbsp;out&nbsp;the&nbsp;names,&nbsp;but&nbsp;we&nbsp;can&nbsp;see&nbsp;that&nbsp;all&nbsp;the&nbsp;dates&nbsp;were&nbsp;moved&nbsp;to&nbsp;the&nbsp;year&nbsp;2001.&nbsp;However,&nbsp;the&nbsp;@lastday&nbsp;value&nbsp;is&nbsp;"02/28/2002".&nbsp;This&nbsp;is&nbsp;one&nbsp;year&nbsp;into&nbsp;the&nbsp;future.&nbsp;So&nbsp;how&nbsp;can&nbsp;we&nbsp;fix&nbsp;this?&nbsp;</P>
<P>Well,&nbsp;I&nbsp;haven't&nbsp;found&nbsp;a&nbsp;way&nbsp;to&nbsp;do&nbsp;this&nbsp;in&nbsp;a&nbsp;single&nbsp;query,&nbsp;but&nbsp;I&nbsp;did&nbsp;find&nbsp;a&nbsp;way&nbsp;to&nbsp;do&nbsp;this&nbsp;in&nbsp;two&nbsp;queries,&nbsp;using&nbsp;the&nbsp;UNION&nbsp;operator&nbsp;to&nbsp;combine&nbsp;them.&nbsp;What&nbsp;I&nbsp;reasoned&nbsp;was&nbsp;that&nbsp;for&nbsp;any&nbsp;date&nbsp;whose&nbsp;month&nbsp;is&nbsp;the&nbsp;same&nbsp;or&nbsp;greater&nbsp;than&nbsp;the&nbsp;current&nbsp;month&nbsp;(from&nbsp;@today)&nbsp;needs&nbsp;to&nbsp;be&nbsp;moved&nbsp;to&nbsp;the&nbsp;current&nbsp;year.&nbsp;Any&nbsp;date&nbsp;from&nbsp;a&nbsp;month&nbsp;prior&nbsp;to&nbsp;the&nbsp;current&nbsp;month,&nbsp;however,&nbsp;needs&nbsp;to&nbsp;be&nbsp;moved&nbsp;to&nbsp;the&nbsp;next&nbsp;year.&nbsp;This&nbsp;allows&nbsp;the&nbsp;standard&nbsp;date&nbsp;functions&nbsp;to&nbsp;perform&nbsp;the&nbsp;comparisons&nbsp;correctly.&nbsp;My&nbsp;new&nbsp;query&nbsp;is:&nbsp;</P>
<P>declare&nbsp;@today&nbsp;datetime<BR>&nbsp;,&nbsp;@future&nbsp;datetime<BR>&nbsp;,&nbsp;@months&nbsp;int</P>
<P>select&nbsp;@months&nbsp;=&nbsp;4</P>
<P>select&nbsp;@today&nbsp;=&nbsp;'11/1/01'<BR>select&nbsp;@future&nbsp;=&nbsp;dateadd(&nbsp;day,&nbsp;-1&nbsp;*&nbsp;(day(@today)),&nbsp;dateadd(&nbsp;month,&nbsp;@months,&nbsp;@today))</P>
<P>select&nbsp;*<BR>&nbsp;from&nbsp;MyTest<BR>&nbsp;where&nbsp;dateadd(&nbsp;year,&nbsp;datediff(&nbsp;year,&nbsp;birthday,&nbsp;@today),&nbsp;birthday)&nbsp;&gt;=<BR>&nbsp;@today&nbsp;and<BR>&nbsp;dateadd(&nbsp;year,&nbsp;datediff(<BR>&nbsp;year,&nbsp;birthday,&nbsp;@today),</P>
<P>birthday)&nbsp;&lt;&nbsp;=&nbsp;</P>
<P>@future&nbsp;and&nbsp;&nbsp;month(<BR>birthday)&nbsp;&gt;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;month(&nbsp;@today)&nbsp;union&nbsp;select&nbsp;*&nbsp;&nbsp;from<BR>&nbsp;MyTest&nbsp;where&nbsp;dateadd(&nbsp;year,&nbsp;datediff(&nbsp;year,&nbsp;birthday,&nbsp;@today)&nbsp;&nbsp;+<BR>&nbsp;1,&nbsp;birthday)&nbsp;&gt;&nbsp;=&nbsp;&nbsp;</P>
<P>&nbsp;<BR>&nbsp;@today&nbsp;and<BR>&nbsp;dateadd(&nbsp;year,&nbsp;datediff(&nbsp;year,&nbsp;birthday,&nbsp;@today)&nbsp;+&nbsp;1,&nbsp;birthday)&nbsp;&lt;&nbsp;=&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@future&nbsp;&nbsp;and<BR>&nbsp;month(&nbsp;birthday)&nbsp;&lt;&nbsp;&nbsp;month(&nbsp;@today&nbsp;)</P>
<P>this&nbsp;returns:</P>
<P>Person&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Birthday<BR>-----------&nbsp;&nbsp;&nbsp;-------------<BR>Delaney&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11/18/1998<BR>Tia&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;02/01/1969</P>
<P><BR>Conclusions&nbsp;<BR>While&nbsp;not&nbsp;too&nbsp;terribly&nbsp;complex,&nbsp;this&nbsp;was&nbsp;more&nbsp;difficult&nbsp;than&nbsp;I&nbsp;had&nbsp;thought&nbsp;at&nbsp;first&nbsp;glance.&nbsp;It&nbsp;was&nbsp;also&nbsp;an&nbsp;interesting&nbsp;problem&nbsp;that&nbsp;I&nbsp;had&nbsp;never&nbsp;encountered,&nbsp;but&nbsp;one&nbsp;that&nbsp;would&nbsp;be&nbsp;useful&nbsp;in&nbsp;any&nbsp;environment&nbsp;that&nbsp;is&nbsp;handling&nbsp;repeating&nbsp;events.&nbsp;Hopefully&nbsp;you&nbsp;learned&nbsp;something&nbsp;or&nbsp;found&nbsp;a&nbsp;solution&nbsp;to&nbsp;a&nbsp;problem&nbsp;that&nbsp;you&nbsp;have&nbsp;had.&nbsp;</P>
<P><BR>I&nbsp;am&nbsp;sure&nbsp;some&nbsp;of&nbsp;you&nbsp;will&nbsp;have&nbsp;some&nbsp;great&nbsp;ideas&nbsp;for&nbsp;enhancing&nbsp;this&nbsp;solution.&nbsp;As&nbsp;always&nbsp;I&nbsp;welcome&nbsp;feedback&nbsp;on&nbsp;this&nbsp;article&nbsp;using&nbsp;the&nbsp;"Your&nbsp;Opinion"&nbsp;button&nbsp;below.&nbsp;Please&nbsp;also&nbsp;rate&nbsp;this&nbsp;article.&nbsp;</P>
<P>Steve&nbsp;Jones<BR>©dkRanch.net&nbsp;October&nbsp;2001</P></FONT>