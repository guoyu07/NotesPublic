<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>列出SQL&nbsp;SERVER&nbsp;所有表(pjessica收藏)</B><BR>--&nbsp;======================================================
<P></P>
<P>--列出SQL&nbsp;SERVER&nbsp;所有表，字段名，主键，类型，长度，小数位数等信息</P>
<P>--在查询分析器里运行即可,可以生成一个表，导出到EXCEL中</P>
<P>--&nbsp;======================================================</P>
<P>SELECT&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(case&nbsp;when&nbsp;a.colorder=1&nbsp;then&nbsp;d.name&nbsp;else&nbsp;''&nbsp;end)表名,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.colorder&nbsp;字段序号,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.name&nbsp;字段名,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(case&nbsp;when&nbsp;COLUMNPROPERTY(&nbsp;a.id,a.name,'IsIdentity')=1&nbsp;then&nbsp;'√'else&nbsp;''&nbsp;end)&nbsp;标识,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(case&nbsp;when&nbsp;(SELECT&nbsp;count(*)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;sysobjects</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;(name&nbsp;in</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SELECT&nbsp;name</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;sysindexes</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;(id&nbsp;=&nbsp;a.id)&nbsp;AND&nbsp;(indid&nbsp;in</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SELECT&nbsp;indid</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;sysindexkeys</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;(id&nbsp;=&nbsp;a.id)&nbsp;AND&nbsp;(colid&nbsp;in</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SELECT&nbsp;colid</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;syscolumns</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;(id&nbsp;=&nbsp;a.id)&nbsp;AND&nbsp;(name&nbsp;=&nbsp;a.name)))))))&nbsp;AND</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(xtype&nbsp;=&nbsp;'PK'))&gt;0&nbsp;then&nbsp;'√'&nbsp;else&nbsp;''&nbsp;end)&nbsp;主键,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.name&nbsp;类型,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.length&nbsp;占用字节数,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLUMNPROPERTY(a.id,a.name,'PRECISION')&nbsp;as&nbsp;长度,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isnull(COLUMNPROPERTY(a.id,a.name,'Scale'),0)&nbsp;as&nbsp;小数位数,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(case&nbsp;when&nbsp;a.isnullable=1&nbsp;then&nbsp;'√'else&nbsp;''&nbsp;end)&nbsp;允许空,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isnull(e.text,'')&nbsp;默认值,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isnull(g.[value],'')&nbsp;AS&nbsp;字段说明&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P></P>
<P>FROM&nbsp;&nbsp;syscolumns&nbsp;&nbsp;a&nbsp;left&nbsp;join&nbsp;systypes&nbsp;b&nbsp;</P>
<P>on&nbsp;&nbsp;a.xtype=b.xusertype</P>
<P>inner&nbsp;join&nbsp;sysobjects&nbsp;d&nbsp;</P>
<P>on&nbsp;a.id=d.id&nbsp;&nbsp;and&nbsp;&nbsp;d.xtype='U'&nbsp;and&nbsp;&nbsp;d.name&lt;&gt;'dtproperties'</P>
<P>left&nbsp;join&nbsp;syscomments&nbsp;e</P>
<P>on&nbsp;a.cdefault=e.id</P>
<P>left&nbsp;join&nbsp;sysproperties&nbsp;g</P>
<P>on&nbsp;a.id=g.id&nbsp;AND&nbsp;a.colid&nbsp;=&nbsp;g.smallid&nbsp;&nbsp;</P>
<P>order&nbsp;by&nbsp;a.id,a.colorder</P>
<P>-------------------------------------------------------------------------------------------------</P></FONT>