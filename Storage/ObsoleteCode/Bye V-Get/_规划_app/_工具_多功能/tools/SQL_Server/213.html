<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Disabling&nbsp;or&nbsp;Enabling&nbsp;All&nbsp;Constraints</B><BR>Disabling&nbsp;or&nbsp;Enabling&nbsp;All&nbsp;Constraints&nbsp;of&nbsp;a&nbsp;Table&nbsp;or&nbsp;Database<BR>By&nbsp;Eli&nbsp;Leiba
<P></P>
<P></P>
<P><BR>These&nbsp;procedures&nbsp;are&nbsp;very&nbsp;important&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;need&nbsp;to&nbsp;load&nbsp;a&nbsp;bulk&nbsp;of&nbsp;data&nbsp;that&nbsp;you&nbsp;know&nbsp;is&nbsp;correct&nbsp;but&nbsp;when&nbsp;you&nbsp;do&nbsp;not&nbsp;need&nbsp;the&nbsp;foreign&nbsp;keys&nbsp;and&nbsp;check&nbsp;constraints&nbsp;to&nbsp;interfere&nbsp;while&nbsp;you&nbsp;are&nbsp;loading&nbsp;the&nbsp;data.&nbsp;This&nbsp;is&nbsp;also&nbsp;the&nbsp;case&nbsp;when&nbsp;you&nbsp;want&nbsp;to&nbsp;change&nbsp;key&nbsp;values&nbsp;and&nbsp;don't&nbsp;want&nbsp;the&nbsp;constraints&nbsp;to&nbsp;get&nbsp;in&nbsp;your&nbsp;way.&nbsp;The&nbsp;following&nbsp;procedure&nbsp;will&nbsp;disable/enable&nbsp;all&nbsp;constraints&nbsp;for&nbsp;a&nbsp;given&nbsp;parametric&nbsp;table.&nbsp;</P>
<P><BR>--&nbsp;PROCEDURE&nbsp;to&nbsp;disable/enable&nbsp;all&nbsp;constraints&nbsp;on&nbsp;a&nbsp;table&nbsp;</P>
<P>CREATE&nbsp;PROCEDURE&nbsp;sp_ConstraintState&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@TblName&nbsp;&nbsp;&nbsp;VARCHAR(128),&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@State&nbsp;BIT&nbsp;=&nbsp;1&nbsp;<BR>AS&nbsp;<BR>DECLARE&nbsp;@SQLState&nbsp;VARCHAR(500)&nbsp;<BR>IF&nbsp;@State&nbsp;=&nbsp;0&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@SQLState&nbsp;=&nbsp;'ALTER&nbsp;TABLE&nbsp;'+&nbsp;@TblName&nbsp;+&nbsp;'&nbsp;NOCHECK&nbsp;CONSTRAINT&nbsp;ALL'&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;<BR>ELSE&nbsp;<BR>&nbsp;&nbsp;&nbsp;BEGIN&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@SQLState&nbsp;=&nbsp;'ALTER&nbsp;TABLE&nbsp;'&nbsp;+&nbsp;@TblName&nbsp;+&nbsp;'&nbsp;CHECK&nbsp;CONSTRAINT&nbsp;ALL'&nbsp;<BR>&nbsp;&nbsp;&nbsp;END&nbsp;<BR>EXEC&nbsp;(@SQLState)&nbsp;<BR>go&nbsp;</P>
<P>--&nbsp;For&nbsp;example:&nbsp;exec&nbsp;sp_ConstraintState&nbsp;&nbsp;'products',0&nbsp;&nbsp;<BR>will&nbsp;disable&nbsp;all&nbsp;constraints&nbsp;on&nbsp;the&nbsp;products&nbsp;table&nbsp;in&nbsp;northwind&nbsp;</P>
<P><BR>--&nbsp;PROCEDURE&nbsp;to&nbsp;disable/enable&nbsp;all&nbsp;constraints&nbsp;in&nbsp;an&nbsp;entire&nbsp;databse&nbsp;(using&nbsp;sp_constraintState)&nbsp;</P>
<P>&nbsp;Create&nbsp;proc&nbsp;sp_disable_all_const_in_db&nbsp;&nbsp;<BR>as&nbsp;<BR>&nbsp;&nbsp;'exec&nbsp;sp_MsForEachTable&nbsp;'sp_ConstraintState&nbsp;''?'',0&nbsp;<BR>go&nbsp;<BR>to&nbsp;disbale&nbsp;all&nbsp;constraints&nbsp;in&nbsp;the&nbsp;database&nbsp;&nbsp;</P>
<P>EXEC&nbsp;sp_disable_all_const_in_db&nbsp;</P></FONT>