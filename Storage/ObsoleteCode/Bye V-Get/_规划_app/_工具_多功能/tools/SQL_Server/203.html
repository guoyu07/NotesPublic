<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>去除外键的存储过程</B><BR>create&nbsp;proce&nbsp;prdropforeignkeys<BR>@chvreferencedtable&nbsp;varchar(30)<BR>as<BR>&nbsp;declare&nbsp;@chvtablewithforeignkey&nbsp;varchar(30),<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@chvforeignkey&nbsp;varchar(30),<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@chvsql&nbsp;varchar(255)<BR>declare&nbsp;cufks&nbsp;cursor&nbsp;for&nbsp;<BR>&nbsp;select&nbsp;&nbsp;tb.name,fk.name&nbsp;from&nbsp;<BR>((sysobject&nbsp;tb&nbsp;inner&nbsp;join&nbsp;sysreferences&nbsp;r&nbsp;on&nbsp;tb.id=r.fkeyid)<BR>&nbsp;&nbsp;inner&nbsp;join&nbsp;sysobjects&nbsp;fk&nbsp;on&nbsp;r.constid=fk.id)<BR>&nbsp;&nbsp;inner&nbsp;join&nbsp;sysobjects&nbsp;refd&nbsp;on&nbsp;refd_tb.id=r.rkeyid)<BR>&nbsp;where&nbsp;refd_tb.name=@chvreferencedtable<BR>&nbsp;open&nbsp;cufks<BR>&nbsp;fetch&nbsp;next&nbsp;from&nbsp;cufks&nbsp;into&nbsp;@chvtablewithforeignkey,@chvforeignkey 

<P></P>
<P>&nbsp;while&nbsp;(@@fetch_status&lt;&gt;-1)<BR>&nbsp;begin<BR>&nbsp;&nbsp;select&nbsp;@chvsql='alter&nbsp;table'+@chvtablewithforeignkey+<BR>&nbsp;&nbsp;&nbsp;&nbsp;'drop&nbsp;constraint&nbsp;'+@chvforeignkey<BR>&nbsp;&nbsp;exec(@chvsql)<BR>&nbsp;fetch&nbsp;next&nbsp;from&nbsp;cufks&nbsp;into&nbsp;@chvtablewithforeignkey,@chvforeignkey<BR>end<BR>&nbsp;deallocate&nbsp;cufks</P></FONT>