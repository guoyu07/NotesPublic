<meta http-equiv="content-type" content="text/html; charset=gb2312">&nbsp;<FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>替换text,ntext列中的字符串(不支持中文)</B><BR>author:amjn<BR>date:2003-03-28<BR>version:1.0<BR>function:替换text,ntext列中的字符串(不支持中文)<BR>*/<BR>declare&nbsp;@ptr&nbsp;varbinary(16)<BR>declare&nbsp;@amjnId&nbsp;int<BR>declare&nbsp;@Position&nbsp;int,@len&nbsp;int<BR>set&nbsp;@len=datalength('ILOVEHJL')&nbsp;&nbsp;&nbsp;&nbsp;<BR>declare&nbsp;wux_Cursor&nbsp;scroll&nbsp;Cursor<BR>for&nbsp;<BR>select&nbsp;textptr([Name]),[amjnId]&nbsp;from&nbsp;USA201<BR>for&nbsp;read&nbsp;only<BR>open&nbsp;wux_Cursor<BR>fetch&nbsp;next&nbsp;from&nbsp;wux_Cursor&nbsp;into&nbsp;@ptr,@amjnId<BR>while&nbsp;@@fetch_status=0<BR>begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@Position=patindex('%ILOVEHJL%',[Name])&nbsp;from&nbsp;USA201&nbsp;where&nbsp;[amjnId]=@amjnId<BR>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;@Position&gt;0<BR>&nbsp;&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@Position=@Position-1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updatetext&nbsp;USA201.[Name]&nbsp;@ptr&nbsp;@Position&nbsp;@len&nbsp;'i&nbsp;love&nbsp;hjl'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;@Position=patindex('%ILOVEHJL%',[Name])&nbsp;from&nbsp;USA201&nbsp;where&nbsp;[amjnId]=@amjnId<BR>&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;fetch&nbsp;next&nbsp;from&nbsp;wux_Cursor&nbsp;into&nbsp;@ptr,@amjnId<BR>end<BR>close&nbsp;wux_cursor<BR>deallocate&nbsp;wux_cursor<BR></FONT>