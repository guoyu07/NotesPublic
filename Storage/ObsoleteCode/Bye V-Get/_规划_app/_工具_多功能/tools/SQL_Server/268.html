<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>SQLServer数据库服务器名称的获取</B><BR>在窗口上放置一个listbox控件，命名为：listbox1，原代码如下所示：<BR>procedure&nbsp;TForm1.FormCreate(Sender:&nbsp;TObject);<BR>var<BR>&nbsp;&nbsp;SQLServer:Variant;<BR>&nbsp;&nbsp;ServerList:Variant;<BR>&nbsp;&nbsp;i,nServers:integer;<BR>begin<BR>&nbsp;SQLServer&nbsp;:=&nbsp;CreateOleObject('SQLDMO.Application');<BR>&nbsp;ServerList:=&nbsp;SQLServer.ListAvailableSQLServers;<BR>&nbsp;if&nbsp;serverlist.count&lt;1&nbsp;then<BR>&nbsp;&nbsp;begin&nbsp;//如果服务器不存在，则退出系统<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showmessage('服务器不存在，请检测服务器是否已经开机或者服务是否打开了');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;application.Terminate;<BR>&nbsp;&nbsp;end<BR>&nbsp;else<BR>&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;for&nbsp;i:=1&nbsp;to&nbsp;serverlist.count&nbsp;do<BR>&nbsp;&nbsp;&nbsp;listbox1.Items.Add(serverlist.item(i))&nbsp;;<BR>&nbsp;&nbsp;&nbsp;showmessage(serverlist.item(1)+'服务器已经打开，可以正常使用本系统');<BR>&nbsp;&nbsp;&nbsp;adoconnection1.ConnectionString:='Provider=SQLOLEDB.1;Persist&nbsp;Security&nbsp;info=False;UserID=sa;InitialCatalog=ideal_db;DataSource='+ServerList.Item(1);<BR>&nbsp;&nbsp;end;<BR>&nbsp;SQLServer:=NULL;<BR>&nbsp;serverList:=NULL;<BR>end;<BR></FONT>