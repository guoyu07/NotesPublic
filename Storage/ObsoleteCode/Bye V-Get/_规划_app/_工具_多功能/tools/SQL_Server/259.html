<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>Utilizing&nbsp;fn_virtualfilestats</B><BR>Utilizing&nbsp;::fn_virtualfilestats&nbsp;-&nbsp;Example<BR>&nbsp;
<P></P>
<P>In&nbsp;this&nbsp;example,&nbsp;we&nbsp;will&nbsp;attempt&nbsp;to&nbsp;get&nbsp;some&nbsp;statistical&nbsp;information&nbsp;on&nbsp;file-group&nbsp;utilisation&nbsp;to&nbsp;assist&nbsp;us&nbsp;with&nbsp;IO&nbsp;monitoring.&nbsp;&nbsp;&nbsp;The&nbsp;DBA&nbsp;should&nbsp;re-read&nbsp;the&nbsp;article&nbsp;¡°How&nbsp;to&nbsp;Diagnose&nbsp;and&nbsp;Fix&nbsp;Wait&nbsp;Stats¡±&nbsp;by&nbsp;Cathan&nbsp;Kirkwood&nbsp;before&nbsp;attempting&nbsp;to&nbsp;analyse&nbsp;the&nbsp;statistics&nbsp;returned&nbsp;for&nbsp;your&nbsp;particular&nbsp;database.</P>
<P>&nbsp;</P>
<P>The&nbsp;script&nbsp;below&nbsp;is&nbsp;very&nbsp;simple&nbsp;and&nbsp;is&nbsp;a&nbsp;starting&nbsp;point&nbsp;for&nbsp;a&nbsp;single&nbsp;stored&nbsp;procedure&nbsp;you&nbsp;can&nbsp;build&nbsp;in&nbsp;the&nbsp;future.&nbsp;&nbsp;The&nbsp;paradigm&nbsp;itself&nbsp;is&nbsp;simple&nbsp;enough.&nbsp;We&nbsp;will&nbsp;store&nbsp;every&nbsp;N&nbsp;seconds&nbsp;the&nbsp;results&nbsp;from&nbsp;::fn_virtualfilestats&nbsp;into&nbsp;a&nbsp;working&nbsp;table.&nbsp;&nbsp;We&nbsp;will&nbsp;then&nbsp;get&nbsp;the&nbsp;difference&nbsp;between&nbsp;the&nbsp;previous&nbsp;scan&nbsp;for&nbsp;each&nbsp;file-group&nbsp;within&nbsp;the&nbsp;selected&nbsp;database.&nbsp;&nbsp;From&nbsp;here&nbsp;we&nbsp;will&nbsp;utilise&nbsp;Analysis&nbsp;Services&nbsp;to&nbsp;build&nbsp;a&nbsp;cube&nbsp;and&nbsp;query&nbsp;the&nbsp;results&nbsp;through&nbsp;the&nbsp;Excel&nbsp;pivot&nbsp;control.</P>
<P>&nbsp;</P>
<P>The&nbsp;script&nbsp;I&nbsp;used&nbsp;is&nbsp;shown&nbsp;below;&nbsp;remembering&nbsp;that&nbsp;I&nbsp;was&nbsp;extremely&nbsp;lazy&nbsp;(hang&nbsp;on,&nbsp;make&nbsp;that&nbsp;¡°busy¡±)&nbsp;and&nbsp;did&nbsp;not&nbsp;write&nbsp;an&nbsp;generic&nbsp;routine.&nbsp;&nbsp;The&nbsp;routine&nbsp;was&nbsp;run&nbsp;via&nbsp;the&nbsp;tempdb&nbsp;database.</P>
<P>&nbsp;</P>
<P>--&nbsp;We&nbsp;have&nbsp;pre-queried&nbsp;sysdatabases&nbsp;and&nbsp;filegroups&nbsp;and&nbsp;will&nbsp;be&nbsp;monitoring&nbsp;as&nbsp;follows:</P>
<P>--&nbsp;dbid&nbsp;=&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>--&nbsp;1&nbsp;=&nbsp;system</P>
<P>--&nbsp;2&nbsp;=&nbsp;log</P>
<P>--&nbsp;3&nbsp;=&nbsp;data</P>
<P>--&nbsp;4&nbsp;=&nbsp;index</P>
<P>--&nbsp;5&nbsp;=&nbsp;audit</P>
<P>&nbsp;</P>
<P>--&nbsp;don¡¯t&nbsp;create&nbsp;it&nbsp;in&nbsp;the&nbsp;DB&nbsp;we&nbsp;are&nbsp;monitoring</P>
<P>drop&nbsp;table&nbsp;&nbsp;tempdb.ck_filestats&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;</P>
<P>--&nbsp;table&nbsp;to&nbsp;store&nbsp;out&nbsp;statistic&nbsp;data</P>
<P>create&nbsp;table&nbsp;ck_filestats&nbsp;(</P>
<P>id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;identity(1,1)&nbsp;clustered&nbsp;index,</P>
<P>dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int,</P>
<P>dbname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;varchar(50),</P>
<P>fileid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int,</P>
<P>[filegroup]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;varchar(150),</P>
<P>timestmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>numreads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>numreads_diff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>numwrites&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>numwrites_diff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>bytesread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>bytesread_diff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>byteswrite&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>byteswrite_diff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>iostallms&nbsp;bigint,</P>
<P>iostallms_diff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigint,</P>
<P>statstime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datetime&nbsp;default&nbsp;getdate()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>)</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>begin</P>
<P>declare&nbsp;@aa&nbsp;int</P>
<P>&nbsp;</P>
<P>set&nbsp;@aa=&nbsp;1440&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;approx&nbsp;4hrs&nbsp;of&nbsp;data&nbsp;collection&nbsp;every&nbsp;10&nbsp;seconds</P>
<P>&nbsp;</P>
<P>while&nbsp;@aa&nbsp;&gt;&nbsp;1&nbsp;begin</P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waitfor&nbsp;delay&nbsp;'00:00:10'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;10&nbsp;sec&nbsp;delay&nbsp;per&nbsp;looper</P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;get&nbsp;stats&nbsp;for&nbsp;file&nbsp;1</P>
<P></P>
<P>insert&nbsp;into&nbsp;ck_filestats&nbsp;(dbid,&nbsp;fileid,&nbsp;timestmp,&nbsp;numreads,&nbsp;numwrites,&nbsp;bytesread,&nbsp;byteswrite,&nbsp;iostallms)&nbsp;select&nbsp;*&nbsp;from&nbsp;::fn_virtualfilestats(5,1)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numreads_diff&nbsp;=&nbsp;ck_filestats.numreads&nbsp;-&nbsp;(select&nbsp;numreads&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>numwrites_diff&nbsp;=&nbsp;ck_filestats.numwrites&nbsp;-&nbsp;(select&nbsp;numwrites&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;<BR>where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>bytesread_diff&nbsp;=&nbsp;ck_filestats.bytesread&nbsp;-&nbsp;(select&nbsp;bytesread&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>byteswrite_diff&nbsp;=&nbsp;ck_filestats.byteswrite&nbsp;-&nbsp;(select&nbsp;byteswrite&nbsp;from&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>iostallms_diff&nbsp;=&nbsp;&nbsp;ck_filestats.iostallms&nbsp;-&nbsp;(select&nbsp;iostallms&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id))</P>
<P>where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbid&nbsp;=&nbsp;5&nbsp;and&nbsp;fileid&nbsp;=&nbsp;1&nbsp;and&nbsp;id&nbsp;=&nbsp;(select&nbsp;max(id)&nbsp;from&nbsp;ck_filestats&nbsp;C&nbsp;where&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;get&nbsp;stats&nbsp;for&nbsp;file&nbsp;2</P>
<P></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;into&nbsp;ck_filestats&nbsp;(dbid,&nbsp;fileid,&nbsp;timestmp,&nbsp;numreads,&nbsp;numwrites,&nbsp;bytesread,&nbsp;byteswrite,&nbsp;iostallms)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;::fn_virtualfilestats(5,2)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numreads_diff&nbsp;=&nbsp;ck_filestats.numreads&nbsp;-&nbsp;(select&nbsp;numreads&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numwrites_diff&nbsp;=&nbsp;ck_filestats.numwrites&nbsp;-&nbsp;(select&nbsp;numwrites&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytesread_diff&nbsp;=&nbsp;ck_filestats.bytesread&nbsp;-&nbsp;(select&nbsp;bytesread&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byteswrite_diff&nbsp;=&nbsp;ck_filestats.byteswrite&nbsp;-&nbsp;(select&nbsp;byteswrite&nbsp;from&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iostallms_diff&nbsp;=&nbsp;&nbsp;ck_filestats.iostallms&nbsp;-&nbsp;(select&nbsp;iostallms&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbid&nbsp;=&nbsp;5&nbsp;and&nbsp;fileid&nbsp;=&nbsp;2&nbsp;and&nbsp;id&nbsp;=&nbsp;(select&nbsp;max(id)&nbsp;from&nbsp;ck_filestats&nbsp;C&nbsp;where&nbsp;ck_filestats.dbid&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid)</P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;get&nbsp;stats&nbsp;for&nbsp;file&nbsp;3<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;into&nbsp;ck_filestats&nbsp;(dbid,&nbsp;fileid,&nbsp;timestmp,&nbsp;numreads,&nbsp;numwrites,&nbsp;bytesread,&nbsp;byteswrite,&nbsp;iostallms)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;::fn_virtualfilestats(5,3)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numreads_diff&nbsp;=&nbsp;ck_filestats.numreads&nbsp;-&nbsp;(select&nbsp;numreads&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numwrites_diff&nbsp;=&nbsp;ck_filestats.numwrites&nbsp;-&nbsp;(select&nbsp;numwrites&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytesread_diff&nbsp;=&nbsp;ck_filestats.bytesread&nbsp;-&nbsp;(select&nbsp;bytesread&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byteswrite_diff&nbsp;=&nbsp;ck_filestats.byteswrite&nbsp;-&nbsp;(select&nbsp;byteswrite&nbsp;from&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iostallms_diff&nbsp;=&nbsp;&nbsp;ck_filestats.iostallms&nbsp;-&nbsp;(select&nbsp;iostallms&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbid&nbsp;=&nbsp;5&nbsp;and&nbsp;fileid&nbsp;=&nbsp;3&nbsp;and&nbsp;id&nbsp;=&nbsp;(select&nbsp;max(id)&nbsp;from&nbsp;ck_filestats&nbsp;C&nbsp;where&nbsp;ck_filestats.dbid&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid)</P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;get&nbsp;stats&nbsp;for&nbsp;file&nbsp;4<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;into&nbsp;ck_filestats&nbsp;(dbid,&nbsp;fileid,&nbsp;timestmp,&nbsp;numreads,&nbsp;numwrites,&nbsp;bytesread,&nbsp;byteswrite,&nbsp;iostallms)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;::fn_virtualfilestats(5,4)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numreads_diff&nbsp;=&nbsp;ck_filestats.numreads&nbsp;-&nbsp;(select&nbsp;numreads&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numwrites_diff&nbsp;=&nbsp;ck_filestats.numwrites&nbsp;-&nbsp;(select&nbsp;numwrites&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytesread_diff&nbsp;=&nbsp;ck_filestats.bytesread&nbsp;-&nbsp;(select&nbsp;bytesread&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byteswrite_diff&nbsp;=&nbsp;ck_filestats.byteswrite&nbsp;-&nbsp;(select&nbsp;byteswrite&nbsp;from&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iostallms_diff&nbsp;=&nbsp;&nbsp;ck_filestats.iostallms&nbsp;-&nbsp;(select&nbsp;iostallms&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbid&nbsp;=&nbsp;5&nbsp;and&nbsp;fileid&nbsp;=&nbsp;4&nbsp;and&nbsp;id&nbsp;=&nbsp;(select&nbsp;max(id)&nbsp;from&nbsp;ck_filestats&nbsp;C&nbsp;where&nbsp;ck_filestats.dbid&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid)</P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;get&nbsp;stats&nbsp;for&nbsp;file&nbsp;5</P>
<P></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;into&nbsp;ck_filestats&nbsp;(dbid,&nbsp;fileid,&nbsp;timestmp,&nbsp;numreads,&nbsp;numwrites,&nbsp;bytesread,&nbsp;byteswrite,&nbsp;iostallms)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;::fn_virtualfilestats(5,5)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numreads_diff&nbsp;=&nbsp;ck_filestats.numreads&nbsp;-&nbsp;(select&nbsp;numreads&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numwrites_diff&nbsp;=&nbsp;ck_filestats.numwrites&nbsp;-&nbsp;(select&nbsp;numwrites&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytesread_diff&nbsp;=&nbsp;ck_filestats.bytesread&nbsp;-&nbsp;(select&nbsp;bytesread&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byteswrite_diff&nbsp;=&nbsp;ck_filestats.byteswrite&nbsp;-&nbsp;(select&nbsp;byteswrite&nbsp;from&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id)),</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iostallms_diff&nbsp;=&nbsp;&nbsp;ck_filestats.iostallms&nbsp;-&nbsp;(select&nbsp;iostallms&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.id&nbsp;=&nbsp;(select&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(id)&nbsp;from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ck_filestats.dbid&nbsp;=&nbsp;C.dbid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid&nbsp;and&nbsp;C.id&nbsp;&lt;&gt;&nbsp;ck_filestats.id))</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbid&nbsp;=&nbsp;5&nbsp;and&nbsp;fileid&nbsp;=&nbsp;5&nbsp;and&nbsp;id&nbsp;=&nbsp;(select&nbsp;max(id)&nbsp;from&nbsp;ck_filestats&nbsp;C&nbsp;where&nbsp;ck_filestats.dbid&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.dbid&nbsp;and&nbsp;ck_filestats.fileid&nbsp;=&nbsp;C.fileid)</P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@aa&nbsp;=&nbsp;@aa&nbsp;-&nbsp;1</P>
<P>end</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>--&nbsp;Manually&nbsp;upate&nbsp;the&nbsp;table,&nbsp;can&nbsp;be&nbsp;simply&nbsp;done&nbsp;by&nbsp;quering&nbsp;the&nbsp;sys&nbsp;tables</P>
<P>update&nbsp;ck_filestats&nbsp;set&nbsp;dbname&nbsp;=&nbsp;'MyDB¡¯</P>
<P>update&nbsp;ck_filestats&nbsp;set&nbsp;[filegroup]&nbsp;=&nbsp;'SYSTEM'&nbsp;where&nbsp;fileid&nbsp;=&nbsp;1</P>
<P>update&nbsp;ck_filestats&nbsp;set&nbsp;[filegroup]&nbsp;=&nbsp;'LOG'&nbsp;where&nbsp;fileid&nbsp;=&nbsp;2</P>
<P>update&nbsp;ck_filestats&nbsp;set&nbsp;[filegroup]&nbsp;=&nbsp;'CORPSYS'&nbsp;where&nbsp;fileid&nbsp;=&nbsp;3</P>
<P>update&nbsp;ck_filestats&nbsp;set&nbsp;[filegroup]&nbsp;=&nbsp;'DATA'&nbsp;where&nbsp;fileid&nbsp;=&nbsp;4</P>
<P>update&nbsp;ck_filestats&nbsp;set&nbsp;[filegroup]&nbsp;=&nbsp;'AUDIT'&nbsp;where&nbsp;fileid&nbsp;=&nbsp;5</P>
<P>&nbsp;</P>
<P>end</P>
<P>&nbsp;</P>
<P>Next&nbsp;we&nbsp;create&nbsp;a&nbsp;very&nbsp;simple&nbsp;OLAP&nbsp;cube.&nbsp;&nbsp;Once&nbsp;created,&nbsp;we&nbsp;will&nbsp;utilise&nbsp;the&nbsp;pivot&nbsp;table&nbsp;control&nbsp;in&nbsp;Excel&nbsp;to&nbsp;analyse&nbsp;the&nbsp;results.&nbsp;&nbsp;</P>
<P>&nbsp;</P>
<P>The&nbsp;ck_filestats&nbsp;table&nbsp;will&nbsp;be&nbsp;the&nbsp;fact&nbsp;table&nbsp;and&nbsp;will&nbsp;also&nbsp;drive&nbsp;the&nbsp;dimensions&nbsp;for&nbsp;the&nbsp;cube.&nbsp;&nbsp;The&nbsp;measures&nbsp;will&nbsp;be&nbsp;the&nbsp;&shy;_diff&nbsp;columns.&nbsp;&nbsp;The&nbsp;dimensions&nbsp;will&nbsp;include:</P>
<P>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time&nbsp;¨C&nbsp;broken&nbsp;down&nbsp;to&nbsp;hour&nbsp;and&nbsp;minute&nbsp;-&nbsp;(based&nbsp;on&nbsp;the&nbsp;statstime&nbsp;column)</P>
<P>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;database&nbsp;¨C&nbsp;not&nbsp;really&nbsp;required&nbsp;as&nbsp;we&nbsp;only&nbsp;have&nbsp;one&nbsp;-&nbsp;(based&nbsp;on&nbsp;dbname&nbsp;column)</P>
<P>c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;group&nbsp;¨C&nbsp;(based&nbsp;on&nbsp;[filegroup]&nbsp;column)</P>
<P>&nbsp;</P>
<P>To&nbsp;create&nbsp;the&nbsp;cube,&nbsp;run&nbsp;query&nbsp;analyser,&nbsp;select&nbsp;the&nbsp;foodmart&nbsp;sample&nbsp;cube&nbsp;database,&nbsp;and&nbsp;run&nbsp;the&nbsp;new&nbsp;cube&nbsp;wizard.<BR></P></FONT>