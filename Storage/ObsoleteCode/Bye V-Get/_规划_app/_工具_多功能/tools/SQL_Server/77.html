<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>×Ö·û´®-Using&nbsp;REPLACE</B><BR>Introduction&nbsp;<BR>Continuing&nbsp;on&nbsp;with&nbsp;taming&nbsp;strings.&nbsp;
<P></P>
<P>In&nbsp;Part&nbsp;1,&nbsp;I&nbsp;worked&nbsp;with&nbsp;phone&nbsp;numbers&nbsp;to&nbsp;find&nbsp;the&nbsp;area&nbsp;codes&nbsp;in&nbsp;phone&nbsp;number&nbsp;data.&nbsp;This&nbsp;data&nbsp;was&nbsp;in&nbsp;a&nbsp;variety&nbsp;of&nbsp;formats&nbsp;and&nbsp;frankly,&nbsp;quite&nbsp;a&nbsp;mess.&nbsp;Since&nbsp;we&nbsp;allowed&nbsp;users&nbsp;to&nbsp;enter&nbsp;data&nbsp;with&nbsp;very&nbsp;little&nbsp;validation,&nbsp;we&nbsp;got&nbsp;all&nbsp;sorts&nbsp;of&nbsp;invalid&nbsp;data&nbsp;as&nbsp;well&nbsp;as&nbsp;typos.&nbsp;Well,&nbsp;the&nbsp;time&nbsp;finally&nbsp;came&nbsp;for&nbsp;us&nbsp;to&nbsp;clean&nbsp;and&nbsp;validate&nbsp;as&nbsp;much&nbsp;phone&nbsp;data&nbsp;as&nbsp;possible,&nbsp;and&nbsp;so&nbsp;I&nbsp;decided&nbsp;to&nbsp;write&nbsp;about&nbsp;my&nbsp;little&nbsp;adventure.&nbsp;</P>
<P>The&nbsp;Problem&nbsp;<BR>Dealing&nbsp;with&nbsp;phone&nbsp;number&nbsp;data&nbsp;is&nbsp;more&nbsp;than&nbsp;a&nbsp;trivial&nbsp;exercise,&nbsp;both&nbsp;from&nbsp;the&nbsp;technical&nbsp;as&nbsp;well&nbsp;a&nbsp;business&nbsp;viewpoints.&nbsp;If&nbsp;you&nbsp;limit&nbsp;yourself&nbsp;to&nbsp;US&nbsp;phone&nbsp;numbers,&nbsp;then&nbsp;the&nbsp;problem&nbsp;is&nbsp;simplified,&nbsp;but&nbsp;still&nbsp;requires&nbsp;some&nbsp;work.&nbsp;In&nbsp;today's&nbsp;Internet,&nbsp;24x7&nbsp;uptime&nbsp;requirements,&nbsp;and&nbsp;international&nbsp;applications,&nbsp;I&nbsp;have&nbsp;seen&nbsp;this&nbsp;become&nbsp;less&nbsp;and&nbsp;less&nbsp;of&nbsp;an&nbsp;option,&nbsp;so&nbsp;I&nbsp;plan&nbsp;on&nbsp;designing&nbsp;the&nbsp;db&nbsp;to&nbsp;hold&nbsp;all&nbsp;kinds&nbsp;of&nbsp;information.&nbsp;Another&nbsp;article&nbsp;will&nbsp;tackle&nbsp;the&nbsp;database&nbsp;design&nbsp;side&nbsp;of&nbsp;storing&nbsp;phone&nbsp;data;&nbsp;this&nbsp;article&nbsp;looks&nbsp;at&nbsp;getting&nbsp;all&nbsp;the&nbsp;data&nbsp;in&nbsp;a&nbsp;standard&nbsp;format.&nbsp;</P>
<P>We&nbsp;had&nbsp;initially&nbsp;designed&nbsp;a&nbsp;single&nbsp;phone&nbsp;number&nbsp;field&nbsp;on&nbsp;forms&nbsp;as&nbsp;a&nbsp;way&nbsp;to&nbsp;handle&nbsp;all&nbsp;types&nbsp;of&nbsp;data&nbsp;in&nbsp;an&nbsp;ergonomic&nbsp;fashion.&nbsp;There&nbsp;was&nbsp;no&nbsp;validation&nbsp;of&nbsp;the&nbsp;data&nbsp;being&nbsp;entered&nbsp;so&nbsp;as&nbsp;to&nbsp;make&nbsp;the&nbsp;data&nbsp;entry&nbsp;as&nbsp;smooth&nbsp;as&nbsp;possible.&nbsp;The&nbsp;result&nbsp;of&nbsp;this&nbsp;was&nbsp;phone&nbsp;number&nbsp;data&nbsp;that&nbsp;looked&nbsp;like&nbsp;this:</P>
<P><BR>1-(520)-555-5821<BR>(904)555-1877<BR>2711&nbsp;5555458<BR>610-555-3723<BR>000<BR>6195557693<BR>11111111111111111<BR>(111)&nbsp;555-0986<BR>181-5554761<BR>31&nbsp;471&nbsp;55505<BR>31&nbsp;22555599<BR>1-800-555-9495<BR>415&nbsp;555&nbsp;3851<BR>+11455561022<BR>1603555775<BR>++492055599971<BR>407.555.4770<BR>555-6609<BR>202/555-2228<BR>248-555-8300*8263<BR>812-555-8444x312<BR>9999999<BR>1800555SOFT&nbsp;ext.&nbsp;132<BR>512/555-2000x2563<BR>(800)&nbsp;555-2588&nbsp;&nbsp;XT&nbsp;7<BR>none<BR>800-555-0963&nbsp;X90454</P>
<P>As&nbsp;you&nbsp;can&nbsp;see,&nbsp;there&nbsp;are&nbsp;a&nbsp;variety&nbsp;of&nbsp;formats&nbsp;in&nbsp;which&nbsp;data&nbsp;was&nbsp;entered&nbsp;(BTW,&nbsp;these&nbsp;are&nbsp;not&nbsp;real&nbsp;phone&nbsp;numbers,&nbsp;I&nbsp;scrambled&nbsp;quite&nbsp;a&nbsp;few&nbsp;of&nbsp;the&nbsp;numbers&nbsp;and&nbsp;made&nbsp;the&nbsp;exchanges&nbsp;555.&nbsp;If&nbsp;any&nbsp;of&nbsp;them&nbsp;actually&nbsp;work,&nbsp;I&nbsp;apologize&nbsp;in&nbsp;advance).&nbsp;Users&nbsp;have&nbsp;entered&nbsp;parenthesis,&nbsp;dashes,&nbsp;periods,&nbsp;+,&nbsp;etc.&nbsp;as&nbsp;delimiters&nbsp;for&nbsp;various&nbsp;sections&nbsp;of&nbsp;the&nbsp;phone&nbsp;numbers.&nbsp;The&nbsp;spacing,&nbsp;abbreviations,&nbsp;and&nbsp;formats&nbsp;vary&nbsp;from&nbsp;company&nbsp;to&nbsp;company&nbsp;(much&nbsp;to&nbsp;the&nbsp;chagrin&nbsp;of&nbsp;developers)&nbsp;and&nbsp;cry&nbsp;out&nbsp;for&nbsp;some&nbsp;standardization.&nbsp;However,&nbsp;forcing&nbsp;standardization&nbsp;during&nbsp;the&nbsp;data&nbsp;entry&nbsp;annoys&nbsp;and&nbsp;angers&nbsp;(&nbsp;and&nbsp;loses)&nbsp;users.&nbsp;My&nbsp;company&nbsp;finally&nbsp;came&nbsp;up&nbsp;with&nbsp;a&nbsp;standard&nbsp;data&nbsp;entry&nbsp;solution&nbsp;with&nbsp;some&nbsp;validation&nbsp;of&nbsp;data,&nbsp;but&nbsp;I&nbsp;needed&nbsp;to&nbsp;then&nbsp;standardize&nbsp;the&nbsp;existing&nbsp;data.&nbsp;</P>
<P>The&nbsp;technical&nbsp;solution&nbsp;to&nbsp;storing&nbsp;the&nbsp;data&nbsp;was&nbsp;to&nbsp;standardize&nbsp;the&nbsp;formatting&nbsp;and&nbsp;then&nbsp;include&nbsp;parsing&nbsp;routines&nbsp;in&nbsp;the&nbsp;application&nbsp;logic&nbsp;to&nbsp;handle&nbsp;the&nbsp;display&nbsp;and&nbsp;data&nbsp;entry.&nbsp;We&nbsp;decided&nbsp;a&nbsp;single&nbsp;field&nbsp;will&nbsp;contain&nbsp;the&nbsp;user&nbsp;entered&nbsp;data&nbsp;as&nbsp;numerics&nbsp;only&nbsp;with&nbsp;all&nbsp;other&nbsp;characters&nbsp;stripped&nbsp;out&nbsp;with&nbsp;one&nbsp;exception.&nbsp;For&nbsp;users&nbsp;that&nbsp;have&nbsp;a&nbsp;phone&nbsp;extension,&nbsp;we&nbsp;would&nbsp;include&nbsp;an&nbsp;"x"&nbsp;between&nbsp;the&nbsp;phone&nbsp;number&nbsp;and&nbsp;the&nbsp;extension.&nbsp;By&nbsp;standardizing&nbsp;on&nbsp;this&nbsp;format,&nbsp;all&nbsp;developers&nbsp;can&nbsp;expect&nbsp;a&nbsp;certain&nbsp;format&nbsp;and&nbsp;apply&nbsp;simpler&nbsp;parsing&nbsp;rules&nbsp;to&nbsp;format&nbsp;the&nbsp;data&nbsp;for&nbsp;display.&nbsp;</P>
<P>What&nbsp;String&nbsp;Manipulation?&nbsp;<BR>Here&nbsp;is&nbsp;a&nbsp;problem&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;solved,&nbsp;what&nbsp;does&nbsp;this&nbsp;have&nbsp;to&nbsp;do&nbsp;with&nbsp;string&nbsp;manipulation?&nbsp;After&nbsp;all,&nbsp;shouldn't&nbsp;the&nbsp;validation&nbsp;be&nbsp;occuring&nbsp;in&nbsp;the&nbsp;presentation&nbsp;or&nbsp;business&nbsp;layers?&nbsp;Couldn't&nbsp;I&nbsp;use&nbsp;a&nbsp;rule&nbsp;or&nbsp;user&nbsp;defined&nbsp;datatype&nbsp;to&nbsp;standardize&nbsp;the&nbsp;system?&nbsp;</P>
<P>Patience,&nbsp;patience,&nbsp;all&nbsp;will&nbsp;be&nbsp;clear&nbsp;soon.&nbsp;</P>
<P>In&nbsp;order&nbsp;to&nbsp;clean&nbsp;this&nbsp;data,&nbsp;I&nbsp;will&nbsp;be&nbsp;using&nbsp;string&nbsp;manipulation&nbsp;to&nbsp;reformat&nbsp;all&nbsp;the&nbsp;existing&nbsp;phone&nbsp;data&nbsp;in&nbsp;the&nbsp;standard&nbsp;format.&nbsp;Regardless&nbsp;of&nbsp;future&nbsp;validation&nbsp;and&nbsp;schema&nbsp;changes,&nbsp;I&nbsp;would&nbsp;still&nbsp;have&nbsp;to&nbsp;get&nbsp;the&nbsp;existing&nbsp;data&nbsp;into&nbsp;a&nbsp;standard&nbsp;format&nbsp;to&nbsp;ensure&nbsp;the&nbsp;application&nbsp;works.&nbsp;</P>
<P>Now&nbsp;it&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;write&nbsp;one&nbsp;SQL&nbsp;statement&nbsp;that&nbsp;would&nbsp;rip&nbsp;through&nbsp;the&nbsp;data&nbsp;and&nbsp;reformat&nbsp;all&nbsp;the&nbsp;data&nbsp;as&nbsp;expected.&nbsp;A&nbsp;couple&nbsp;problems&nbsp;with&nbsp;this;&nbsp;one,&nbsp;it&nbsp;would&nbsp;be&nbsp;difficult&nbsp;to&nbsp;explain&nbsp;in&nbsp;an&nbsp;article.&nbsp;Two,&nbsp;it&nbsp;would&nbsp;probably&nbsp;take&nbsp;more&nbsp;time&nbsp;to&nbsp;decipher&nbsp;than&nbsp;most&nbsp;of&nbsp;you&nbsp;would&nbsp;want&nbsp;to&nbsp;spend.&nbsp;Three,&nbsp;I&nbsp;can't&nbsp;come&nbsp;up&nbsp;with&nbsp;one.&nbsp;Since&nbsp;reason&nbsp;three&nbsp;will&nbsp;tend&nbsp;to&nbsp;override&nbsp;reasons&nbsp;one&nbsp;and&nbsp;two&nbsp;in&nbsp;anything&nbsp;I&nbsp;write,&nbsp;here&nbsp;is&nbsp;what&nbsp;I&nbsp;came&nbsp;up&nbsp;with.&nbsp;</P>
<P>Since&nbsp;I&nbsp;try&nbsp;to&nbsp;avoid&nbsp;row&nbsp;processing&nbsp;which&nbsp;is&nbsp;slow&nbsp;and&nbsp;the&nbsp;kind&nbsp;of&nbsp;thing&nbsp;I&nbsp;usually&nbsp;chastise&nbsp;junior&nbsp;DBAs&nbsp;for&nbsp;implementing,&nbsp;I&nbsp;decided&nbsp;to&nbsp;look&nbsp;for&nbsp;patterns&nbsp;which&nbsp;would&nbsp;enable&nbsp;me&nbsp;to&nbsp;develop&nbsp;an&nbsp;algorithm&nbsp;to&nbsp;clean&nbsp;up&nbsp;this&nbsp;data.&nbsp;I&nbsp;made&nbsp;notes&nbsp;as&nbsp;I&nbsp;conducted&nbsp;the&nbsp;analysis&nbsp;so&nbsp;that&nbsp;I&nbsp;could&nbsp;present&nbsp;readers&nbsp;with&nbsp;some&nbsp;insight&nbsp;into&nbsp;how&nbsp;I&nbsp;go&nbsp;about&nbsp;solving&nbsp;a&nbsp;problem&nbsp;or&nbsp;developing&nbsp;a&nbsp;solution.&nbsp;</P>
<P>Analysis<BR>The&nbsp;first&nbsp;thing&nbsp;I&nbsp;do&nbsp;when&nbsp;solving&nbsp;most&nbsp;problems&nbsp;is&nbsp;look&nbsp;for&nbsp;a&nbsp;pattern.&nbsp;After&nbsp;all,&nbsp;computers&nbsp;are&nbsp;very&nbsp;good&nbsp;at&nbsp;performing&nbsp;repetitive&nbsp;actions&nbsp;and&nbsp;SQL&nbsp;is&nbsp;especially&nbsp;well&nbsp;suited&nbsp;to&nbsp;working&nbsp;with&nbsp;a&nbsp;batch&nbsp;of&nbsp;data.&nbsp;In&nbsp;my&nbsp;examination&nbsp;of&nbsp;the&nbsp;data,&nbsp;I&nbsp;found&nbsp;that&nbsp;most&nbsp;data&nbsp;was&nbsp;basically&nbsp;in&nbsp;one&nbsp;of&nbsp;a&nbsp;few&nbsp;formats:</P>
<P><BR>&nbsp;999&nbsp;999-9999<BR>&nbsp;(999)&nbsp;999-9999<BR>&nbsp;999-999-9999</P>
<P>and&nbsp;the&nbsp;extensions&nbsp;tended&nbsp;to&nbsp;look&nbsp;like:</P>
<P>&nbsp;x999<BR>&nbsp;x.999<BR>&nbsp;ext&nbsp;999<BR>&nbsp;ext.999</P>
<P>The&nbsp;rest&nbsp;of&nbsp;the&nbsp;data&nbsp;is&nbsp;pretty&nbsp;close&nbsp;to&nbsp;these&nbsp;formats&nbsp;with&nbsp;some&nbsp;variations&nbsp;(more&nbsp;or&nbsp;less&nbsp;spaces,&nbsp;+xx&nbsp;for&nbsp;international&nbsp;numbers,&nbsp;some&nbsp;people&nbsp;entered&nbsp;slashes&nbsp;("/")&nbsp;or&nbsp;periods&nbsp;(".")&nbsp;or&nbsp;some&nbsp;other&nbsp;character,&nbsp;but&nbsp;since&nbsp;I&nbsp;may&nbsp;end&nbsp;up&nbsp;handling&nbsp;these&nbsp;individually&nbsp;or&nbsp;as&nbsp;"one-offs"&nbsp;(things&nbsp;that&nbsp;do&nbsp;not&nbsp;fit&nbsp;a&nbsp;pattern&nbsp;or&nbsp;are&nbsp;an&nbsp;exception),&nbsp;I&nbsp;will&nbsp;ignore&nbsp;these&nbsp;for&nbsp;now.&nbsp;</P>
<P>The&nbsp;format&nbsp;that&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;standardize&nbsp;all&nbsp;data&nbsp;into&nbsp;is&nbsp;the&nbsp;following:</P>
<P><BR>9999999999x9999</P>
<P>where&nbsp;all&nbsp;non-numeric&nbsp;characters&nbsp;and&nbsp;spaces&nbsp;are&nbsp;removed.&nbsp;Actually&nbsp;spaces&nbsp;are&nbsp;not&nbsp;important&nbsp;for&nbsp;the&nbsp;parsing&nbsp;routines&nbsp;we&nbsp;employ,&nbsp;so&nbsp;I&nbsp;will&nbsp;ignore&nbsp;embedded&nbsp;spaces,&nbsp;but&nbsp;I&nbsp;think&nbsp;you&nbsp;will&nbsp;be&nbsp;able&nbsp;to&nbsp;adapt&nbsp;my&nbsp;solution&nbsp;easily&nbsp;to&nbsp;remove&nbsp;them.&nbsp;</P>
<P>Back&nbsp;to&nbsp;the&nbsp;analysis...&nbsp;</P>
<P>There&nbsp;are&nbsp;multiple&nbsp;places&nbsp;in&nbsp;the&nbsp;field&nbsp;where&nbsp;each&nbsp;non-numeric&nbsp;character&nbsp;can&nbsp;occur.&nbsp;I&nbsp;could&nbsp;write&nbsp;a&nbsp;series&nbsp;of&nbsp;substring&nbsp;updates&nbsp;(like&nbsp;in&nbsp;Part&nbsp;1),&nbsp;but&nbsp;this&nbsp;would&nbsp;be&nbsp;quite&nbsp;a&nbsp;bit&nbsp;of&nbsp;work,&nbsp;lots&nbsp;and&nbsp;lots&nbsp;of&nbsp;statements,&nbsp;and&nbsp;probably&nbsp;not&nbsp;of&nbsp;interest&nbsp;to&nbsp;any&nbsp;of&nbsp;you.&nbsp;As&nbsp;I&nbsp;examine&nbsp;the&nbsp;data,&nbsp;what&nbsp;I&nbsp;really&nbsp;want&nbsp;to&nbsp;do&nbsp;is&nbsp;remove&nbsp;all&nbsp;the&nbsp;dashes&nbsp;(&nbsp;or&nbsp;other&nbsp;characters)&nbsp;from&nbsp;the&nbsp;field.&nbsp;</P>
<P>So&nbsp;how&nbsp;can&nbsp;we&nbsp;remove&nbsp;the&nbsp;parenthesis,&nbsp;dashes,&nbsp;and&nbsp;periods&nbsp;from&nbsp;the&nbsp;phone&nbsp;numbers?&nbsp;One&nbsp;way&nbsp;that&nbsp;I&nbsp;think&nbsp;should&nbsp;work&nbsp;is&nbsp;a&nbsp;simple&nbsp;CONVERT&nbsp;or&nbsp;CAST&nbsp;of&nbsp;the&nbsp;field&nbsp;to&nbsp;an&nbsp;integer&nbsp;value.&nbsp;If&nbsp;I&nbsp;run&nbsp;the&nbsp;following,</P>
<P><BR>&nbsp;select&nbsp;cast(&nbsp;'(555)&nbsp;555-5555'&nbsp;as&nbsp;int)</P>
<P>I&nbsp;would&nbsp;expect&nbsp;to&nbsp;get:</P>
<P>&nbsp;5555555555</P>
<P>but&nbsp;instead,&nbsp;I&nbsp;get:<BR>Server:&nbsp;Msg&nbsp;245,&nbsp;Level&nbsp;16,&nbsp;State&nbsp;1,&nbsp;Line&nbsp;1</P>
<P>Syntax&nbsp;error&nbsp;converting&nbsp;the&nbsp;varchar&nbsp;value&nbsp;'(555)&nbsp;555-55555'&nbsp;to&nbsp;a&nbsp;column&nbsp;of&nbsp;data&nbsp;type&nbsp;int.</P>
<P>Why&nbsp;this&nbsp;occurs,&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;(if&nbsp;you&nbsp;are&nbsp;on&nbsp;the&nbsp;SQL&nbsp;Server&nbsp;team,&nbsp;let&nbsp;me&nbsp;know),&nbsp;but&nbsp;it&nbsp;does&nbsp;not.&nbsp;SUBSTRING&nbsp;is&nbsp;not&nbsp;a&nbsp;great&nbsp;option,&nbsp;so&nbsp;I&nbsp;decided&nbsp;to&nbsp;search&nbsp;BOL&nbsp;a&nbsp;little&nbsp;and&nbsp;see&nbsp;what&nbsp;my&nbsp;options&nbsp;were.&nbsp;</P>
<P>The&nbsp;Solution&nbsp;<BR>The&nbsp;first&nbsp;thing&nbsp;I&nbsp;saw&nbsp;in&nbsp;BOL&nbsp;which&nbsp;looked&nbsp;promising&nbsp;was&nbsp;PATINDEX&nbsp;which&nbsp;lets&nbsp;you&nbsp;find&nbsp;the&nbsp;location&nbsp;of&nbsp;a&nbsp;particular&nbsp;string&nbsp;within&nbsp;another&nbsp;string.&nbsp;This&nbsp;along&nbsp;with&nbsp;CHARINDEX&nbsp;(see&nbsp;Part&nbsp;2)&nbsp;is&nbsp;useful&nbsp;for&nbsp;finding&nbsp;the&nbsp;location&nbsp;of&nbsp;a&nbsp;pattern&nbsp;within&nbsp;a&nbsp;string.&nbsp;I&nbsp;suppose&nbsp;I&nbsp;could&nbsp;have&nbsp;used&nbsp;this&nbsp;and&nbsp;then&nbsp;written&nbsp;a&nbsp;bunch&nbsp;of&nbsp;substrings&nbsp;that&nbsp;would&nbsp;concatenate&nbsp;the&nbsp;before&nbsp;and&nbsp;after&nbsp;portions&nbsp;of&nbsp;the&nbsp;string,&nbsp;but&nbsp;this&nbsp;did&nbsp;not&nbsp;seem&nbsp;very&nbsp;efficient&nbsp;either.&nbsp;</P>
<P>It&nbsp;was&nbsp;around&nbsp;this&nbsp;time&nbsp;that&nbsp;one&nbsp;of&nbsp;our&nbsp;senior&nbsp;developers&nbsp;was&nbsp;doing&nbsp;some&nbsp;data&nbsp;cleaning&nbsp;and&nbsp;sent&nbsp;me&nbsp;a&nbsp;script&nbsp;to&nbsp;execute&nbsp;on&nbsp;the&nbsp;production&nbsp;database.&nbsp;This&nbsp;script&nbsp;contained&nbsp;a&nbsp;series&nbsp;of&nbsp;SQL&nbsp;statements&nbsp;in&nbsp;a&nbsp;batch&nbsp;that&nbsp;ran&nbsp;REPLACE&nbsp;to&nbsp;change&nbsp;the&nbsp;wording&nbsp;in&nbsp;a&nbsp;number&nbsp;of&nbsp;rows&nbsp;in&nbsp;a&nbsp;particular&nbsp;table.&nbsp;The&nbsp;idea&nbsp;then&nbsp;came&nbsp;to&nbsp;me&nbsp;that&nbsp;I&nbsp;could&nbsp;use&nbsp;this&nbsp;function&nbsp;to&nbsp;quickly&nbsp;remove&nbsp;all&nbsp;the&nbsp;non-numeric&nbsp;characters&nbsp;in&nbsp;my&nbsp;data!&nbsp;</P>
<P>The&nbsp;Code&nbsp;<BR>The&nbsp;REPLACE&nbsp;function&nbsp;is&nbsp;very&nbsp;powerful&nbsp;and&nbsp;is&nbsp;used&nbsp;to&nbsp;do&nbsp;exactly&nbsp;what&nbsp;you&nbsp;would&nbsp;expect&nbsp;it&nbsp;to&nbsp;do.&nbsp;It&nbsp;searches&nbsp;a&nbsp;string&nbsp;for&nbsp;some&nbsp;other&nbsp;string&nbsp;that&nbsp;you&nbsp;supply&nbsp;(much&nbsp;like&nbsp;CHARINDEX&nbsp;and&nbsp;PATINDEX),&nbsp;but&nbsp;replaces&nbsp;the&nbsp;second&nbsp;string&nbsp;with&nbsp;a&nbsp;third&nbsp;string&nbsp;that&nbsp;you&nbsp;supply.&nbsp;So&nbsp;if&nbsp;you&nbsp;ran&nbsp;the&nbsp;following&nbsp;code:</P>
<P><BR>declare&nbsp;@a&nbsp;char(&nbsp;30)<BR>select&nbsp;@a&nbsp;=&nbsp;'Bob&nbsp;and&nbsp;Jim&nbsp;played&nbsp;catch.'<BR>select&nbsp;@a,&nbsp;replace(&nbsp;@a,&nbsp;'Jim',&nbsp;'Jeff')</P>
<P>You&nbsp;get</P>
<P>---------------------------&nbsp;&nbsp;---------------------------<BR>Bob&nbsp;and&nbsp;Jim&nbsp;played&nbsp;catch.&nbsp;&nbsp;&nbsp;&nbsp;Bob&nbsp;and&nbsp;Jeff&nbsp;played&nbsp;catch.</P>
<P>As&nbsp;you&nbsp;can&nbsp;see,&nbsp;the&nbsp;first&nbsp;string,&nbsp;@a,&nbsp;is&nbsp;searched&nbsp;for&nbsp;any&nbsp;occurence&nbsp;of&nbsp;the&nbsp;second&nbsp;string,&nbsp;"Jim".&nbsp;If&nbsp;an&nbsp;occurence&nbsp;is&nbsp;found,&nbsp;then&nbsp;it&nbsp;is&nbsp;replaced&nbsp;with&nbsp;the&nbsp;third&nbsp;string,&nbsp;"Jeff".&nbsp;</P>
<P>To&nbsp;apply&nbsp;this&nbsp;to&nbsp;my&nbsp;phone&nbsp;number&nbsp;problem,&nbsp;I&nbsp;decided&nbsp;to&nbsp;write&nbsp;a&nbsp;series&nbsp;of&nbsp;statements&nbsp;that&nbsp;would&nbsp;replace&nbsp;the&nbsp;characters&nbsp;I&nbsp;wanted&nbsp;removed.&nbsp;The&nbsp;three&nbsp;obvious&nbsp;characters&nbsp;I&nbsp;wanted&nbsp;to&nbsp;remove&nbsp;were&nbsp;the&nbsp;dashes,&nbsp;paranthesis,&nbsp;and&nbsp;periods.&nbsp;Actually&nbsp;these&nbsp;are&nbsp;four&nbsp;characters&nbsp;and&nbsp;I&nbsp;ended&nbsp;up&nbsp;with&nbsp;the&nbsp;following&nbsp;script:</P>
<P><BR>update&nbsp;UserInfo<BR>&nbsp;&nbsp;set&nbsp;phone&nbsp;=&nbsp;replace(&nbsp;phone,&nbsp;'-',&nbsp;'')<BR>update&nbsp;UserInfo<BR>&nbsp;&nbsp;set&nbsp;phone&nbsp;=&nbsp;replace(&nbsp;phone,&nbsp;'(',&nbsp;'')<BR>update&nbsp;UserInfo<BR>&nbsp;&nbsp;set&nbsp;phone&nbsp;=&nbsp;replace(&nbsp;phone,&nbsp;')',&nbsp;'')<BR>update&nbsp;UserInfo<BR>&nbsp;&nbsp;set&nbsp;phone&nbsp;=&nbsp;replace(&nbsp;phone,&nbsp;'.',&nbsp;'')</P>
<P>One&nbsp;thing&nbsp;that&nbsp;many&nbsp;people&nbsp;do&nbsp;not&nbsp;know&nbsp;about&nbsp;many&nbsp;functions&nbsp;(at&nbsp;least&nbsp;I&nbsp;am&nbsp;surprised&nbsp;how&nbsp;many&nbsp;people&nbsp;do&nbsp;not&nbsp;know)&nbsp;is&nbsp;that&nbsp;you&nbsp;can&nbsp;often&nbsp;use&nbsp;an&nbsp;empty&nbsp;string&nbsp;wherever&nbsp;a&nbsp;character&nbsp;parameter&nbsp;is&nbsp;called&nbsp;for.&nbsp;In&nbsp;this&nbsp;case,&nbsp;substituting&nbsp;an&nbsp;empty&nbsp;string&nbsp;as&nbsp;the&nbsp;replacement&nbsp;character&nbsp;allows&nbsp;me&nbsp;to&nbsp;remove&nbsp;offending&nbsp;characters.&nbsp;</P>
<P>Conclusions&nbsp;<BR>There&nbsp;are&nbsp;more&nbsp;possible&nbsp;solutions&nbsp;for&nbsp;solving&nbsp;this&nbsp;problem,&nbsp;but&nbsp;some&nbsp;are&nbsp;better&nbsp;left&nbsp;to&nbsp;another&nbsp;article.&nbsp;I&nbsp;hope&nbsp;this&nbsp;has&nbsp;helped&nbsp;some&nbsp;of&nbsp;you&nbsp;understand&nbsp;how&nbsp;to&nbsp;manipulate&nbsp;and&nbsp;clean&nbsp;data&nbsp;a&nbsp;little&nbsp;better&nbsp;as&nbsp;well&nbsp;as&nbsp;sparked&nbsp;some&nbsp;ideas&nbsp;for&nbsp;even&nbsp;better&nbsp;solutions.&nbsp;My&nbsp;solution&nbsp;worked&nbsp;well&nbsp;and&nbsp;was&nbsp;set&nbsp;based&nbsp;so&nbsp;it&nbsp;was&nbsp;somewhat&nbsp;efficient&nbsp;as&nbsp;well.&nbsp;</P>
<P>For&nbsp;those&nbsp;of&nbsp;you&nbsp;interested&nbsp;in&nbsp;further&nbsp;information&nbsp;about&nbsp;REPLACE,&nbsp;here&nbsp;is&nbsp;the&nbsp;URL&nbsp;for&nbsp;the&nbsp;online&nbsp;reference&nbsp;for&nbsp;REPLACE&nbsp;</P>
<P>As&nbsp;always,&nbsp;I&nbsp;welcome&nbsp;feedback&nbsp;and&nbsp;please&nbsp;rate&nbsp;this&nbsp;article&nbsp;below&nbsp;(and&nbsp;any&nbsp;you&nbsp;read&nbsp;on&nbsp;Swynk).&nbsp;It&nbsp;helps&nbsp;to&nbsp;motivate&nbsp;and&nbsp;assist&nbsp;us&nbsp;authors&nbsp;in&nbsp;writing&nbsp;better&nbsp;columns.&nbsp;</P>
<P>Steve&nbsp;Jones<BR>December&nbsp;2000</P></FONT>