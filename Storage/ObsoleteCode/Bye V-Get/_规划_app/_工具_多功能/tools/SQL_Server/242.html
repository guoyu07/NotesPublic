<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>GetSPTrigValues</B><BR>Version:&nbsp;SQL&nbsp;Server&nbsp;7.0/2000<BR>Created&nbsp;by:&nbsp;Alexander&nbsp;Chigrik
<P></P>
<P>This&nbsp;stored&nbsp;procedure&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;return&nbsp;the&nbsp;names&nbsp;of&nbsp;each&nbsp;view,<BR>rule,&nbsp;default,&nbsp;trigger,&nbsp;CHECK&nbsp;constraint,&nbsp;DEFAULT&nbsp;constraint,&nbsp;and<BR>stored&nbsp;procedure,&nbsp;which&nbsp;contain&nbsp;the&nbsp;particular&nbsp;text&nbsp;value.<BR>You&nbsp;should&nbsp;pass&nbsp;the&nbsp;database&nbsp;name&nbsp;and&nbsp;the&nbsp;text&nbsp;value&nbsp;to&nbsp;search,<BR>as&nbsp;in&nbsp;the&nbsp;example&nbsp;below:</P>
<P>EXEC&nbsp;GetSPTrigvalues&nbsp;@dbname&nbsp;=&nbsp;'pubs',&nbsp;@txtvalue&nbsp;=&nbsp;'sales'</P>
<P>/*<BR>Version:&nbsp;SQL&nbsp;Server&nbsp;7.0/2000<BR>Created&nbsp;by:&nbsp;Alexander&nbsp;Chigrik<BR><IMG 
src="http://www.pigtwo.com/forum/pic/url.gif" align=absMiddle border=0><A href="http://www.MSSQLCity.com/" 
target=_blank>http://www.MSSQLCity.com/</A>&nbsp;-&nbsp;all&nbsp;about&nbsp;MS&nbsp;SQL<BR>(SQL&nbsp;Server&nbsp;Articles,&nbsp;FAQ,&nbsp;Scripts,&nbsp;Tips&nbsp;and&nbsp;Test&nbsp;Exams).</P>
<P>This&nbsp;stored&nbsp;procedure&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;return&nbsp;the&nbsp;names&nbsp;of&nbsp;each&nbsp;view,<BR>rule,&nbsp;default,&nbsp;trigger,&nbsp;CHECK&nbsp;constraint,&nbsp;DEFAULT&nbsp;constraint,&nbsp;and<BR>stored&nbsp;procedure,&nbsp;which&nbsp;contain&nbsp;the&nbsp;particular&nbsp;text&nbsp;value.<BR>You&nbsp;should&nbsp;pass&nbsp;the&nbsp;database&nbsp;name&nbsp;and&nbsp;the&nbsp;text&nbsp;value&nbsp;to&nbsp;search,&nbsp;<BR>as&nbsp;in&nbsp;the&nbsp;example&nbsp;below<BR>(if&nbsp;the&nbsp;database&nbsp;name&nbsp;was&nbsp;not&nbsp;specified,&nbsp;the&nbsp;current&nbsp;database&nbsp;will&nbsp;be&nbsp;used):</P>
<P>EXEC&nbsp;GetSPTrigvalues&nbsp;@dbname&nbsp;=&nbsp;'pubs',&nbsp;@txtvalue&nbsp;=&nbsp;'sales'<BR>*/</P>
<P>IF&nbsp;OBJECT_ID('GetSPTrigvalues')&nbsp;IS&nbsp;NOT&nbsp;NULL&nbsp;DROP&nbsp;PROC&nbsp;GetSPTrigvalues<BR>GO</P>
<P>CREATE&nbsp;PROCEDURE&nbsp;GetSPTrigvalues&nbsp;(<BR>&nbsp;&nbsp;@dbname&nbsp;sysname&nbsp;=&nbsp;null,<BR>&nbsp;&nbsp;@txtvalue&nbsp;varchar(128)&nbsp;=&nbsp;null<BR>)<BR>AS<BR>DECLARE&nbsp;@execstr&nbsp;varchar(1000)</P>
<P>SET&nbsp;NOCOUNT&nbsp;ON<BR>IF&nbsp;@txtvalue&nbsp;IS&nbsp;NULL<BR>&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;RAISERROR&nbsp;('You&nbsp;must&nbsp;specify&nbsp;the&nbsp;value&nbsp;to&nbsp;search',&nbsp;16,&nbsp;1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;RETURN<BR>&nbsp;&nbsp;END</P>
<P>IF&nbsp;@dbname&nbsp;IS&nbsp;NULL&nbsp;SET&nbsp;@dbname&nbsp;=&nbsp;DB_NAME()<BR>SET&nbsp;@execstr&nbsp;=&nbsp;'USE&nbsp;'+&nbsp;@dbname&nbsp;+&nbsp;'&nbsp;SELECT&nbsp;name&nbsp;as&nbsp;ObjectName,&nbsp;ObjectType&nbsp;=&nbsp;CASE&nbsp;type&nbsp;WHEN&nbsp;''C''&nbsp;THEN&nbsp;''CHECK&nbsp;constraint''&nbsp;WHEN&nbsp;''D''&nbsp;THEN&nbsp;''Default&nbsp;or&nbsp;DEFAULT&nbsp;constraint''&nbsp;WHEN&nbsp;''F''&nbsp;THEN&nbsp;''FOREIGN&nbsp;KEY&nbsp;constraint''&nbsp;WHEN&nbsp;''K''&nbsp;THEN&nbsp;''PRIMARY&nbsp;KEY&nbsp;or&nbsp;UNIQUE&nbsp;constraint''&nbsp;WHEN&nbsp;''L''&nbsp;THEN&nbsp;''Log''&nbsp;WHEN&nbsp;''P''&nbsp;THEN&nbsp;''Stored&nbsp;procedure''&nbsp;WHEN&nbsp;''R''&nbsp;THEN&nbsp;''Rule''&nbsp;WHEN&nbsp;''RF''&nbsp;THEN&nbsp;''Stored&nbsp;procedure&nbsp;for&nbsp;replication''&nbsp;WHEN&nbsp;''S''&nbsp;THEN&nbsp;''System&nbsp;table''&nbsp;WHEN&nbsp;''TR''&nbsp;THEN&nbsp;''Trigger''&nbsp;WHEN&nbsp;''U''&nbsp;THEN&nbsp;''User&nbsp;table''&nbsp;WHEN&nbsp;''V''&nbsp;THEN&nbsp;''View''&nbsp;WHEN&nbsp;''X''&nbsp;THEN&nbsp;''Extended&nbsp;stored&nbsp;procedure''&nbsp;END&nbsp;&nbsp;FROM&nbsp;sysobjects&nbsp;a&nbsp;JOIN&nbsp;syscomments&nbsp;b&nbsp;ON&nbsp;a.id&nbsp;=&nbsp;b.id&nbsp;AND&nbsp;text&nbsp;LIKE&nbsp;''%'&nbsp;+&nbsp;@txtvalue&nbsp;+&nbsp;'%'''<BR>EXEC&nbsp;(@execstr)<BR>GO</P></FONT>