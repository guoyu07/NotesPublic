<meta http-equiv="content-type" content="text/html; charset=gb2312"><FONT 
style="FONT-SIZE: 9pt; LINE-HEIGHT: 15pt"><B>动态SQL四种类型的语句格式(潇湘剑公子)</B><BR>1.Dynamic&nbsp;SQL&nbsp;Format&nbsp;1
<P></P>
<P>EXECUTE&nbsp;IMMEDIATE&nbsp;SQLStatement&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{USING&nbsp;TransactionObject}&nbsp;;</P>
<P>eg:<BR>string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mysql<BR>Mysql&nbsp;=&nbsp;"CREATE&nbsp;TABLE&nbsp;Employee&nbsp;"&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;+"(emp_id&nbsp;integer&nbsp;not&nbsp;null,"&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;+"dept_id&nbsp;integer&nbsp;not&nbsp;null,&nbsp;"&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;+"emp_fname&nbsp;char(10)&nbsp;not&nbsp;null,&nbsp;"&amp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;+"emp_lname&nbsp;char(20)&nbsp;not&nbsp;null)"<BR>EXECUTE&nbsp;IMMEDIATE&nbsp;:Mysql&nbsp;;</P>
<P>2.Dynamic&nbsp;SQL&nbsp;Format&nbsp;2</P>
<P>PREPARE&nbsp;DynamicStagingArea&nbsp;FROM&nbsp;SQLStatement&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{USING&nbsp;TransactionObject}&nbsp;;<BR>EXECUTE&nbsp;DynamicStagingArea&nbsp;USING&nbsp;{ParameterList}&nbsp;;</P>
<P>eg:<BR>INT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emp_id_var&nbsp;=&nbsp;56<BR>PREPARE&nbsp;SQLSA&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;"DELETE&nbsp;FROM&nbsp;employee&nbsp;WHERE&nbsp;emp_id=?"&nbsp;;<BR>EXECUTE&nbsp;SQLSA&nbsp;USING&nbsp;:Emp_id_var&nbsp;;</P>
<P><BR>3.Dynamic&nbsp;SQL&nbsp;Format&nbsp;3</P>
<P>DECLARE&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNAMIC&nbsp;CURSOR&nbsp;|&nbsp;PROCEDURE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;DynamicStagingArea&nbsp;;<BR>PREPARE&nbsp;DynamicStagingArea&nbsp;FROM&nbsp;SQLStatement&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{USING&nbsp;TransactionObject}&nbsp;;<BR>OPEN&nbsp;DYNAMIC&nbsp;Cursor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{USING&nbsp;ParameterList}&nbsp;;<BR>EXECUTE&nbsp;DYNAMIC&nbsp;Procedure&nbsp;&nbsp;&nbsp;&nbsp;{USING&nbsp;ParameterList}&nbsp;;<BR>FETCH&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;HostVariableList&nbsp;;<BR>CLOSE&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;;<BR>eg:<BR>integer&nbsp;Emp_id_var</P>
<P>DECLARE&nbsp;my_cursor&nbsp;DYNAMIC&nbsp;CURSOR&nbsp;FOR&nbsp;SQLSA&nbsp;;<BR>PREPARE&nbsp;SQLSA&nbsp;FROM&nbsp;"SELECT&nbsp;emp_id&nbsp;FROM&nbsp;employee"&nbsp;;<BR>OPEN&nbsp;DYNAMIC&nbsp;my_cursor&nbsp;;<BR>FETCH&nbsp;my_cursor&nbsp;INTO&nbsp;:Emp_id_var&nbsp;;<BR>CLOSE&nbsp;my_cursor&nbsp;;</P>
<P><BR>4.Dynamic&nbsp;SQL&nbsp;Format&nbsp;4</P>
<P>DECLARE&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNAMIC&nbsp;CURSOR&nbsp;|&nbsp;PROCEDURE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;DynamicStagingArea&nbsp;;<BR>PREPARE&nbsp;DynamicStagingArea&nbsp;FROM&nbsp;SQLStatement&nbsp;&nbsp;&nbsp;&nbsp;{USING&nbsp;TransactionObject}&nbsp;;<BR>DESCRIBE&nbsp;DynamicStagingArea&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;DynamicDescriptionArea&nbsp;;<BR>OPEN&nbsp;DYNAMIC&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;DESCRIPTOR&nbsp;DynamicDescriptionArea&nbsp;;<BR>EXECUTE&nbsp;DYNAMIC&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;DESCRIPTOR&nbsp;DynamicDescriptionArea&nbsp;;<BR>FETCH&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;DESCRIPTOR&nbsp;DynamicDescriptionArea&nbsp;;<BR>CLOSE&nbsp;Cursor&nbsp;|&nbsp;Procedure&nbsp;;</P>
<P>eg:</P>
<P>string&nbsp;Stringvar,&nbsp;Sqlstatement<BR>integer&nbsp;Intvar<BR>Sqlstatement&nbsp;=&nbsp;"SELECT&nbsp;emp_id&nbsp;FROM&nbsp;employee"<BR>PREPARE&nbsp;SQLSA&nbsp;FROM&nbsp;:Sqlstatement&nbsp;;<BR>DESCRIBE&nbsp;SQLSA&nbsp;INTO&nbsp;SQLDA&nbsp;;<BR>DECLARE&nbsp;my_cursor&nbsp;DYNAMIC&nbsp;CURSOR&nbsp;FOR&nbsp;SQLSA&nbsp;;<BR>OPEN&nbsp;DYNAMIC&nbsp;my_cursor&nbsp;USING&nbsp;DESCRIPTOR&nbsp;SQLDA&nbsp;;<BR>FETCH&nbsp;my_cursor&nbsp;USING&nbsp;DESCRIPTOR&nbsp;SQLDA&nbsp;;</P>
<P>//&nbsp;If&nbsp;the&nbsp;FETCH&nbsp;is&nbsp;successful,&nbsp;the&nbsp;output&nbsp;<BR>//&nbsp;descriptor&nbsp;array&nbsp;will&nbsp;contain&nbsp;returned&nbsp;<BR>//&nbsp;values&nbsp;from&nbsp;the&nbsp;first&nbsp;row&nbsp;of&nbsp;the&nbsp;result&nbsp;set.<BR>//&nbsp;SQLDA.NumOutputs&nbsp;contains&nbsp;the&nbsp;number&nbsp;of&nbsp;<BR>//&nbsp;output&nbsp;descriptors.<BR>//&nbsp;The&nbsp;SQLDA.OutParmType&nbsp;array&nbsp;will&nbsp;contain&nbsp;<BR>//&nbsp;NumOutput&nbsp;entries&nbsp;and&nbsp;each&nbsp;entry&nbsp;will&nbsp;contain<BR>//&nbsp;an&nbsp;value&nbsp;of&nbsp;the&nbsp;enumerated&nbsp;data&nbsp;type&nbsp;ParmType<BR>//&nbsp;(such&nbsp;as&nbsp;TypeInteger!,&nbsp;or&nbsp;TypeString!).</P>
<P>CHOOSE&nbsp;CASE&nbsp;SQLDA.OutParmType[1]<BR>CASE&nbsp;TypeString!<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stringvar&nbsp;=&nbsp;GetDynamicString(SQLDA,&nbsp;1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;TypeInteger!<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intvar&nbsp;=&nbsp;GetDynamicNumber(SQLDA,&nbsp;1)</P>
<P>END&nbsp;CHOOSE<BR>CLOSE&nbsp;my_cursor&nbsp;;<BR></P></FONT>