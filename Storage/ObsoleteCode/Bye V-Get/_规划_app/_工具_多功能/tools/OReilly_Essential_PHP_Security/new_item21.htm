<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>


   <title>2.5. &#36328;&#31449;&#35831;&#27714;&#20266;&#36896;</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">2.5. &#36328;&#31449;&#35831;&#27714;&#20266;&#36896;</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="introduction.htm">Top</a>&nbsp;
     <a href="new_item20.htm">Previous</a>&nbsp;
     <a href="new_item22.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p style="line-height: 1.50;">2.5. &#36328;&#31449;&#35831;&#27714;&#20266;&#36896;</p>
<p style="line-height: 1.50;">  &nbsp; &#36328;&#31449;&#35831;&#27714;&#20266;&#36896;(CSRF)&#26159;&#19968;&#31181;&#20801;&#35768;&#25915;&#20987;&#32773;&#36890;&#36807;&#21463;&#23475;&#32773;&#21457;&#36865;&#20219;&#24847;HTTP&#35831;&#27714;&#30340;&#19968;&#31867;&#25915;&#20987;&#26041;&#27861;&#12290;&#27492;&#22788;&#25152;&#25351;&#30340;&#21463;&#23475;&#32773;&#26159;&#19968;&#20010;&#19981;&#30693;&#24773;&#30340;&#21516;&#35851;&#65292;&#25152;&#26377;&#30340;&#20266;&#36896;&#35831;&#27714;&#37117;&#30001;&#20182;&#21457;&#36215;&#65292;&#32780;&#19981;&#26159;&#25915;&#20987;&#32773;&#12290;&#36825;&#26679;&#65292;&#24456;&#20320;&#23601;&#24456;&#38590;&#30830;&#23450;&#21738;&#20123;&#35831;&#27714;&#26159;&#23646;&#20110;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#12290;&#20107;&#23454;&#19978;&#65292;&#22914;&#26524;&#27809;&#26377;&#23545;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#36827;&#34892;&#29305;&#24847;&#38450;&#33539;&#30340;&#35805;&#65292;&#20320;&#30340;&#24212;&#29992;&#24456;&#26377;&#21487;&#33021;&#26159;&#26377;&#28431;&#27934;&#30340;&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &#35831;&#30475;&#19979;&#38754;&#19968;&#20010;&#31616;&#21333;&#30340;&#24212;&#29992;&#65292;&#23427;&#20801;&#35768;&#29992;&#25143;&#36141;&#20080;&#38050;&#31508;&#25110;&#38085;&#31508;&#12290;&#30028;&#38754;&#19978;&#21253;&#21547;&#19979;&#38754;&#30340;&#34920;&#21333;&#65306;</p>
<p style="line-height: 1.50;">CODE:</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;form action="buy.php" method="POST"&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;p&gt;</p>
<p style="line-height: 1.50;">  &nbsp; Item:</p>
<p style="line-height: 1.50;">  &nbsp; &lt;select name="item"&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; &lt;option name="pen"&gt;pen&lt;/option&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; &lt;option name="pencil"&gt;pencil&lt;/option&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;/select&gt;&lt;br /&gt;</p>
<p style="line-height: 1.50;">  &nbsp; Quantity: &lt;input type="text" name="quantity" /&gt;&lt;br /&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;input type="submit" value="Buy" /&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;/p&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;/form&gt;</p>
<p style="line-height: 1.50;">&#19968;&#20010;&#25915;&#20987;&#32773;&#20250;&#39318;&#20808;&#20351;&#29992;&#20320;&#30340;&#24212;&#29992;&#20197;&#25910;&#38598;&#19968;&#20123;&#22522;&#26412;&#20449;&#24687;&#12290;&#20363;&#22914;&#65292;&#25915;&#20987;&#32773;&#39318;&#20808;&#35775;&#38382;&#34920;&#21333;&#24182;&#21457;&#29616;&#20004;&#20010;&#34920;&#21333;&#20803;&#32032;item&#21450;quantity&#65292;&#20182;&#20063;&#21516;&#26102;&#30693;&#36947;&#20102;item&#30340;&#20540;&#20250;&#26159;&#38085;&#31508;&#25110;&#26159;&#38050;&#31508;&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">&#19979;&#38754;&#30340;buy.php&#31243;&#24207;&#22788;&#29702;&#34920;&#21333;&#30340;&#25552;&#20132;&#20449;&#24687;&#65306;</p>
<p style="line-height: 1.50;">CODE:</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;?php</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; session_start();</p>
<p style="line-height: 1.50;">  &nbsp; $clean = array();</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; if (isset($_REQUEST['item'] &amp;&amp; isset($_REQUEST['quantity']))</p>
<p style="line-height: 1.50;">  &nbsp; {</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; /* Filter Input ($_REQUEST['item'], $_REQUEST['quantity']) */</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; if (buy_item($clean['item'], $clean['quantity']))</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; {</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; &nbsp; echo '&lt;p&gt;Thanks for your purchase.&lt;/p&gt;';</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; }</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; else</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; {</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; &nbsp; echo '&lt;p&gt;There was a problem with your order.&lt;/p&gt;';</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; }</p>
<p style="line-height: 1.50;">  &nbsp; }</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; ?&gt;</p>
<p style="line-height: 1.50;">&#25915;&#20987;&#32773;&#20250;&#39318;&#20808;&#20351;&#29992;&#36825;&#20010;&#34920;&#21333;&#26469;&#35266;&#23519;&#23427;&#30340;&#21160;&#20316;&#12290;&#20363;&#22914;&#65292;&#22312;&#36141;&#20080;&#20102;&#19968;&#25903;&#38085;&#31508;&#21518;&#65292;&#25915;&#20987;&#32773;&#30693;&#36947;&#20102;&#22312;&#36141;&#20080;&#25104;&#21151;&#21518;&#20250;&#20986;&#29616;&#24863;&#35874;&#20449;&#24687;&#12290;&#27880;&#24847;&#21040;&#36825;&#19968;&#28857;&#21518;&#65292;&#25915;&#20987;&#32773;&#20250;&#23581;&#35797;&#36890;&#36807;&#35775;&#38382;&#19979;&#38754;&#30340;URL&#20197;&#29992;GET&#26041;&#24335;&#25552;&#20132;&#25968;&#25454;&#26159;&#21542;&#33021;&#36798;&#21040;&#21516;&#26679;&#30340;&#30446;&#30340;&#65306;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; http://store.example.org/buy.php?item=pen&amp;quantity=1</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &#22914;&#26524;&#33021;&#25104;&#21151;&#30340;&#35805;&#65292;&#25915;&#20987;&#32773;&#29616;&#22312;&#23601;&#21462;&#24471;&#20102;&#24403;&#21512;&#27861;&#29992;&#25143;&#35775;&#38382;&#26102;&#65292;&#21487;&#20197;&#24341;&#21457;&#36141;&#20080;&#30340;URL&#26684;&#24335;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#36827;&#34892;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#38750;&#24120;&#23481;&#26131;&#65292;&#22240;&#20026;&#25915;&#20987;&#32773;&#21482;&#35201;&#24341;&#21457;&#21463;&#23475;&#32773;&#35775;&#38382;&#35813;URL&#21363;&#21487;&#12290;</p>
<p style="line-height: 1.50;">  &nbsp; &#34429;&#28982;&#26377;&#22810;&#31181;&#21457;&#36215;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#30340;&#26041;&#24335;&#65292;&#20294;&#26159;&#20351;&#29992;&#23884;&#20837;&#36164;&#28304;&#22914;&#22270;&#29255;&#30340;&#26041;&#24335;&#26159;&#26368;&#26222;&#36941;&#30340;&#12290;&#20026;&#20102;&#29702;&#35299;&#36825;&#20010;&#25915;&#20987;&#30340;&#36807;&#31243;&#65292;&#39318;&#20808;&#26377;&#24517;&#35201;&#20102;&#35299;&#27983;&#35272;&#22120;&#35831;&#27714;&#36825;&#20123;&#36164;&#28304;&#30340;&#26041;&#24335;&#12290;</p>
<p style="line-height: 1.50;">  &nbsp; &#24403;&#20320;&#35775;&#38382;http://www.google.com (&#22270; 2-1)&#65292;&#20320;&#30340;&#27983;&#35272;&#22120;&#39318;&#20808;&#20250;&#35831;&#27714;&#36825;&#20010;URL&#25152;&#26631;&#35782;&#30340;&#36164;&#28304;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#26597;&#30475;&#35813;&#39029;&#30340;&#28304;&#25991;&#20214;&#65288;HTML&#65289;&#30340;&#26041;&#24335;&#26469;&#30475;&#21040;&#35813;&#35831;&#27714;&#30340;&#36820;&#22238;&#20869;&#23481;&#12290;&#22312;&#27983;&#35272;&#22120;&#35299;&#26512;&#20102;&#36820;&#22238;&#20869;&#23481;&#21518;&#21457;&#29616;&#20102;Google&#30340;&#26631;&#24535;&#22270;&#29255;&#12290;&#36825;&#20010;&#22270;&#29255;&#26159;&#20197;HTML&#30340;img&#26631;&#31614;&#34920;&#31034;&#30340;&#65292;&#35813;&#26631;&#31614;&#30340;src&#23646;&#24615;&#34920;&#31034;&#20102;&#22270;&#29255;&#30340;URL&#12290;&#27983;&#35272;&#22120;&#20110;&#26159;&#20877;&#21457;&#20986;&#23545;&#35813;&#22270;&#29255;&#30340;&#35831;&#27714;&#65292;&#20197;&#19978;&#36825;&#20004;&#27425;&#35831;&#27714;&#38388;&#30340;&#19981;&#21516;&#28857;&#21482;&#26159;URL&#30340;&#19981;&#21516;&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">&#22270; 2-1. Google&#30340;&#39318;&#39029;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">A CSRF attack can use an img tag to leverage this behavior. Consider visiting a web site with the following image identified in the source:</p>
<p style="line-height: 1.50;">  &nbsp; &#26681;&#25454;&#19978;&#38754;&#30340;&#21407;&#29702;&#65292;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#21487;&#20197;&#36890;&#36807;img&#26631;&#31614;&#26469;&#23454;&#29616;&#12290;&#32771;&#34385;&#19968;&#19979;&#22914;&#26524;&#35775;&#38382;&#21253;&#25324; &#19979;&#38754;&#30340;&#28304;&#20195;&#30721;&#30340;&#32593;&#39029;&#20250;&#21457;&#29983;&#20160;&#20040;&#24773;&#20917;&#65306;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;img src="http://store.example.org/buy.php?item=pencil&amp;quantity=50" /&gt;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &#30001;&#20110;buy.php&#33050;&#26412;&#20351;&#29992;$_REQUEST&#32780;&#19981;&#26159;$_POST&#65292;&#36825;&#26679;&#27599;&#19968;&#20010;&#21482;&#35201;&#26159;&#30331;&#24405;&#22312;store.example.org&#21830;&#24215;&#19978;&#30340;&#29992;&#25143;&#23601;&#20250;&#36890;&#36807;&#35831;&#27714;&#35813;URL&#36141;&#20080;50&#25903;&#38085;&#31508;&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#30340;&#23384;&#22312;&#26159;&#19981;&#25512;&#33616;&#20351;&#29992;$_REQUEST&#30340;&#21407;&#22240;&#20043;&#19968;&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">&#23436;&#25972;&#30340;&#25915;&#20987;&#36807;&#31243;&#35265;&#22270;2-2&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">&#22270;2-2. &#36890;&#36807;&#22270;&#29255;&#24341;&#21457;&#30340;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &#24403;&#35831;&#27714;&#19968;&#20010;&#22270;&#29255;&#26102;&#65292;&#26576;&#20123;&#27983;&#35272;&#22120;&#20250;&#25913;&#21464;&#35831;&#27714;&#22836;&#37096;&#30340;Accept&#20540;&#20197;&#32473;&#22270;&#29255;&#31867;&#22411;&#20197;&#19968;&#20010;&#26356;&#39640;&#30340;&#20248;&#20808;&#26435;&#12290;&#38656;&#35201;&#37319;&#29992;&#20445;&#25252;&#25514;&#26045;&#20197;&#38450;&#27490;&#36825;&#31181;&#24773;&#20917;&#30340;&#21457;&#29983;&#12290;</p>
<p style="line-height: 1.50;">  &nbsp; &#20320;&#38656;&#35201;&#29992;&#20960;&#20010;&#27493;&#39588;&#26469;&#20943;&#36731;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#30340;&#39118;&#38505;&#12290;&#19968;&#33324;&#30340;&#27493;&#39588;&#21253;&#25324;&#20351;&#29992;POST&#26041;&#24335;&#32780;&#19981;&#26159;&#20351;&#29992;GET&#26469;&#25552;&#20132;&#34920;&#21333;&#65292;&#22312;&#22788;&#29702;&#34920;&#21333;&#25552;&#20132;&#26102;&#20351;&#29992;$_POST&#32780;&#19981;&#26159;$_REQUEST&#65292;&#21516;&#26102;&#38656;&#35201;&#22312;&#37325;&#35201;&#25805;&#20316;&#26102;&#36827;&#34892;&#39564;&#35777;&#65288;&#36234;&#26159;&#26041;&#20415;&#65292;&#39118;&#38505;&#36234;&#22823;&#65292;&#20320;&#38656;&#35201;&#27714;&#24471;&#26041;&#20415;&#19982;&#39118;&#38505;&#20043;&#38388;&#30340;&#24179;&#34913;&#65289;&#12290;</p>
<p style="line-height: 1.50;">  &nbsp; &#20219;&#20309;&#38656;&#35201;&#36827;&#34892;&#25805;&#20316;&#30340;&#34920;&#21333;&#37117;&#35201;&#20351;&#29992;POST&#26041;&#24335;&#12290;&#22312;RFC 2616(HTTP/1.1&#20256;&#36865;&#21327;&#35758;&#65292;&#35793;&#27880;)&#30340;9.1.1&#23567;&#33410;&#20013;&#26377;&#19968;&#27573;&#25551;&#36848;&#65306;</p>
<p style="line-height: 1.50;">  &nbsp; &#8220;&#29305;&#21035;&#38656;&#35201;&#25351;&#20986;&#30340;&#26159;&#65292;&#20064;&#24815;&#19978;GET&#19982;HEAD&#26041;&#24335;&#19981;&#24212;&#35813;&#29992;&#20110;&#24341;&#21457;&#19968;&#20010;&#25805;&#20316;&#65292;&#32780;&#21482;&#26159;&#29992;&#20110;&#33719;&#21462;&#20449;&#24687;&#12290;&#36825;&#20123;&#26041;&#24335;&#24212;&#35813;&#34987;&#35748;&#20026;&#26159;&#8216;&#23433;&#20840;&#8217;&#30340;&#12290;&#23458;&#25143;&#27983;&#35272;&#22120;&#24212;&#20197;&#29305;&#27530;&#30340;&#26041;&#24335;&#65292;&#22914;POST&#65292;PUT&#25110;DELETE&#26041;&#24335;&#26469;&#20351;&#29992;&#25143;&#24847;&#35782;&#21040;&#27491;&#22312;&#35831;&#27714;&#36827;&#34892;&#30340;&#25805;&#20316;&#21487;&#33021;&#26159;&#19981;&#23433;&#20840;&#30340;&#12290;&#8221;</p>
<p style="line-height: 1.50;">  &nbsp; &#26368;&#37325;&#35201;&#30340;&#19968;&#28857;&#26159;&#20320;&#35201;&#20570;&#21040;&#33021;&#24378;&#21046;&#20351;&#29992;&#20320;&#33258;&#24049;&#30340;&#34920;&#21333;&#36827;&#34892;&#25552;&#20132;&#12290;&#23613;&#31649;&#29992;&#25143;&#25552;&#20132;&#30340;&#25968;&#25454;&#30475;&#36215;&#26469;&#35937;&#26159;&#20320;&#34920;&#21333;&#30340;&#25552;&#20132;&#32467;&#26524;&#65292;&#20294;&#22914;&#26524;&#29992;&#25143;&#24182;&#19981;&#26159;&#22312;&#26368;&#36817;&#35843;&#29992;&#30340;&#34920;&#21333;&#65292;&#36825;&#23601;&#27604;&#36739;&#21487;&#30097;&#20102;&#12290;&#35831;&#30475;&#19979;&#38754;&#23545;&#21069;&#20363;&#24212;&#29992;&#26356;&#25913;&#21518;&#30340;&#20195;&#30721;&#65306;</p>
<p style="line-height: 1.50;">CODE:</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;?php</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; session_start();</p>
<p style="line-height: 1.50;">  &nbsp; $token = md5(uniqid(rand(), TRUE));</p>
<p style="line-height: 1.50;">  &nbsp; $_SESSION['token'] = $token;</p>
<p style="line-height: 1.50;">  &nbsp; $_SESSION['token_time'] = time();</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; ?&gt;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;form action="buy.php" method="POST"&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;input type="hidden" name="token" value="&lt;?php echo $token; ?&gt;" /&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;p&gt;</p>
<p style="line-height: 1.50;">  &nbsp; Item:</p>
<p style="line-height: 1.50;">  &nbsp; &lt;select name="item"&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; &lt;option name="pen"&gt;pen&lt;/option&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; &lt;option name="pencil"&gt;pencil&lt;/option&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;/select&gt;&lt;br /&gt;</p>
<p style="line-height: 1.50;">  &nbsp; Quantity: &lt;input type="text" name="quantity" /&gt;&lt;br /&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;input type="submit" value="Buy" /&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;/p&gt;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;/form&gt;</p>
<p style="line-height: 1.50;">&#36890;&#36807;&#36825;&#20123;&#31616;&#21333;&#30340;&#20462;&#25913;&#65292;&#19968;&#20010;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#23601;&#24517;&#39035;&#21253;&#25324;&#19968;&#20010;&#21512;&#27861;&#30340;&#39564;&#35777;&#30721;&#20197;&#23436;&#20840;&#27169;&#20223;&#34920;&#21333;&#25552;&#20132;&#12290;&#30001;&#20110;&#39564;&#35777;&#30721;&#30340;&#20445;&#23384;&#22312;&#29992;&#25143;&#30340;session&#20013;&#30340;&#65292;&#25915;&#20987;&#32773;&#24517;&#39035;&#23545;&#27599;&#20010;&#21463;&#23475;&#32773;&#20351;&#29992;&#19981;&#21516;&#30340;&#39564;&#35777;&#30721;&#12290;&#36825;&#26679;&#23601;&#26377;&#25928;&#30340;&#38480;&#21046;&#20102;&#23545;&#19968;&#20010;&#29992;&#25143;&#30340;&#20219;&#20309;&#25915;&#20987;&#65292;&#23427;&#35201;&#27714;&#25915;&#20987;&#32773;&#33719;&#21462;&#21478;&#22806;&#19968;&#20010;&#29992;&#25143;&#30340;&#21512;&#27861;&#39564;&#35777;&#30721;&#12290;&#20351;&#29992;&#20320;&#33258;&#24049;&#30340;&#39564;&#35777;&#30721;&#26469;&#20266;&#36896;&#21478;&#22806;&#19968;&#20010;&#29992;&#25143;&#30340;&#35831;&#27714;&#26159;&#26080;&#25928;&#30340;&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &#35813;&#39564;&#35777;&#30721;&#21487;&#20197;&#31616;&#21333;&#22320;&#36890;&#36807;&#19968;&#20010;&#26465;&#20214;&#34920;&#36798;&#24335;&#26469;&#36827;&#34892;&#26816;&#26597;&#65306;</p>
<p style="line-height: 1.50;">CODE:</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; &lt;?php</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; if (isset($_SESSION['token']) &amp;&amp;</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; &nbsp; $_POST['token'] == $_SESSION['token'])</p>
<p style="line-height: 1.50;">  &nbsp; {</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; /* Valid Token */</p>
<p style="line-height: 1.50;">  &nbsp; }</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; ?&gt;</p>
<p style="line-height: 1.50;">&#20320;&#36824;&#33021;&#23545;&#39564;&#35777;&#30721;&#21152;&#19978;&#19968;&#20010;&#26377;&#25928;&#26102;&#38388;&#38480;&#21046;&#65292;&#22914;5&#20998;&#38047;&#65306;</p>
<p style="line-height: 1.50;">CODE:</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp;&lt;?php</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; $token_age = time() - $_SESSION['token_time'];</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; if ($token_age &lt;= 300)</p>
<p style="line-height: 1.50;">  &nbsp; {</p>
<p style="line-height: 1.50;">  &nbsp; &nbsp; /* Less than five minutes has passed. */</p>
<p style="line-height: 1.50;">  &nbsp; }</p>
<p style="line-height: 1.50;">&nbsp;</p>
<p style="line-height: 1.50;">  &nbsp; ?&gt;</p>
<p style="line-height: 1.50;">&#36890;&#36807;&#22312;&#20320;&#30340;&#34920;&#21333;&#20013;&#21253;&#25324;&#39564;&#35777;&#30721;&#65292;&#20320;&#20107;&#23454;&#19978;&#24050;&#32463;&#28040;&#38500;&#20102;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#30340;&#39118;&#38505;&#12290;&#21487;&#20197;&#22312;&#20219;&#20309;&#38656;&#35201;&#25191;&#34892;&#25805;&#20316;&#30340;&#20219;&#20309;&#34920;&#21333;&#20013;&#20351;&#29992;&#36825;&#20010;&#27969;&#31243;&#12290;</p>
<p style="line-height: 1.50;">  &nbsp; &#23613;&#31649;&#25105;&#20351;&#29992;img&#26631;&#31614;&#25551;&#36848;&#20102;&#25915;&#20987;&#26041;&#27861;&#65292;&#20294;&#36328;&#31449;&#35831;&#27714;&#20266;&#36896;&#25915;&#20987;&#21482;&#26159;&#19968;&#20010;&#24635;&#31216;&#65292;&#23427;&#26159;&#25351;&#25152;&#26377;&#25915;&#20987;&#32773;&#36890;&#36807;&#20266;&#36896;&#20182;&#20154;&#30340;HTTP&#35831;&#27714;&#36827;&#34892;&#25915;&#20987;&#30340;&#31867;&#22411;&#12290;&#24050;&#30693;&#30340;&#25915;&#20987;&#26041;&#27861;&#21516;&#26102;&#21253;&#25324;&#23545;GET&#21644;POST&#30340;&#25915;&#20987;&#65292;&#25152;&#20197;&#19981;&#35201;&#35748;&#20026;&#21482;&#35201;&#20005;&#26684;&#22320;&#21482;&#20351;&#29992;POST&#26041;&#24335;&#23601;&#34892;&#20102;&#12290;</p>
<p style="line-height: 1.50;">&nbsp;</p>
<hr noshade size=1 ><p style="line-height: 1.50;">&nbsp;</p>

</td></tr></table>

</body>
</html>
