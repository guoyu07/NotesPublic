<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>DatePart 函数</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Visual&nbsp;Basic&nbsp;Scripting&nbsp;Edition</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="vsfctdatepart"></A>DatePart 函数</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>返回给定日期的指定部分。</P>

<PRE class="syntax"><B>DatePart(</B>interval, date[, firstdayofweek[, firstweekofyear]]<B>)</B></PRE>

<H4 class="dtH4">Arguments</H4>

<DL>
<DT><I>interval</I></DT>

<DD>必选项。字符串表达式表示要返回的时间间隔。有关数值，请参阅“设置”部分。</dd>

<DT><I>Date</I></DT>

<DD>必选项。要计算的日期表达式。</dd>

<DT><I>firstdayof week</I></DT>

<DD>可选项。指定星期中的第一天的常数。如果没有指定，则默认为星期日。有关数值，请参阅“设置”部分。</dd>

<DT><I>Firstweekofyear</I></DT>

<DD>可选项。指定一年中第一周的常数。如果没有指定，则默认为 1 月 1 日所在的星期。有关数值，请参阅“设置”部分。</dd>
</DL>

<H4 class="dtH4">设置</H4>

<P><B>interval</B> 参数可以有以下值：</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=15%>设置</TH>
<TH width=85%>描述</TH>
</TR>

<TR VALIGN="top">
<TD width=15%>yyyy</TD>
<TD width=85%>年</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>q</TD>
<TD width=85%>季度</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>m</TD>
<TD width=85%>月</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>y</TD>
<TD width=85%>一年的日数</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>d</TD>
<TD width=85%>日</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>w</TD>
<TD width=85%>一周的日数</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>ww</TD>
<TD width=85%>周</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>h</TD>
<TD width=85%>小时</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>n</TD>
<TD width=85%>分钟</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>s</TD>
<TD width=85%>秒</TD>
</TR>
</table></div>

<P>firstdayofweek 参数可以有以下值：</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=19%>常数</TH>
<TH width=9%>值</TH>
<TH width=72%>描述</TH>
</TR>

<TR VALIGN="top">
<TD width=19%>vbUseSystemDayOfWeek</TD>
<TD width=9%>0</TD>
<TD width=72%>使用区域语言支持 (NLS) API 设置。</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>vbSunday</TD>
<TD width=9%>1</TD>
<TD width=72%>星期日（默认）</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>vbMonday</TD>
<TD width=9%>2</TD>
<TD width=72%>星期一</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>vbTuesday</TD>
<TD width=9%>3</TD>
<TD width=72%>星期二</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>vbWednesday</TD>
<TD width=9%>4</TD>
<TD width=72%>星期三</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>vbThursday</TD>
<TD width=9%>5</TD>
<TD width=72%>星期四</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>vbFriday</TD>
<TD width=9%>6</TD>
<TD width=72%>星期五</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>vbSaturday</TD>
<TD width=9%>7</TD>
<TD width=72%>星期六</TD>
</TR>
</table></div>

<P>firstweekofyear 参数可以有以下值：</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=22%>常数</TH>
<TH width=8%>值</TH>
<TH width=70%>描述</TH>
</TR>

<TR VALIGN="top">
<TD width=22%>vbUseSystem</TD>
<TD width=8%>0</TD>
<TD width=70%>使用区域语言支持 (NLS) API 设置。</TD>
</TR>

<TR VALIGN="top">
<TD width=22%>vbFirstJan1</TD>
<TD width=8%>1</TD>
<TD width=70%>由 1 月 1 日所在的星期开始（默认）。</TD>
</TR>

<TR VALIGN="top">
<TD width=22%>vbFirstFourDays</TD>
<TD width=8%>2</TD>
<TD width=70%>由在新年中至少有四天的第一周开始。</TD>
</TR>

<TR VALIGN="top">
<TD width=22%>vbFirstFullWeek</TD>
<TD width=8%>3</TD>
<TD width=70%>由在新的一年中第一个完整的周（不跨年度）开始。</TD>
</TR>
</table></div>

<H4 class="dtH4">说明</H4>

<P><B>DatePart</B> 函数用于计算日期并返回指定的时间间隔。例如使用 <B>DatePart</B> 计算某一天是星期几或当前的时间。</P>

<P><B>firstdayofweek</B> 参数会影响使用“w”和“ww”间隔符号的计算。</P>

<P>如果 <B>date</B> 是日期文字，则指定的年度会成为日期的固定部分。但是如果 <B>date</B> 被包含在引号 (" ") 中，并且省略年份，则在代码中每次计算 <B>date</B> 表达式时，将插入当前年份。这样就可以编写适用于不同年份的程序代码。.</P>

<P>下面的示例利用 <B>DatePart</B> 函数获得日期并显示该日所在的季节。</P>

<PRE class="code">Function GetQuarter(TheDate) 
   GetQuarter = <code><b class="cfe">DatePart(</b></code>"q"<code><b class="cfe">,</b></code> TheDate<code><b class="cfe">)</b></code>
End Function</PRE>

<H4 class="dtH4">要求</H4>

<P><A HREF="vtoriversioninformation.htm">版本2</A></P>

<H4 class="dtH4">请参阅</H4>

<P><A HREF="vsfctdateadd.htm">DateAdd 函数</A> | <A HREF="vsfctdatediff.htm">DateDiff 函数</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
