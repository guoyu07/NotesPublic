<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>Environment 属性</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Windows&nbsp;脚本宿主</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="wsproenvironment"></A>Environment 属性</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>返回 WshEnvironment 对象（环境变量集）。</P>

<PRE class="syntax"><I>object</I>.<B>Environment</B> ([<I>strType</I>]) </PRE>

<H4 class="dtH4">参数</H4>

<DL>
<DT><I>object</I></DT>

<DD>WshShell 对象。</dd>

<DT><I>strType</I></DT>

<DD>可选。指定环境变量的位置。</dd>
</DL>

<H4 class="dtH4">说明</H4>

<P>Environment 属性中包含 WshEnvironment 对象（环境变量集）。如果提供了 <I>strType</I>，则 Environment 属性指定环境变量可能的值为 <I>System</I>、<I>User</I> 还是 <I>Volatile。</I>如果未提供 <I>strType</I>，则 Environment 属性将根据操作系统返回不同类型的环境变量。</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>环境变量类型</TH>
<TH width=50%>操作系统</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>System</TD>
<TD width=50%>Microsoft Windows&nbsp;NT/2000</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Process</TD>
<TD width=50%>Windows&nbsp;95/98/Me</TD>
</TR>
</table></div>

<BLOCKQUOTE class="dtBlock">
<b class="le">注意</b>&nbsp;&nbsp;&nbsp;对于 Windows&nbsp;95/98/Me，只允许一种 <I>strType</I> &#0151;<I>Process。</I></BLOCKQUOTE>

<P>下表列出了 Windows 操作系统提供的一些变量。脚本可以访问由其他应用程序设置的环境变量。</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">注意</b>&nbsp;&nbsp;&nbsp;下列变量不能用于 <I>Volatile </I>类型<I>。</I></BLOCKQUOTE>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=35%>名称</TH>
<TH width=18%>说明</TH>
<TH width=12%>系统</TH>
<TH width=8%>用户</TH>
<TH width=14%>进程 (NT/<BR>
2000)</TH>
<TH width=13%>进程 (98/ME)</TH>
</TR>

<TR VALIGN="top">
<TD width=35%>NUMBER_OF_PROCESSORS</TD>
<TD width=18%>机器上运行的处理器数。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>PROCESSOR_ARCHITECTURE</TD>
<TD width=18%>用户工作站上的处理器类型。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>PROCESSOR_IDENTIFIER</TD>
<TD width=18%>用户工作站上的处理器 ID。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>PROCESSOR_LEVEL</TD>
<TD width=18%>用户工作站上的处理器级别。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>PROCESSOR_REVISION</TD>
<TD width=18%>用户工作站上的处理器版本。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>OS</TD>
<TD width=18%>用户工作站上的操作系统。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>COMSPEC</TD>
<TD width=18%>用于命令提示符的可执行文件（一般为 cmd.exe）。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>X</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>HOMEDRIVE</TD>
<TD width=18%>本地主驱动器（一般为C 驱动器）。</TD>
<TD width=12%>-</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>HOMEPATH</TD>
<TD width=18%>用户的默认目录（在 Windows&nbsp;2000 中一般为 \users\default）。</TD>
<TD width=12%>-</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>PATH</TD>
<TD width=18%>PATH 环境变量。</TD>
<TD width=12%>X</TD>
<TD width=8%>X</TD>
<TD width=14%>X</TD>
<TD width=13%>X</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>PATHEXT</TD>
<TD width=18%>可执行文件的扩展名（一般为 .com、.exe、.bat 或 .cmd）。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>PROMPT</TD>
<TD width=18%>命令提示符（一般为 $P$G）。</TD>
<TD width=12%>-</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>X</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SYSTEMDRIVE</TD>
<TD width=18%>系统目录所在的本地驱动器（一般为 c:\）。</TD>
<TD width=12%>-</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SYSTEMROOT</TD>
<TD width=18%>系统目录（例如，c:\winnt）。和 WINDIR 相同。</TD>
<TD width=12%>-</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>-</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>WINDIR</TD>
<TD width=18%>系统目录（例如，c:\winnt）。和 SYSTEMROOT相同。</TD>
<TD width=12%>X</TD>
<TD width=8%>-</TD>
<TD width=14%>X</TD>
<TD width=13%>X</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>TEMP</TD>
<TD width=18%>用来存储临时文件的目录（例如，c:\temp）。</TD>
<TD width=12%>-</TD>
<TD width=8%>X</TD>
<TD width=14%>X</TD>
<TD width=13%>X</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>TMP</TD>
<TD width=18%>用来存储临时文件的目录（例如，c:\temp）。</TD>
<TD width=12%>-</TD>
<TD width=8%>X</TD>
<TD width=14%>X</TD>
<TD width=13%>X</TD>
</TR>
</table></div>

<H4 class="dtH4">示例</H4>

<P>下面的代码用来检索系统环境变量 NUMBER_OF_PROCESSORS。</P>
<div class=filtered><span class="lang">[VBScript]</span>

<PRE class="code">Set WshShell = WScript.CreateObject("WScript.Shell")
Set WshSysEnv = WshShell.<code><b class="cfe">Environment</b></code>("SYSTEM")
WScript.Echo WshSysEnv("NUMBER_OF_PROCESSORS")</PRE>
</div><!-- [end] -->
<div class=filtered><span class="lang">[JScript]</span>

<PRE class="code">var WshShell = WScript.CreateObject("WScript.Shell");
var WshSysEnv = WshShell.<code><b class="cfe">Environment</b></code>("SYSTEM");
WScript.Echo(WshSysEnv("NUMBER_OF_PROCESSORS"));</PRE>
</div><!-- [end] -->

<H4 class="dtH4">请参阅</H4>

<P><A HREF="wsobjwshenvironment.htm">WshEnvironment 对象</A> | <A HREF="wsobjwshshell.htm">WshShell 对象</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
