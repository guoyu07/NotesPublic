<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>GetLocale 函数</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Visual&nbsp;Basic&nbsp;Scripting&nbsp;Edition</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="vsfctgetlocale"></A>GetLocale 函数</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>返回当前区域设置 ID 值。</P>

<PRE class="syntax">GetLocale()</PRE>

<H4 class="dtH4">说明</H4>

<P><I>locale</I> 是用户参考信息集合，与用户的语言、国家/地区和文化传统有关。<I>locale</I> 决定键盘布局、字母排序顺序和日期、时间、数字与货币格式。</P>

<P>返回值可以是任意一个 32-位 的值，如<A HREF="vsmsclcid.htm">区域设置 ID</A>所示：</P>

<P>下面举例说明 <B>GetLocale</B> 函数的用法。要使用该代码，请复制标准HTML 文件中 &lt;BODY&gt; 标志之间的所有内容。</P>

<PRE class="code">Enter Date in UK format: &lt;input type="text" id="UKDate" size="20"&gt;&lt;p&gt;
Here's the US equivalent: &lt;input type="text" id="USdate" size="20"&gt;&lt;p&gt;
&lt;input type="button" value="Convert" id="button1"&gt;&lt;p&gt;
Enter a price in German: &amp;nbsp; &lt;input type="text" id="GermanNumber" size="20"&gt;
&lt;p&gt;
Here's the UK equivalent: &lt;input type="text" id="USNumber" size="20"&gt;&lt;p&gt;
&lt;input type="button" value="Convert" id="button2"&gt;&lt;p&gt;

&lt;script language="vbscript"&gt;
Dim currentLocale
' 获取当前的区域设置
currentLocale = <code><b class="cfe">GetLocale</b></code>

Sub Button1_onclick
  Dim original
  original = SetLocale("en-gb")
  mydate = CDate(UKDate.value)
  ' IE 始终将区域设置设置为“美国英语”，
  ' 所以请使用 currentLocale 变量将区域设置设置为“美国英语”。
  original = SetLocale(currentLocale)
  USDate.value = FormatDateTime(mydate,vbShortDate)
End Sub

Sub button2_onclick
  Dim original
  original = SetLocale("de")
  myvalue = CCur(GermanNumber.value)
  original = SetLocale("en-gb")
  USNumber.value = FormatCurrency(myvalue)
End Sub

&lt;/script&gt; </PRE>

<H4 class="dtH4">请参阅</H4>

<P><A HREF="vsfctsetlocale.htm">SetLocale 函数</A> | <A HREF="vsmsclcid.htm">区域设置 ID (LCID) 表</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
