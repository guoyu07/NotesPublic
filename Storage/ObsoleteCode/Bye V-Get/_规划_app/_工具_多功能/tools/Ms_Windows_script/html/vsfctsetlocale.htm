<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>SetLocale 函数</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Visual&nbsp;Basic&nbsp;Scripting&nbsp;Edition</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="vsfctsetlocale"></A>SetLocale 函数</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>设置全球区域设置，并返回以前的区域设置。</P>

<PRE class="syntax">SetLocale(<I>lcid</I>)</PRE>

<P><I>lcid</I> 参数可以是任意一个合法的 32 位数值或短字符串，该值必须唯一标识一个地理区域。能被识别的值可以查阅<A HREF="vsmsclcid.htm">区域设置 ID</A> 表。</P>

<H4 class="dtH4">说明</H4>

<P>若 <I>lcid</I> 为零，区域被设置为与当前系统设置匹配。</P>

<P>一个 locale 是用户参考信息集合，与用户的语言、国家/地区和文化传统有关。该 locale 决定键盘布局、字母排序顺序和日期、时间、数字与货币格式。</P>

<P>下面举例说明 <B>SetLocale</B> 函数的用法。要使用该代码，请复制标准HTML 文件中 &lt;BODY&gt; 标志之间的所有内容。</P>

<PRE class="code">Enter Date in UK format: &lt;input type="text" id="UKDate" size="20"&gt;&lt;p&gt;
Here's the US equivalent: &lt;input type="text" id="USdate" size="20"&gt;&lt;p&gt;
&lt;input type="button" value="Convert" id="button1"&gt;&lt;p&gt;
Enter a price in German: &amp;nbsp; &lt;input type="text" id="GermanNumber" size="20"&gt;
&lt;p&gt;
Here's the UK equivalent: &lt;input type="text" id="USNumber" size="20"&gt;&lt;p&gt;
&lt;input type="button" value="Convert" id="button2"&gt;&lt;p&gt;

&lt;script language="vbscript"&gt;
Dim currentLocale
' 获取当前的区域设置
currentLocale = GetLocale

Sub Button1_onclick
  Dim original
  original = <code><b class="cfe">SetLocale(</b></code>"en-gb"<code><b class="cfe">)</b></code>
  mydate = CDate(UKDate.value)
  ' IE 始终将区域设置设置为“美国英语”，
  ' 所以请使用 currentLocale 变量将区域设置设置为“美国英语”。
  original = <code><b class="cfe">SetLocale(</b></code>currentLocale<code><b class="cfe">)</b></code>
  USDate.value = FormatDateTime(mydate,vbShortDate)
End Sub

Sub button2_onclick
  Dim original
  original = <code><b class="cfe">SetLocale(</b></code>"de"<code><b class="cfe">)</b></code>
  myvalue = CCur(GermanNumber.value)
  original = <code><b class="cfe">SetLocale(</b></code>"en-gb"<code><b class="cfe">)</b></code>
  USNumber.value = FormatCurrency(myvalue)
End Sub

&lt;/script&gt; </PRE>

<H4 class="dtH4">请参阅</H4>

<P><A HREF="vsfctgetlocale.htm">GetLocale 函数</A> | <A HREF="vsmsclcid.htm">区域设置 ID (LCID) 表</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
