<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>使用条件语句</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Visual&nbsp;Basic&nbsp;Scripting&nbsp;Edition</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="vbsconditional"></A>使用条件语句</H1>

<H1 class="dtH1">控制程序执行</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>使用条件语句和循环语句可以控制脚本的流程。使用条件语句可以编写进行判断和重复操作的 VBScript 代码。在 VBScript 中可使用以下条件语句： 

<UL type="disc">
	<LI><A HREF="vsstmif.htm">If...Then...Else</A> 语句</li>

	<LI><A HREF="vsstmselectcase.htm">Select Case</A> 语句</li>
</UL>

<H2 class="dtH2">使用 If...Then...Else 进行判断</H2>

<P><B>If...Then...Else</B> 语句用于计算条件是否为 <B>True</B> 或 <B>False</B>，并且根据计算结果指定要运行的语句。通常，条件是使用比较运算符对值或变量进行比较的表达式。有关比较运算符的详细信息，请参阅<A HREF="vsgrpcomparison.htm">比较运算符</A>。<B>If...Then...Else</B> 语句可以按照需要进行嵌套。</P>

<H4 class="dtH4">条件为 True 时运行语句</H4>

<P>要在条件为 <B>True</B> 时运行单行语句，可使用 <B>If...Then...Else</B> 语句的单行语法。下例示范了单行语法。请注意此例省略了关键字 <B>Else</B>。</P>

<PRE class="code">Sub FixDate()
    Dim myDate
    myDate = #2/13/95#
    If myDate &lt; Now Then myDate = Now
End Sub</PRE>

<P>要运行多行代码，必须使用多行（或块）语法。多行（或块）语法包含 <B>End If</B> 语句，如下所示： </P>

<PRE class="code">Sub AlertUser(value)
   If value = 0 Then
      AlertLabel.ForeColor = vbRed
      AlertLabel.Font.Bold = True
      AlertLabel.Font.Italic = True
   End If
End Sub</PRE>

<H4 class="dtH4">条件为 True 和 False 时分别运行某些语句</H4>

<P>可以使用 <B>If...Then...Else</B> 语句定义两个可执行语句块：条件为 <B>True</B> 时运行某一语句块，条件为 <B>False</B> 时运行另一语句块。</P>

<PRE class="code">Sub AlertUser(value)
   If value = 0 Then
      AlertLabel.ForeColor = vbRed
      AlertLabel.Font.Bold = True
      AlertLabel.Font.Italic = True
   Else
      AlertLabel.Forecolor = vbBlack
      AlertLabel.Font.Bold = False
      AlertLabel.Font.Italic = False
   End If
End Sub</PRE>

<H4 class="dtH4">对多个条件进行判断</H4>

<P><B>If...Then...Else</B> 语句的一种变形允许您从多个条件中选择，即添加 <B>ElseIf</B> 子句以扩充 <B>If...Then...Else</B> 语句的功能，使您可以控制基于多种可能的程序流程。例如： </P>

<PRE class="code">Sub ReportValue(value)
   If value = 0 Then
      MsgBox value
   ElseIf value = 1 Then
      MsgBox value
   ElseIf value = 2 then
      Msgbox value
   Else
      Msgbox "数值超出范围！"
   End If</PRE>

<P>可以添加任意多个 <B>ElseIf</B> 子句以提供多种选择。使用多个 <B>ElseIf</B> 子句经常会变得很累赘。在多个条件中进行选择的更好方法是使用 <B>Select Case</B> 语句。</P>

<H2 class="dtH2">使用 Select Case 进行判断</H2>

<P><B>Select Case</B> 结构提供了 <B>If...Then...ElseIf</B> 结构的一个变通形式，可以从多个语句块中选择执行其中的一个。<B>Select Case</B> 语句提供的功能与 <B>If...Then...Else</B> 语句类似，但是可以使代码更加简练易读。</P>

<P><B>Select Case</B> 结构在其开始处使用一个只计算一次的简单测试表达式。表达式的结果将与结构中每个 <B>Case</B> 的值比较。如果匹配，则执行与该 <B>Case</B> 关联的语句块,示例代码如下：</P>

<PRE class="code">Select Case Document.Form1.CardType.Options(SelectedIndex).Text
   Case "MasterCard"
      DisplayMCLogo
      ValidateMCAccount
   Case "Visa"
      DisplayVisaLogo
      ValidateVisaAccount
   Case "American Express"
      DisplayAMEXCOLogo
      ValidateAMEXCOAccount
   Case Else
      DisplayUnknownImage
      PromptAgain
End Select</PRE>

<P>请注意 <B>Select Case</B> 结构只计算开始处的一个表达式（只计算一次），而 <B>If...Then...ElseIf</B> 结构计算每个 <B>ElseIf</B> 语句的表达式，这些表达式可以各不相同。仅当每个 <B>ElseIf</B> 语句计算的表达式都相同时，才可以使用 <B>Select Case </B>结构代替 <B>If...Then...ElseIf</B> 结构。</P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
