<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>SendKeys 方法</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Windows&nbsp;脚本宿主</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="wsmthsendkeys"></A>SendKeys 方法</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>将一个或多个键击发送到活动窗口（仿佛是在键盘上击键一样）。</P>

<PRE class="syntax"><I>object</I>.<B>SendKeys</B>(<I>string)</I></PRE>

<H4 class="dtH4">参数</H4>

<DL>
<DT><I>object</I></DT>

<DD>WshShell 对象。</dd>

<DT><I>string</I></DT>

<DD>表示要发送的键击（一个或多个）的字符串值。</dd>
</DL>

<H4 class="dtH4">说明</H4>

<P>使用 SendKeys 方法可以将键击发送到无自动化界面的应用程序中。多数键盘字符都可用一个键击表示。某些键盘字符由多个键击组合而成（例如，CTRL+SHIFT+HOME）。要发送单个键盘字符，请将字符本身作为 <I>string</I> 参数发送。例如，要发送字母 x，则请发送 <I>string</I> 参数 "x"。</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">注意</b>&nbsp;&nbsp;&nbsp;要发送空格，则请发送字符串 " "。</BLOCKQUOTE>

<P>可使用 SendKeys 同时发送多个键击。为此，可将每个键击按顺序排列在一起，以此来创建表示一系列键击的复合字符串参数。例如，要发送键击 a、b 和 c，则需要发送字符串参数 "abc"。SendKeys 方法将某些字符用作字符的修饰符（而不使用其本身的含义）。这组特殊的字符可包括圆括号、中括号、大括号，以及：

<UL type="disc">
	<LI>加号&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+"、</li>

	<LI>插入记号&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"^"、</li>

	<LI>百分号 "%"、</li>

	<LI>和“非”符号&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"~"。</li>
</UL>

<P>用大括号 "{}" 括起这些字符可以发送它们。例如，要发送加号，请使用字符串参数 "{+}"。SendKeys中使用的中括号 "[ ]" 无任何特殊含义，但是必须把它们括在大括号中，以便容纳确实要赋予其特殊含义的应用程序（例如，对于动态数据交换 (DDE) 就是这样）。

<UL type="disc">
	<LI>要发送左中括号字符，请发送字符串参数 "{[]"；要发送右中括号字符，请发送字符串参数 "{]}"。</li>

	<LI>要发送左大括号字符，请发送字符串参数 "{{}"；要发送右大括号字符，请发送字符串参数 "{}}"。</li>
</UL>

<P>某些键击不生成字符（如 ENTER 和 TAB）。某些键击表示操作（如 BACKSPACE 和 BREAK）。要发送这些类型的键击，请发送下表中列出的参数：</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=39%>键</TH>
<TH width=61%>参数</TH>
</TR>

<TR VALIGN="top">
<TD width=39%>退格键</TD>
<TD width=61%>{BACKSPACE}、{BS} 或 {BKSP}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>BREAK</TD>
<TD width=61%>{BREAK}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>CAPS LOCK</TD>
<TD width=61%>{CAPSLOCK}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>DEL 或 DELETE</TD>
<TD width=61%>{DELETE} 或 {DEL}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>向下键</TD>
<TD width=61%>{DOWN}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>END</TD>
<TD width=61%>{END}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>ENTER</TD>
<TD width=61%>{ENTER} 或 ~</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>ESC</TD>
<TD width=61%>{ESC}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>HELP</TD>
<TD width=61%>{HELP}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>HOME</TD>
<TD width=61%>{HOME}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>INS 或 INSERT</TD>
<TD width=61%>{INSERT} 或 {INS}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>向左键</TD>
<TD width=61%>{LEFT}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>NUM LOCK</TD>
<TD width=61%>{NUMLOCK}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PAGE DOWN</TD>
<TD width=61%>{PGDN}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PAGE UP</TD>
<TD width=61%>{PGUP}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PRINT SCREEN</TD>
<TD width=61%>{PRTSC}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>向右键</TD>
<TD width=61%>{RIGHT}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>SCROLL LOCK</TD>
<TD width=61%>{SCROLLLOCK}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>TAB</TD>
<TD width=61%>{TAB}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>向上键</TD>
<TD width=61%>{UP}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F1</TD>
<TD width=61%>{F1}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F2</TD>
<TD width=61%>{F2}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F3</TD>
<TD width=61%>{F3}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F4</TD>
<TD width=61%>{F4}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F5</TD>
<TD width=61%>{F5}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F6</TD>
<TD width=61%>{F6}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F7</TD>
<TD width=61%>{F7}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F8</TD>
<TD width=61%>{F8}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F9</TD>
<TD width=61%>{F9}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F10</TD>
<TD width=61%>{F10}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F11</TD>
<TD width=61%>{F11}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F12</TD>
<TD width=61%>{F12}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F13</TD>
<TD width=61%>{F13}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F14</TD>
<TD width=61%>{F14}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F15</TD>
<TD width=61%>{F15}</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>F16</TD>
<TD width=61%>{F16}</TD>
</TR>
</table></div>

<P>要发送由常规键击和 SHIFT、CTRL 或 ALT 组合而成的键盘字符，请创建表示该键击组合的复合字符串参数。可通过在常规键击之前添加一个或多个以下特殊字符来完成上述操作：</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=39%>键</TH>
<TH width=61%>特殊字符</TH>
</TR>

<TR VALIGN="top">
<TD width=39%>SHIFT</TD>
<TD width=61%>+</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>CTRL</TD>
<TD width=61%>^</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>ALT</TD>
<TD width=61%>%</TD>
</TR>
</table></div>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">注意</b>&nbsp;&nbsp;&nbsp;</B>这样使用时，不用大括号括起这些特殊字符。</BLOCKQUOTE>

<P>要指定在按下多个其他键时，按下 SHIFT、CTRL 和 ALT 的组合，请创建复合字符串参数，用括号括起其中的组合键。例如，要发送的组合键指定：

<UL type="disc">
	<LI>如果在按 e 和 c 的同时按 SHIFT 键，则发送字符串参数 "+(ec)"。</li>

	<LI>如果在按 e 时只按 c（而不按 SHIFT），则发送字符串参数 "+ec"。</li>
</UL>

<P>可使用 SendKeys 方法发送一种在一行内重复按键的键击。为此，要创建复合字符串参数，以指定要重复的键击，并在其后指定重复次数。可使用 {<I>键击 数字</I>} 形式的复合字符串参数来完成上述操作。例如，如果要发送 10 次 "x"，则需要发送字符串参数 "{x 10}"。请确保在键击和数字之间有一个空格。</P>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">注意</b>&nbsp;&nbsp;&nbsp;</B>只可以发送重复按一个键的键击。例如，可以发送 10 次 "x"，但不可发送 10 次 "Ctrl+x"。</BLOCKQUOTE>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">注意</b>&nbsp;&nbsp;&nbsp;</B>不能向应用程序发送 PRINT SCREEN 键 {PRTSC}。</BLOCKQUOTE>

<H4 class="dtH4">示例</H4>

<P>下面的示例演示如何将一个 .wsf 文件用于以不同脚本语言（VBScript 和 Jscript）写成的两个作业。每个作业都运行 Windows 计算器并将它发送给键击以执行简单的计算。</P>

<PRE class="code">&lt;package&gt;
   &lt;job id="vbs"&gt;
      &lt;script language="VBScript"&gt;
         set WshShell = WScript.CreateObject("WScript.Shell")
         WshShell.Run "calc"
         WScript.Sleep 100
         WshShell.AppActivate "Calculator"
         WScript.Sleep 100
         WshShell.<code><b class="cfe">SendKeys</b></code> "1{+}"
         WScript.Sleep 500
         WshShell.<code><b class="cfe">SendKeys</b></code> "2"
         WScript.Sleep 500
         WshShell.<code><b class="cfe">SendKeys</b></code> "~"
         WScript.Sleep 500
         WshShell.<code><b class="cfe">SendKeys</b></code> "*3"
         WScript.Sleep 500
         WshShell.<code><b class="cfe">SendKeys</b></code> "~"
         WScript.Sleep 2500
      &lt;/script&gt;
   &lt;/job&gt;

   &lt;job id="js"&gt;
      &lt;script language="JScript"&gt;
         var WshShell = WScript.CreateObject("WScript.Shell");
         WshShell.Run("calc");
         WScript.Sleep(100);
         WshShell.AppActivate("Calculator");
         WScript.Sleep(100);
         WshShell.<code><b class="cfe">SendKeys </b></code>("1{+}");
         WScript.Sleep(500);
         WshShell.<code><b class="cfe">SendKeys</b></code>("2");
         WScript.Sleep(500);
         WshShell.<code><b class="cfe">SendKeys</b></code>("~");
         WScript.Sleep(500);
         WshShell.<code><b class="cfe">SendKeys</b></code>("*3");
         WScript.Sleep(500);
         WshShell.<code><b class="cfe">SendKeys</b></code>("~");
         WScript.Sleep(2500);
      &lt;/script&gt;
   &lt;/job&gt;
&lt;/package&gt;</PRE>

<H4 class="dtH4">请参阅</H4>

<P><A HREF="wsobjwshshell.htm">WshShell 对象</A> | <A HREF="wsmthrun.htm">Run 方法</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
