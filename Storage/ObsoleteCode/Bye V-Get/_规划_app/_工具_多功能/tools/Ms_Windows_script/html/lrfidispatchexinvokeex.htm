<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML xmlns:MSHelp="http://msdn.microsoft.com/mshelp" DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IDispatchEx::InvokeEx</TITLE>
<xml>
<MSHelp:TOCTitle Title="IDispatchEx::InvokeEx"/>
<MSHelp:RLTitle Title="IDispatchEx::InvokeEx"/>
<MSHelp:Keyword Index="A" Term="lrfIDispatchExInvokeEx"/>
<MSHelp:Keyword Index="A" Term="lrfIDispatchExInvokeEx"/>
<MSHelp:Attr Name="DevLang" Value="JScript"/>
<MSHelp:Attr Name="DevLangVers" Value="kbJScript"/>
<MSHelp:Attr Name="DevLang" Value="VBScript"/>
<MSHelp:Attr Name="DevLangVers" Value="kbVBScript"/>
<MSHelp:Attr Name="DocSet" Value="PSDK"/>
<MSHelp:Attr Name="Product" Value="VS"/>
<MSHelp:Attr Name="ProductVers" Value="kbVS"/>
<MSHelp:Attr Name="TargetOS" Value="WinCE"/>
<MSHelp:Attr Name="TargetOSVers" Value="kbWinCE"/>
<MSHelp:Attr Name="TargetOSVers" Value="kbWinOS"/>
<MSHelp:Attr Name="Technology" Value="IE"/>
<MSHelp:Attr Name="TechnologyVers" Value="kbIE"/>
<MSHelp:Attr Name="TopicType" Value="kbSyntax"/>
<MSHelp:Attr Name="TargetOS" Value="Windows"/>
<MSHelp:Attr Name="Locale" Value="kbEnglish"/>
</xml>
<META name="rtfFileName" content="idispatchex.rtf">
<!--CSS_START-->
<SCRIPT SRC="ms-help:/../commoner/scripts/dtuelink.js"></SCRIPT>
<!--CSS_END--><META NAME="msdnID" CONTENT="_686655">
</HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY"><div id="scrollyes">Microsoft&nbsp;Windows&nbsp;Script&nbsp;Interfaces
<H1 class="dtH1"><A NAME="lrfidispatchexinvokeex"></A>IDispatchEx::InvokeEx</H1>

<P>Provides access to properties and methods exposed by an <B>IDispatchEx</B> object.</P>

<PRE class="syntax"><B>HRESULT InvokeEx(</B>
<B>   DISPID</B> <I>id</I>,
   <B>LCID</B> <I>lcid</I>,
   <B>WORD</B> <I>wFlags</I>,
   <B>DISPARAMS *</B><I>pdp</I>,
   <B>VARIANT *</B><I>pVarRes</I>, 
   <B>EXCEPINFO *</B><I>pei</I>, 
   <B>IServiceProvider *</B><I>pspCaller</I> 
<B>)</B>;</PRE>

<P>Returns one of the following values:</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TD width=50%><B>S_OK</B></TD>
<TD width=50%>Success.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_BADPARAMCOUNT</B></TD>
<TD width=50%>The number of elements provided to DISPPARAMS is different from the number of arguments accepted by the method or property.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_BADVARTYPE</B></TD>
<TD width=50%>One of the arguments in <B>rgvarg </B>is not a valid variant type.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_EXCEPTION </B></TD>
<TD width=50%>The application needs to raise an exception. In this case, the structure passed in <I>pei</I> should be filled in.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_MEMBERNOTFOUND</B></TD>
<TD width=50%>The requested member does not exist, or the call to <B>InvokeEx</B> tried to set the value of a read-only property.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_NONAMEDARGS</B></TD>
<TD width=50%>This implementation of <B>IDispatch</B> does not support named arguments.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_OVERFLOW</B></TD>
<TD width=50%>One of the arguments in <B>rgvarg</B> could not be coerced to the specified type.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_PARAMNOTFOUND</B></TD>
<TD width=50%>One of the parameter <B>DISPID</B>s does not correspond to a parameter on the method.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_TYPEMISMATCH</B></TD>
<TD width=50%>One or more of the arguments could not be coerced.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_UNKNOWNLCID</B></TD>
<TD width=50%>The member being invoked interprets string arguments according to the <B>LCID</B>, and the <B>LCID</B> is not recognized. If the <B>LCID</B> is not needed to interpret arguments, this error should not be returned.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISP_E_PARAMNOTOPTIONAL</B></TD>
<TD width=50%>A required parameter was omitted.</TD>
</TR>
</table></div>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>id</I></DT>

<DD>Identifies the member. Uses <B>GetDispID</B> or <B>GetNextDispID</B> to obtain the dispatch identifier.</dd>

<DT><I>lcid</I></DT>

<DD>The locale context in which to interpret arguments. The <I>lcid</I> is passed to <B>InvokeEx</B> to allow the object to interpret its arguments specific to a locale.</dd>

<DT><I>wFlags </I></DT>

<DD>Flags describing the context of the <B>InvokeEx</B> call:

<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Value</TH>
<TH width=50%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISPATCH_METHOD</B></TD>
<TD width=50%>The member is invoked as a method. If a property has the same name, both this and the <B>DISPATCH_PROPERTYGET</B> flag may be set (defined by <B>IDispatch</B>).</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISPATCH_PROPERTYGET</B></TD>
<TD width=50%>The member is retrieved as a property or data member (defined by <B>IDispatch</B>).</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISPATCH_PROPERTYPUT</B></TD>
<TD width=50%>The member is changed as a property or data member (defined by <B>IDispatch</B>).</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISPATCH_PROPERTYPUTREF</B></TD>
<TD width=50%>The member is changed by a reference assignment rather than a value assignment. This flag is valid only when the property accepts a reference to an object (defined by <B>IDispatch</B>).</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>DISPATCH_CONSTRUCT</B></TD>
<TD width=50%>The member is being used as a constructor. (This is a new value defined by <B>IDispatchEx</B>). The legal values for wFlags are:<BR>
<B>DISPATCH_PROPERTYGET</B><BR>
<B>DISPATCH_METHOD</B><BR>
<B>DISPATCH_PROPERTYGET</B><BR>
<B>DISPATCH_METHOD</B><BR>
<B>DISPATCH_PROPERTYPUT</B><BR>
<B>DISPATCH_PROPERTYPUTREF</B><BR>
<B>DISPATCH_PROPERTYPUT</B><BR>
<B>DISPATCH_PROPERTYPUTREF</B><BR>
<B>DISPATCH_CONSTRUCT</B></TD>
</TR>
</table></div>

</dd>

<DT><I>pdp</I></DT>

<DD>Pointer to a structure containing an array of arguments, an array of argument <B>DISPID</B>s for named arguments, and counts for the number of elements in the arrays. See the <B>IDispatch</B> documentation for a full description of the DISPPARAMS structure.</dd>

<DT><I>pVarRes</I></DT>

<DD>Pointer to the location where the result is to be stored or Null if the caller expects no result. This argument is ignored if <B>DISPATCH_PROPERTYPUT</B> or <B>DISPATCH_PROPERTYPUTREF</B> is specified.</dd>

<DT><I>pei</I></DT>

<DD>Pointer to a structure that contains exception information. This structure should be filled in if <B>DISP_E_EXCEPTION</B> is returned. Can be Null. See the <B>IDispatch</B> documentation for a full description of the <B>EXCEPINFO</B> structure.</dd>

<DT><I>pspCaller</I></DT>

<DD>Pointer to a service provider object supplied by the caller, which allows the object to obtain services from the caller. Can be Null.</dd>
</DL>

<P><B>IDispatchEx::InvokeEx</B> provides all of the same features as <B>IDispatch::Invoke</B> and adds a few extensions:</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TD width=50%><B>DISPATCH_CONSTRUCT</B></TD>
<TD width=50%>Indicates that the item is being used as a constructor.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>pspCaller</TD>
<TD width=50%>The pspCaller allows the object access to services provided by the caller. Specific services may be handled by the caller itself or delegated to callers further up the call chain. For example, if a script engine inside a browser makes an <B>InvokeEx</B> call to an external object, the object can follow the pspCaller chain to obtain services from the script engine or browser. (Note that the call chain is not the same as the creation chain &#0151; also known as container chain or site chain. The creation chain may be available through some other mechanism such as <B>IObjectWithSite</B>.)</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>"this" pointer</TD>
<TD width=50%>When <B>DISPATCH_METHOD</B> is set in wFlags, there may be a "named parameter" for the "this" value. The DISPID will be DISPID_THIS and it must be the first named parameter.
<P>The unused <I>riid</I> parameter in <B>IDispatch::Invoke</B> has been removed.</P>

<P>The <I>puArgArr</I> parameter in <B>IDispatch::Invoke</B> has been removed.</P>
</TD>
</TR>
</table></div>

<P>See the <B>IDispatch::Invoke</B> documentation for the following examples:</P>

<P>"Calling a method with no arguments"</P>

<P>"Getting and setting properties"</P>

<P>"Passing parameters"</P>

<P>"Indexed Properties"</P>

<P>"Raising exceptions during Invoke"</P>

<P>"Returning errors"</P>

<H4 class="dtH4">Example </H4>

<PRE class="code">VARIANT var;
   BSTR bstrName;
   DISPID dispid;
   IDispatch *pdex;
   DISPPARAMS dispparamsNoArgs = {NULL, NULL, 0, 0};

   // Assign to pdex and bstrName
   pdex-&gt;GetDispID(bstrName, fdexNameCaseSensitive, &amp;dispid);
   pdex-&gt;<code><b class="cfe">InvokeEx(</b></code>dispid, LOCALE_USER_DEFAULT,
   DISPATCH_PROPERTYGET, &amp;dispparamsNoArgs, 
   &amp;var, NULL, NULL<code><b class="cfe">)</b></code>;</PRE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="jslrfidispatchex.htm">IDispatchEx Interface</A> | <A HREF="lrfidispatchexgetdispid.htm">IDispatchEx::GetDispID</A> | <A HREF="lrfidispatchexgetnextdispid.htm">IDispatchEx::GetNextDispID</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p><MSHelp:link keywords="vxmscCopyright" TABINDEX="0">&copy; 2001 Microsoft Corporation. All rights reserved.</MSHelp:link></p><p>Build: 9309.1546 
</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
