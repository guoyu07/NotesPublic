<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IActiveScript::Clone</title>
<META NAME="msdnID" CONTENT="_638917">
<META NAME="MS-GlueFolder" CONTENT="3935"><style>@import url("MS-ITS:dsmsdn.chm::/html/msdn_ie4.css");</style>
<link rel="stylesheet" href="MS-ITS:dsmsdn.chm::/html/msdn_ie3.css">
<META NAME=MS-HAID CONTENT="IActiveScript_Clone">
<meta NAME="MS-HKWD" CONTENT="component development">
<meta NAME="MS-HKWD" CONTENT="IActiveScript::Clone">
<meta NAME="MS-HKWD" CONTENT="IActiveScript">
<meta NAME="MS-HKWD" CONTENT="Clone">
<META NAME="Description" CONTENT="IActiveScript::Clone">
<META NAME="Keywords" CONTENT="Component Development;IActiveScript::Clone;IActiveScript;Clone">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<meta NAME="TECHNOLOGY" CONTENT="SCRIPTING">
<meta NAME="PRODUCT" CONTENT="Windows Script Interfaces">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">

<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


</HEAD>
<BODY BGCOLOR="#FFFFFF" LINK="#0033CC">


<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
<font FACE="Verdana, Arial, Helvetica" SIZE="2">

<table BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">
  <tr VALIGN="TOP">
    <td WIDTH="360"><font SIZE="1" COLOR="#660033">Microsoft&#174; Windows&#174; Script Interfaces</font><br>
    <font SIZE="4" COLOR="#000000"><b>IActiveScript::Clone</b></font></td>
    <td ALIGN="RIGHT"><font SIZE="1">&nbsp;<a HREF="reference.htm">Language&nbsp;Reference</a><br>
    <A HREF="IActiveScript_AddTypeLib.htm">Previous</a><br>
    <A HREF="IActiveScript_Close.htm">Next</a><P></font></td>
  </tr>
</table>
<hr noshade SIZE="1">
<BLOCKQUOTE>


<PRE><FONT FACE="Courier New" SIZE=3><code>HRESULT Clone(
    IActiveScript **ppscript  // receives pointer to IActiveScript
);
</code></PRE></FONT>

<P>Clones the current scripting engine (minus any current execution state), returning a loaded scripting engine that has no site in the current thread. The properties of this new scripting engine will be identical to the properties the original scripting engine would be in if it were transitioned back to the initialized state. 

<UL>
<LI>Returns one of the following values:
<p>
<TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>
<TR VALIGN=TOP BGCOLOR="#DDDDDD"><TD><Font Size=2><b>Return Value</b></Font></TD><TD><Font Size=2><b>Meaning</b></Font></TD>

<TR VALIGN=TOP><TD><FONT SIZE=2>S_OK
 </FONT></TD><TD><FONT SIZE=2>Success.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>E_NOTIMPL
 </FONT></TD><TD><FONT SIZE=2>This method is not supported.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>E_POINTER
 </FONT></TD><TD><FONT SIZE=2>An invalid pointer was specified.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>E_UNEXPECTED
 </FONT></TD><TD><FONT SIZE=2>The call was not expected (for example, the scripting engine has not yet been loaded or initialized).
</FONT></TD></TR></TABLE>
</UL>
<DL><DT><I>ppscript</I>
 </DT><DD>[out] Address of a variable that receives a pointer to the <A HREF="IActiveScript.htm#IActiveScript">IActiveScript</A> interface of the cloned scripting engine. The host must create a site and call the <A HREF="IActiveScript_SetScriptSite.htm#IActiveScript__SetSc">IActiveScript::SetScriptSite</A> method on the new scripting engine before it will be in the initialized state and, therefore, usable.
</DD></DL>

<P>The <B>IActiveScript::Clone</B> method is an optimization of <B>IPersist*::Save</B>, <b>CoCreateInstance</b>, and <B>IPersist*::Load</B>, so the state of the new scripting engine should be the same as if the state of the original scripting engine were saved and loaded into a new scripting engine. Named items are duplicated in the cloned scripting engine, but specific object pointers for each item are forgotten and are obtained with the <A HREF="IActiveScriptSite_GetItemInfo.htm#IActiveScriptSite__G">IActiveScriptSite::GetItemInfo</A> method. This allows an identical object model with per-thread entry points (an apartment model) to be used.

<P>This method is used for multithreaded server hosts that can run multiple instances of the same script. The scripting engine may return E_NOTIMPL, in which case the host can achieve the same result by duplicating the persistent state and creating a new instance of the scripting engine with an <B>IPersist*</B> interface.

<P>This method can be called from non-base threads without resulting in a non-base callout to host objects or to the <A HREF="IActiveScriptSite.htm#IActiveScriptSite">IActiveScriptSite</A> interface.


</blockquote>
<hr noshade size=1>
<!--COPYRIGHT BEGIN--><!--COPYRIGHT END-->
</FONT>
</BODY>
</HTML>
