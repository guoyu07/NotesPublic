<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>&lt;attach&gt; 元素</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Windows&nbsp;脚本部件</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="leteleattach"></A>&lt;attach&gt; 元素</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>将包含文档的事件绑定到脚本部件中的函数。</P>

<PRE class="syntax"><B>&lt;attach </B>event="<I>eventName</I>" handler="<I>functionName</I>" [for="<I>elementName</I>"]/&gt;</PRE>

<H4 class="dtH4">值</H4>

<DL>
<DT>eventName </DT>

<DD>待绑定的事件，如 onmouseclick。</dd>

<DT>functionName </DT>

<DD>为响应该事件而执行的脚本部件文件的过程（函数或子例程）名称。如果省略该属性，则将生成一个。

<P>如果没有指定 <code class="ce">for</code> 属性，则处理程序属性的缺省值为事件属性的值。如果指定了 <code class="ce">for</code> 属性，则缺省的处理程序属性为 <code class="ce">for</code> 属性值、“_” 以及事件的属性值三者连接而成的字符串。
</dd>

<DT>elementName </DT>

<DD>该元素与事件关联在一起，用来包含没有显式绑定 DHTML Behavior 的元素。<code class="ce">for</code> 属性的可能取值有 “document”、“window”以及 “element”。如果没有包括 <code class="ce">for</code> 属性，则缺省为 “element”，且认为是在绑定该操作的元素上激活该事件。</dd>
</DL>

<H4 class="dtH4">示例</H4>

<P>在下述示例中，&lt;attach&gt; 元素将三个事件绑定到函数。例如，DHTML 的onmouseover 元素被绑定到脚本部件的 do_onmouseover 函数。绑定给 DHTML 的 onmouseover 和 onmouseout 事件的函数只有在包含文档中绑定了该操作的元素上激活这些事件时才被执行。docinit 函数则显式绑定到 DHTML 文档对象的 onload 事件。</P>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">注意</b>&nbsp;&nbsp;&nbsp;</B>CDATA 项是必需的，它使 &lt;script&gt; 元素中的脚本成为不透明的。详细信息请参阅<A HREF="letxml.htm">脚本部件文件和 XML 一致性</A>。</BLOCKQUOTE>

<PRE class="code">&lt;?XML version="1.0"?&gt;
&lt;component id="bvrscript component1"&gt;
&lt;registration progID="Behaviorscript component"/&gt;
&lt;implements type="Behavior"&gt;
&nbsp;&nbsp;&nbsp;&lt;attach event="onmouseover" handler="do_onmouseover"/&gt;
&nbsp;&nbsp;&nbsp;&lt;attach event="onmouseout "handler="do_onmouseout"/&gt;
&nbsp;&nbsp;&nbsp;&lt;attach for="window" event="onload" handler="docinit"/&gt;
&lt;/implements&gt;
&lt;script language="JScript"&gt;
&lt;![CDATA[
var normalColor, normalSpacing;
function do_onmouseover(){
&nbsp;&nbsp;&nbsp;// 保存原始值。
&nbsp;&nbsp;&nbsp;normalColor = style.color;&nbsp; 
&nbsp;&nbsp;&nbsp;normalSpacing= style.letterSpacing;
&nbsp;&nbsp;&nbsp;style.color = "red";
&nbsp;&nbsp;&nbsp;style.letterSpacing = 2;
}
function do_onmouseout(){
&nbsp;&nbsp;&nbsp;// 恢复原始值。
&nbsp;&nbsp;&nbsp;style.color = normalColor;
&nbsp;&nbsp;&nbsp;style.letterSpacing = normalSpacing;
}
function docinit(){
&nbsp;&nbsp;&nbsp;document.linkColor = "red";
}
]]&gt;
&lt;/script&gt;
&lt;/component&gt;</PRE>

<H4 class="dtH4">请参阅</H4>

<P><A HREF="letcreatebeh.htm">创建 Behavior 脚本部件</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
