<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>VBScript 过程</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Visual&nbsp;Basic&nbsp;Scripting&nbsp;Edition</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="vbsprocedures"></A>VBScript 过程</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>在 VBScript 中，过程被分为两类：<A HREF="vsstmsub.htm">Sub</A> 过程和 <A HREF="vsstmfunction.htm">Function</A> 过程。</P>

<H2 class="dtH2">Sub 过程</H2>

<P><B>Sub</B> 过程是包含在 <B>Sub</B> 和 <B>End Sub</B> 语句之间的一组 VBScript 语句，执行操作但不返回值。<B>Sub</B> 过程可以使用参数（由调用过程传递的常数、变量或表达式）。如果 <B>Sub</B> 过程无任何参数，则 <B>Sub</B> 语句必须包含空括号 ()。</P>

<P>下面的 <B>Sub</B> 过程使用两个固有的（或内置的）VBScript 函数，即 <A HREF="vsfctmsgbox.htm">MsgBox</A> 和 <A HREF="vsfctinputbox.htm">InputBox</A>，来提示用户输入信息。然后显示根据这些信息计算的结果。计算由使用 VBScript 创建的 <B>Function</B> 过程完成。此过程在以下讨论之后演示。</P>

<PRE class="code">Sub ConvertTemp()
   temp = InputBox("请输入华氏温度。", 1)
   MsgBox "温度为 " &amp; Celsius(temp) &amp; " 摄氏度。"
End Sub</PRE>

<H2 class="dtH2">Function 过程</H2>

<P><B>Function</B> 过程是包含在 <B>Function</B> 和 <B>End Function</B> 语句之间的一组 VBScript 语句。<B>Function</B> 过程与 <B>Sub</B> 过程类似，但是 <B>Function</B> 过程可以返回值。<B>Function</B> 过程可以使用参数（由调用过程传递的常数、变量或表达式）。如果 <B>Function</B> 过程无任何参数，则 <B>Function</B> 语句必须包含空括号 ()。<B>Function</B> 过程通过函数名返回一个值，这个值是在过程的语句中赋给函数名的。<B>Function</B> 返回值的数据类型总是 <B>Variant</B>。</P>

<P>在下面的示例中，Celsius 函数将华氏度换算为摄氏度。<B>Sub</B> 过程 ConvertTemp 调用此函数时，包含参数值的变量被传递给函数。换算结果返回到调用过程并显示在消息框中。</P>

<PRE class="code">Sub ConvertTemp()
   temp = InputBox("请输入华氏温度。", 1)
   MsgBox "温度为 " &amp; Celsius(temp) &amp; " 摄氏度。"
End Sub

Function Celsius(fDegrees)
   Celsius = (fDegrees - 32) * 5 / 9
End Function</PRE>

<H2 class="dtH2">过程的数据进出</H2>

<P>给过程传递数据的途径是使用参数。参数被作为要传递给过程的数据的占位符。参数名可以是任何有效的变量名。使用 <B>Sub</B> 语句或 <B>Function</B> 语句创建过程时，过程名之后必须紧跟括号。括号中包含所有参数，参数间用逗号分隔。例如，在下面的示例中，fDegrees 是传递给 Celsius 函数的值的占位符：</P>

<PRE class="code">Function Celsius(fDegrees)
   Celsius = (fDegrees - 32) * 5 / 9
End Function</PRE>

<P>要从过程获取数据，必须使用 <B>Function</B> 过程。请记住，<B>Function</B> 过程可以返回值；<B>Sub</B> 过程不返回值。</P>

<H2 class="dtH2">在代码中使用 Sub 和 Function 过程</H2>

<P>调用 <B>Function</B> 过程时，函数名必须用在变量赋值语句的右端或表达式中。例如：</P>

<PRE class="code"> Temp = Celsius(fDegrees)</PRE>

<P>或 </P>

<PRE class="code"> MsgBox "温度为 " &amp; Celsius(fDegrees) &amp; " 摄氏度。"</PRE>

<P>调用 <B>Sub</B> 过程时，只需输入过程名及所有参数值，参数值之间使用逗号分隔。不需使用 <A HREF="vsstmcall.htm">Call</A> 语句，但如果使用了此语句，则必须将所有参数包含在括号之中。</P>

<P>下面的示例显示了调用 MyProc 过程的两种方式。一种使用 <B>Call</B> 语句；另一种则不使用。两种方式效果相同。</P>

<PRE class="code">Call MyProc(firstarg, secondarg)
MyProc firstarg, secondarg</PRE>

<P>请注意当不使用 <B>Call</B> 语句进行调用时，括号被省略。</P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
