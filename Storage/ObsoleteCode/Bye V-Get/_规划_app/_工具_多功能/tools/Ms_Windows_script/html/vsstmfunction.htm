<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>Function 语句</TITLE>
<!--CSS_START-->
<SCRIPT SRC="../scripts/vs70.js"></SCRIPT>
<SCRIPT SRC="../scripts/vs70link.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>Visual&nbsp;Basic&nbsp;Scripting&nbsp;Edition</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="vsstmfunction"></A>Function 语句</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<P>声明 <B>Function</B> 过程的名称、参数以及构成其主体的代码。</P>

<PRE class="syntax"> [Public [Default]| Private] <B>Function</B> name [(
   arglist
)]
[statements]
[name = expression]
[Exit Function] 
[statements]
[name = expression]
<B>End Function</B> </PRE>

<H4 class="dtH4">参数</H4>

<DL>
<DT><I>Public</I></DT>

<DD>表示 <B>Function</B> 过程可被所有脚本中的所有其他过程访问。</dd>

<DT><I>Default</I></DT>

<DD>只与 <B>Class</B> 块中的 <B>Public</B> 关键字一起使用来表示 <B>Function</B> 过程是类的默认方法。如果在一个类中指定了不止一个 <B>Default</B> 过程，就有错误发生。</dd>

<DT><I>Private</I></DT>

<DD>表示 <B>Function</B> 过程只可被声明它的脚本中的其他过程访问或者如果函数是一个数据类，那么 <B>Function</B> 过程只能被该类中的其他过程访问。</dd>

<DT><I>name</I></DT>

<DD><B>Function</B> 的名称，遵循标准的变量命名规则。</dd>

<DT><I>arglist</I></DT>

<DD>代表调用时要传递给 <B>Function</B> 过程的参数的变量列表。用逗号隔开多个变量。</dd>

<DT><I>statements</I></DT>

<DD>在 <B>Function</B> 过程的主体中执行的任意语句组。</dd>

<DT><I>expression</I></DT>

<DD>Function 的返回值。</dd>
</DL>

<P><B>arglist</B> 参数包含下列语法和部分：</P>

<P>[ByVal | ByRef] varname[( )]</P>

<H4 class="dtH4">参数</H4>

<DL>
<DT><I>ByVal</I></DT>

<DD>表示该参数是按值方式传递的。</dd>

<DT><I>ByRef</I></DT>

<DD>表示该参数按引用方式传递。</dd>

<DT><I>varname</I></DT>

<DD>代表参数变量的名称；遵循标准的变量命名规则。</dd>
</DL>

<H4 class="dtH4">说明</H4>

<P>如没有显式指定使用 Public 或 Private，则 <B>Function</B> 过程默认为公用，即它们对于脚本中的所有其他过程是可见的。<B>Function</B> 中局部变量的值在对过程的调用中不被保留。</P>

<P>不能在任何其他过程（例如，<B>Sub</B> 或 <B>Property Get</B>）中定义 <B>Function</B> 过程。</P>

<P>使用 <B>Exit Function </B>语句可以从 <B>Function</B> 过程中立即退出。程序继续执行调用 <B>Function</B> 过程的语句之后的语句。可在 <B>Function</B> 过程的任何位置出现任意个 <B>Exit Function</B> 语句。</P>

<P>与 <B>Sub</B> 过程类似，<B>Function</B> 过程是可以获取参数、执行一系列语句并改变其参数值的独立过程。与 <B>Sub</B> 过程的不同之处是：当要使用由函数返回的值时，可以在表达式的右边使用 <B>Function</B> 过程，这与内部函数的使用方式一样，例如 <B>Sqr</B>、<B>Cos</B> 或 <B>Chr</B>。</P>

<P>在表达式中，可以通过使用函数名，并在其后用圆括号给出相应的参数列表来调用 <B>Function</B> 过程。有关调用 <B>Function</B> 过程的详细信息，请参阅 <B>Call</B> 语句。</P>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">警告</b>&nbsp;&nbsp;&nbsp;Function</B> 过程可以是递归的，即该过程可以调用自身以完成某个给定的任务。但是，递归可能会导致堆栈溢出。</BLOCKQUOTE>

<P>要从函数返回一个值，只需将值赋给函数名。在过程的任意位置都可以出现任意个这样的赋值。如果没有给 <B>name</B> 赋值, 则过程将返回一个默认值：数值函数返回 0，字符串函数返回零长度字符串 ("")。如果在 <B>Function</B> 中没有对象引用被指定给 <B>name</B>（使用 <B>Set</B>），则返回对象引用的函数将返回 Nothing。</P>

<P>下面的样例说明如何给一个名为 BinarySearch 的函数赋返回值。在此样例中，将 <B>False</B> 赋给了该函数名，表示没有找到某个值。</P>

<PRE class="code"><code><b class="cfe">Function</b></code> BinarySearch(. . .)
      . . .
      ' 未找到该值。返回 False 值。
      If lower &gt; upper Then
          BinarySearch = False  
          Exit Function 
      End If
      . . .
End Function</PRE>

<P>在 <B>Function</B> 过程中使用的变量分为两类：一类是在过程内显式声明的，另一类则不是。在过程内显式声明的变量（使用 <B>Dim</B> 或等效方法）总是过程的局部变量。被使用但没有在过程中显式声明的变量也是局部变量，除非在该过程外更高级别的位置显式声明它们。</P>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">警告</b>&nbsp;&nbsp;&nbsp;</B>过程可以使用没有在过程内显式声明的变量，但只要有任何 script 级定义的名称与之同名，就会产生名称冲突。如果过程中引用的未声明的变量与其他的过程、常数或变量的名称相同，则会认为过程引用的是脚本级的名称。要避免这类冲突，请使用 <B>Option Explicit</B> 语句可强制显式声明变量。</BLOCKQUOTE>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">警告</b>&nbsp;&nbsp;&nbsp;</B>VBScript 可能会重新排列数学表达式以提高内部效率。当 <B>Function</B> 过程修改数学表达式中变量的值时，应避免在同一表达式中使用该函数。</BLOCKQUOTE>

<H4 class="dtH4">要求</H4>

<P><A HREF="vtoriversioninformation.htm">版本 1</A></P>

<H4 class="dtH4">请参阅</H4>

<P><A HREF="vsstmcall.htm">Call 语句</A> | <A HREF="vsstmdim.htm">Dim 语句</A> | <A HREF="vsstmexit.htm">Exit 语句</A> | <A HREF="vskeynothing.htm">Nothing</A> | <A HREF="vsstmset.htm">Set 语句</A> | <A HREF="vsstmsub.htm">Sub 语句</A></P>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p>&copy; 2001 Microsoft Corporation. 保留所有权利。</p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
