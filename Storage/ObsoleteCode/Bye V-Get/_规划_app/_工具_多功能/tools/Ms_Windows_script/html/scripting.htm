<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Microsoft Windows Script Interfaces-Introduction</title>
<META NAME="msdnID" CONTENT="_638929">
<META NAME="MS-GlueFolder" CONTENT="3935"><style>@import url("MS-ITS:dsmsdn.chm::/html/msdn_ie4.css");</style>
<link rel="stylesheet" href="MS-ITS:dsmsdn.chm::/html/msdn_ie3.css">
<META NAME=MS-HAID CONTENT="scripting">
<meta NAME="MS-HKWD" CONTENT="component development">

<META NAME="Description" CONTENT="Windows Script">
<META NAME="Keywords" CONTENT="Component Development">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<meta NAME="TECHNOLOGY" CONTENT="SCRIPTING">
<meta NAME="PRODUCT" CONTENT="Windows Script Interfaces">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


</HEAD>
<BODY BGCOLOR="#FFFFFF" LINK="#0033CC">

<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
<font FACE="Verdana, Arial, Helvetica" SIZE="2">

<table BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">
  <tr VALIGN="TOP">
    <td WIDTH="360"><font SIZE="1" COLOR="#660033">Microsoft&#174; Windows&#174; Script Interfaces</font><br>
    <font SIZE="4" COLOR="#000000"><b>Microsoft Windows Script Interfaces-Introduction</b></font></td>
    <td ALIGN="RIGHT"><font SIZE="1">&nbsp;<a HREF="reference.htm">Language&nbsp;Reference</a><br>
    
    <a HREF="hosts.htm">Next</a><P></font></td>
  </tr>
</table>
<hr noshade SIZE="1">
<BLOCKQUOTE>

<P>Microsoft&#174; Windows&#174; Script Interfaces introduce a new way for an application to add scripting and OLE Automation capabilities. With the advent of the interfaces, hosts can call upon disparate scripting engines from multiple sources and vendors to perform scripting between components. The implementation of the script itself&#151;language, syntax, persistent format, execution model, and so on&#151;is left to the script vendor. The designers have taken care to allow hosts that rely on Windows Script to use arbitrary language back ends.

<UL><LI><A HREF="hosts.htm#ch_script_host">Windows Script Hosts</A>

<LI><A HREF="engines.htm#ch_script_engine">Windows Script Engines</A>

<LI>IDispatchEx

<LI>IProvideMultipleClassInfo

<LI>Active Script Debugging Interfaces
</UL>
</Blockquote>

<H5><B>Windows Script Terms</B></H5>
<Blockquote>
<P>This list contains definitions of the scripting-related terms used in this document.
<p>
<TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>
<TR VALIGN=TOP BGCOLOR="#DDDDDD"><TD><FONT SIZE=2><B>Term
 </B></FONT></TD><TD><FONT SIZE=2><B>Definition
</B></FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>Code object
 </FONT></TD><TD><FONT SIZE=2>An instance created by the scripting engine that is associated with a named item, such as the module behind a form in Visual Basic&#174;, or a C++ class associated with a named item. Preferably, this is an OLE Component Object Model (COM) object that supports OLE Automation so the host or other nonscript entity can manipulate the code object.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>Named item
</FONT> </TD><TD><FONT SIZE=2>An OLE COM object (preferably one that supports OLE Automation) that the host deems interesting to the script. Examples include the HTML Page and Browser in a Web browser, and the Document and Dialogs in Microsoft Word.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>Script
 </FONT></TD><TD><FONT SIZE=2>The data that makes up the program that the scripting engine runs. A script can be any contiguous executable data, including pieces of text, blocks of pcode, or even machine-specific executable byte codes. A host loads a script into the scripting engine through one of the <B>IPersist*</B> interfaces or through the <A HREF="IActiveScriptParse.htm#IActiveScriptParse">IActiveScriptParse</A> interface.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>Scripting engine
 </FONT></TD><TD><FONT SIZE=2>The OLE object that processes scripts. A scripting engine implements the <A HREF="IActiveScript.htm#IActiveScript">IActiveScript</A> and, optionally, <A HREF="IActiveScriptParse.htm#IActiveScriptParse">IActiveScriptParse</A> interfaces.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>Scripting host
 </FONT></TD><TD><FONT SIZE=2>The application or program that owns the Windows Script engine. The host implements the <A HREF="IActiveScriptSite.htm#IActiveScriptSite">IActiveScriptSite</A> and, optionally, <A HREF="IActiveScriptSiteWindow.htm#IActiveScriptSiteWindow">IActiveScriptSiteWindow</A> interfaces.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>Scriptlet
 </FONT></TD><TD><FONT SIZE=2>A portion of a script that gets attached to an object through the <A HREF="IActiveScriptParse.htm#IActiveScriptParse">IActiveScriptParse</A> interface. The aggregate collection of scriptlets is the script.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>Script language
 </FONT></TD><TD><FONT SIZE=2>The language in which a script is written (VBScript, for example) and the semantics of that language.
</FONT></TD></TR></TABLE>
</Blockquote>
<H5><B>Windows Script Background</B></H5>
<Blockquote>

<P>Windows Script components fall into two categories: Windows Script hosts and Windows Script engines. A host creates a scripting engine and calls on the engine to run the scripts. Examples of Windows Script hosts include:

<UL>
<LI>Microsoft Internet Explorer
<LI>Internet authoring tools
<LI>Shell
</UL>

<P>Windows Script engines can be developed for any language or run-time environment, including:

<UL>
<LI>Microsoft Visual Basic Scripting Edition (VBScript)
<LI>Perl
<LI>Lisp
</UL>

<P>To make implementation of the host as flexible as possible, an OLE Automation wrapper for Windows Script is provided. However, a host that uses this wrapper object to instantiate the scripting engine does not have the degree of control over the run-time name space, the persistence model, and so on, that it would if it used Windows Script directly.

<P>The Windows Script design isolates the interface elements required only in an authoring environment so that nonauthoring hosts (such as browsers and viewers) and script engines (for example, VBScript) can be kept lightweight. 


</Blockquote>

<H5><B>Windows Script Basic Architecture</B></H5>
<Blockquote> 

<P>The following illustration shows the interaction between an Windows Script host and an Windows Script engine.

<P>

<P><IMG SRC="olescr01.gif" WIDTH="497" HEIGHT="302" ALT="" >

<P>

<P>Following is a description of the steps involved in the interaction between the host and engine. The actual nesting of the function calls is omitted for clarity. 

<OL>
<LI><B>Create a Project.</B> The host loads a project or document. (This step is not particular to Windows Script, but is included here for completeness.)
<LI><B>Create the Windows Script Engine.</B> The host calls <b>CoCreateInstance</b> to create a new Windows Script engine, specifying the class identifier (CLSID) of the specific scripting engine to use. For example, the HTML browsing component of Internet Explorer receives the scripting engine's class identifier through the <B>CLSID=</B> attribute of the HTML &lt;OBJECT&gt; tag.
<LI><B>Load the Script.</B> If the script contents have been persisted, the host calls the script engine's <B>IPersist*::Load</B> method to feed it the script storage, stream, or property bag. Otherwise, the host uses either the <B>IPersist*::InitNew</B> or <A HREF="IActiveScriptParse_InitNew.htm#IActiveScriptParse__">IActiveScriptParse::InitNew</A> method to create a null script. A host that maintains a script as text can use <A HREF="IActiveScriptParse_ParseScriptText.htm#IActiveScriptParse__">IActiveScriptParse::ParseScriptText</A> to feed the scripting engine the text of the script, after calling <B>IActiveScriptParse::InitNew</B>.
<LI><B>Add Named Items.</B> For each top-level named item (such as pages and forms) imported into the scripting engine's name space, the host calls the <A HREF="IActiveScript_AddNamedItem.htm#IActiveScript__AddNa">IActiveScript::AddNamedItem</A> method to create an entry in the engine's name space. This step is not necessary if top-level named items are already part of the persistent state of the script loaded in step 3. A host does not use <B>IActiveScript::AddNamedItem</B> to add sublevel named items (such as controls on an HTML page); rather, the engine indirectly obtains sublevel items from top-level items by using the host's <b>ITypeInfo</b> and <b>IDispatch</b> interfaces.
<LI><B>Run the Script.</B> The host causes the engine to start running the script by setting the SCRIPTSTATE_CONNECTED flag in the <A HREF="IActiveScript_SetScriptState.htm#IActiveScript__SetSc">IActiveScript::SetScriptState</A> method. This call would likely perform any scripting engine construction work, including static binding, hooking up to events (see below), and executing code, in a way similar to a scripted <B>main()</B> function.
<LI><B>Get Item Information.</B> Each time the script engine needs to associate a symbol with a top-level item, it calls the <A HREF="IActiveScriptSite_GetItemInfo.htm#IActiveScriptSite__G">IActiveScriptSite::GetItemInfo</A> method, which returns information about the given item.
<LI><B>Hook Up Event Advise.</B> Before starting the actual script, the scripting engine connects to the events of all the relevant objects through the <b>IConnectionPoint</b> interface. 
<LI><B>Invoke Properties and Methods.</B> As the script runs, the scripting engine realizes references to methods and properties on named objects through <b>IDispatch::Invoke</b> or other standard OLE binding mechanisms.
</OL>
</Blockquote>
<hr noshade size=1>
<!--COPYRIGHT BEGIN--><!--COPYRIGHT END-->
</FONT>
</BODY>
</HTML>
