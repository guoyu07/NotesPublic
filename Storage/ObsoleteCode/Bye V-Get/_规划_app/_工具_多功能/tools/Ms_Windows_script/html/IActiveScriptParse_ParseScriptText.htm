<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IActiveScriptParse::ParseScriptText</title>
<META NAME="msdnID" CONTENT="_638902">
<META NAME="MS-GlueFolder" CONTENT="3935"><style>@import url("MS-ITS:dsmsdn.chm::/html/msdn_ie4.css");</style>
<link rel="stylesheet" href="MS-ITS:dsmsdn.chm::/html/msdn_ie3.css">
<META NAME=MS-HAID CONTENT="IActiveScriptParse_ParseScriptText">
<meta NAME="MS-HKWD" CONTENT="component development">
<meta NAME="MS-HKWD" CONTENT="IActiveScriptParse::ParseScriptText">
<meta NAME="MS-HKWD" CONTENT="IActiveScriptParse">
<meta NAME="MS-HKWD" CONTENT="ParseScriptText">
<META NAME="Description" CONTENT="IActiveScriptParse::ParseScriptText">
<META NAME="Keywords" CONTENT="Component Development;IActiveScriptParse::ParseScriptText;IActiveScriptParse;ParseScriptText">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<meta NAME="TECHNOLOGY" CONTENT="SCRIPTING">
<meta NAME="PRODUCT" CONTENT="Windows Script Interfaces">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">

<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


</HEAD>
<BODY BGCOLOR="#FFFFFF" LINK="#0033CC">

<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
<font FACE="Verdana, Arial, Helvetica" SIZE="2">

<table BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">
  <tr VALIGN="TOP">
    <td WIDTH="360"><font SIZE="1" COLOR="#660033">Microsoft&#174; Windows&#174; Script Interfaces</font><br>
    <font SIZE="4" COLOR="#000000"><b>IActiveScriptParse::ParseScriptText</b></font></td>
    <td ALIGN="RIGHT"><font SIZE="1">&nbsp;<a HREF="reference.htm">Language&nbsp;Reference</a><br>
    <A HREF="IActiveScriptParse_InitNew.htm">Previous</a><br>
    <A HREF="enumerations.htm">Next</a><P></font></td>
  </tr>
</table>
<hr noshade SIZE="1">
<BLOCKQUOTE>


<PRE><FONT FACE="Courier New" SIZE=3><code>HRESULT ParseScriptText(
    LPCOLESTR pstrCode,          // address of scriptlet text
    LPCOLESTR pstrItemName,      // address of item name
    IUnknown *punkContext,       // address of debugging context
    LPCOLESTR pstrDelimiter,     // address of end-of-scriptlet delimiter
    DWORD dwSourceContextCookie, // application-defined value for debugging
    ULONG ulStartingLineNumber,  // starting line of the script
    DWORD dwFlags,               // scriptlet flags
    VARIANT *pvarResult,         // address of buffer for results
    EXCEPINFO *pexcepinfo        // address of buffer for error data
);
</code></PRE></FONT>

<P>Parses the given code scriptlet, adding declarations into the name space and evaluating code as appropriate.

<UL>
<LI>Returns one of the following values:
<p>
<TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>
<TR VALIGN=TOP BGCOLOR="#DDDDDD"><TD><Font Size=2><b>Return Value</b></Font></TD><TD><Font Size=2><b>Meaning</b></Font></TD>

<TR VALIGN=TOP><TD><FONT SIZE=2>S_OK
 </FONT></TD><TD><FONT SIZE=2>Success.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>DISP_E_EXCEPTION
 </FONT></TD><TD><FONT SIZE=2>An exception occurred in the processing of the scriptlet. The <I>pexcepinfo</I> parameter contains information about the exception.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>E_INVALIDARG
 </FONT></TD><TD><FONT SIZE=2>An argument was invalid.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>E_POINTER
 </FONT></TD><TD><FONT SIZE=2>An invalid pointer was specified.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>E_NOTIMPL
 </FONT></TD><TD><FONT SIZE=2>This method is not supported. The scripting engine does not support run-time evaluation of expressions or statements.
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>E_UNEXPECTED
 </FONT></TD><TD><FONT SIZE=2>The call was not expected (for example, the scripting engine is in the uninitialized or closed state, or the SCRIPTTEXT_ISEXPRESSION flag was set and the scripting engine is in the initialized state). 
</FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>OLESCRIPT_E_SYNTAX
 </FONT></TD><TD><FONT SIZE=2>An unspecified syntax error occurred in the scriptlet.
</FONT></TD></TR></TABLE>
</UL>
<DL><DT><I>pstrCode</I>
 </DT><DD>[in] Address of the scriptlet text to evaluate. The interpretation of this string depends on the scripting language.
</DD><DT><I>pstrItemName</I>
 </DT><DD>[in] Address of the item name that gives the context in which the scriptlet is to be evaluated. If this parameter is NULL, the code is evaluated in the scripting engine's global context.
</DD><DT><I>punkContext</I>
 </DT><DD>[in] Address of the context object. This object is reserved for use in a debugging environment, where such a context may be provided by the debugger to represent an active run-time context. If this parameter is NULL, the engine uses <I>pstrItemName</I> to identify the context.
</DD><DT><I>pstrDelimiter</I>
 </DT><DD>[in] Address of the end-of-scriptlet delimiter. When <I>pstrCode</I> is parsed from a stream of text, the host typically uses a delimiter, such as two single quotation marks ("), to detect the end of the scriptlet. This parameter specifies the delimiter that the host used, allowing the scripting engine to provide some conditional primitive preprocessing (for example, replacing a single quotation mark ['] with two single quotation marks for use as a delimiter). Exactly how (and if) the scripting engine makes use of this information depends on the scripting engine. Set this parameter to NULL if the host did not use a delimiter to mark the end of the scriptlet.
</DD><DT><I>dwSourceContextCookie</I>
 </DT><DD>[in] Application-defined value that is used for debugging purposes.
</DD><DT><I>ulStartingLineNumber</I>
 </DT><DD>[in] Zero-based value that specifies which line the parsing will begin at.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags associated with the scriptlet. Can be a combination of these values:
<p>
<TABLE WIDTH=87% BORDER=1 CELLPADDING=5 CELLSPACING=0>
<TR VALIGN=TOP BGCOLOR="#DDDDDD"><TD><Font Size=2><b>Value</b></Font></TD><TD><Font Size=2><b>Meaning</b></Font></TD>

<TR VALIGN=TOP><TD><FONT SIZE=2>SCRIPTTEXT_ISEXPRESSION
 </FONT></TD><TD><FONT SIZE=2>If the distinction between a computational expression and a statement is important but syntactically ambiguous in the script language, this flag specifies that the scriptlet is to be interpreted as an expression, rather than as a statement or list of statements. By default, statements are assumed unless the correct choice can be determined from the syntax of the scriptlet text.
 </FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>SCRIPTTEXT_ISPERSISTENT
 </FONT></TD><TD><FONT SIZE=2>Indicates that the code added during this call should be saved if the scripting engine is saved (for example, through a call to <B>IPersist*::Save</B>), or if the scripting engine is reset by way of a transition back to the initialized state.
 </FONT></TD></TR><TR VALIGN=TOP><TD><FONT SIZE=2>SCRIPTTEXT_ISVISIBLE
 </FONT></TD><TD><FONT SIZE=2>Indicates that the script text should be visible (and, therefore, callable by name) as a global method in the name space of the script.
 </FONT></TD></TR></TABLE>
</DD><DT><I>pvarResult</I>
 </DT><DD>[out] Address of a buffer that receives the results of scriptlet processing, or NULL if the caller expects no result (that is, the SCRIPTTEXT_ISEXPRESSION value is not set).
</DD><DT><I>pexcepinfo</I>
 </DT><DD>[out] Address of a structure that receives exception information. This structure is filled if <B>IActiveScriptParse::ParseScriptText</B> returns DISP_E_EXCEPTION.
</DD></DL>

<P>If the scripting engine is in the initialized state, no code will actually be evaluated during this call; rather, such code is queued and executed when the scripting engine is transitioned into (or through) the started state. Because execution is not allowed in the initialized state, it is an error to call this method with the SCRIPTTEXT_ISEXPRESSION flag when in the initialized state.

<P>The scriptlet can be an expression, a list of statements, or anything allowed by the script language. For example, this method is used in the evaluation of the HTML &lt;SCRIPT&gt; tag, which allows statements to be executed as the HTML page is being constructed, rather than just compiling them into the script state.

<P>The code passed to this method must be a valid, complete portion of code. For example, in VBScript it is illegal to call this method once with <B>Sub Function(x)</B> and then a second time with <B>End Sub</B>. The parser must not wait for the second call to complete the subroutine, but rather must generate a parse error because a subroutine declaration was started but not completed.

<P>For more information about script states, see <A HREF="engines.htm#Engine_States">Script Engine States</A>.
</blockquote>
<hr noshade size=1>
<!--COPYRIGHT BEGIN--><!--COPYRIGHT END-->
</FONT>
</BODY>
</HTML>
